---
date: 2024-04-08
category:
  - 学习
---

# 通信原理

通信原理的网课质量普遍挺低的。。找了**好久**才找到一个我认为还不错的：[学霸戴你飞](https://www.bilibili.com/video/av240301138)，全是重点没有废话，时长只有 4.5h。

## 1 基础

通信原理中分贝是 $10 lg x$

码元传输速率：$R_B$，信息传输速率：$R_b$

信息量：$H=-log_2P(x)$ bit

信息熵（平均信息量）：$H=\sum -P(x_i)log_2P(x_i) \approx m\cdot H_0$ bit/symbol

信源符号等概时熵最大

$R_b = R_B \cdot H = R_B \cdot log_2M$（等概）

频带利用率：传输速率/带宽，传输速率可以是 _码元传输速率_ 或 _信息传输速率_，它们的单位不同。

误码率（码元） $P_e$ >= 误信率（bit） $P_b$ （二进制时相等）

## 2

### 随机过程

自相关函数：反映不同时刻随机过程取值的相关性，$R(t_1,t_2)=E[\xi(t_{1})\xi(t_{2})]$；自协方差函数：反映不同时刻随机过程的统计相关性，$B(t_1,t_2)=E\{[\xi(t_{1})-a(t_{1})][\xi(t_{2})-a(t_{2})]\}$，a 为

广义平稳随机过程：

1. 期望（均值）为常数；
2. 自相关函数仅与时间间隔有关；$E(\xi^2(t))<+\infty$

各态经历性：期望 = 平均期望，自相关函数 = 平均自相关函数

性质：$R(\infty)=a^2=$直流功率，$R(0)=E(\xi^2)=$平均功率（0 处为最大值）；$R(0)-R(\infty)=D[\xi(t)]$（方差）

维纳-辛钦定理：平稳随机过程，自相关函数$R(\tau)$ - 傅里叶变换 ->功率谱密度函数$P_\xi(\omega)$。

高斯随机过程在任一时刻上的取值是一个正态分布的随机变量。高斯白噪：概率密度服从高斯分布，功率谱密度服从均匀分布

误差函数 erf(x) + 互补误差函数 erfc(x) = 1

窄带随机过程：功率谱密度集中在中心频率，并且带宽窄。

### 功率和能量

[一些判断](https://www.cnblogs.com/mengnan/p/12362336.html)

能量定义：$E=\int_{-\infty}^{\infty}s^{2}(t)dt<\infty$，能量信号：能量有限，平均功率 = 0。功率信号：能量无穷大。

能量信号的频谱密度是其傅里叶变换；能量信号的能量谱密度$G(f)=|S(f)|^2$ (傅里叶变换的模的平方)。$G(f)$对所有频率积分即为能量。

平均功率等于功率谱密度对所有频率积分。

能量信号的自相关函数 $R(\tau)=\int_{-\infty}^{\infty}s(t)s(t+\tau)dt$，傅里叶变换为能量谱密度$G(f)$。$R(0)=E$

（周期）功率信号自相关函数：$R(\tau)=\frac{1}{T}\int_{-T/2}^{T/2}s(t)s(t+\tau)dt$，傅里叶变换为功率谱密度$P(f)$。$R(0)=P$ (平均功率)

计算可以用[帕斯瓦尔定理](https://zh.wikipedia.org/wiki/%E5%B8%95%E5%A1%9E%E7%93%A6%E5%B0%94%E5%AE%9A%E7%90%86#%E5%B8%95%E5%A1%9E%E7%93%A6%E5%B0%94%E5%AE%9A%E7%90%86%E7%9A%84%E9%99%88%E8%BF%B0)。

### 线性系统

$E[\xi_o(t)]=E[\xi_i(t)]\cdot H(0)$

$P_o(\omega)=\left|H(\omega)\right|^2P_i(\omega)$

### 噪声

噪声是加性干扰。按噪声性质分类：脉冲噪声，窄带噪声，起伏噪声。

白噪声自相关函数：$\displaystyle R(\tau)=\frac{n_0}2\delta(\tau)$

低通：$R(\tau)=n_{0}f_{H}Sa(2\pi f_{H}\tau)$

带通：$R(\tau)=n_0BSa(\pi B\tau)\cos2\pi f_c\tau$

窄带高斯白噪：平均功率 $N=n_0B$

### 信道

乘性干扰和加性干扰。如果乘性干扰缓慢变化或不变化则为恒参信道，反之则为随参信道。

- 随参信道：信号的传输衰减随时间变化；信号的传输时延随时间变化；存在多径效应。
  - 多径效应：信号经过几条路径到达接收端，而且每条路径的长度（时延）和衰减都随时间而变。多径效应的影响：多径效应会使数字信号的码间串扰增大。为了减小码间串扰的影响，通常要降低码元传输速率。因为，若码元速率降低，则信号带宽也将随之减小，多径效应的影响也随之减轻。

转移概率：$P(0/1)$ 指发送 1 收到 0 的概率。发送在后。

振幅不变，相位线性过原点称为无失真。

信道容量（$C_t$）：信道能够传输的最大平均信息速率

香农公式：$C_t=B\log_2(1+\frac{S}{N})$，N 噪声功率，S 信号平均功率，$N=n_0B$，$n_0$ 为噪声单边功率谱密度

## 模拟调制

调制：分为基带调制和载波调制；模拟调制与数字调制，模拟调制中分为幅度调制与角度调制。

解调分为相干解调和包络检波。

- 包络检波只能用于 AM 波，且 $|m(t)|_{\max}\leq A_{0}$

解调器输入/出信噪比：解调器输入/出有用信号平均功率 / 输入/出噪声平均功率

制度增益 G = 输出信噪比 / 输入信噪比，越大则抗干扰能力越强

### AM

要知道步骤，会画调制信号草图（上包络和下包络对称）。

$s_{AM}(t)=[A_{0}+m(t)]\cos\omega_{c}t$，m 为信号，$A_0$ 为直流分量

$S_{AM}(\omega)=\pi A_0[\delta(\omega+\omega_c)+\delta(\omega-\omega_c)]+\frac{1}{2}[M(\omega+\omega_c)+M(\omega-\omega_c)]$

过调幅：$|m(t)|_{\max} > A_0$，包络检波失真

AM 信号的频谱由载频分量、上边带、下边带三部分组成。[图示](https://www.bilibili.com/video/BV1Me411z7WX/?p=10&t=272)；双边带信号，带宽是基带信号带宽 $f_m$ 的两倍

- 解调器输入信号功率：$S_i=P_c+P_s$（载波功率 + 边带功率）
- 解调器输出信号功率 $S_o\approx2P_s$
- 噪声输出功率 = 噪声输入功率
- 调制效率 $\eta_{AM}=$ 有用功率 / 总功率

当 $|m(t)|_{\max}= A_0$ 时（100%调制），调制效率最高，这时 $\eta_{\max}= 1/3, G=2/3$

### DSB

信号直接乘以载波，没有直流分量，包络关于 x 轴对称。$B=2f_{\mathrm{m}}$

- 优点：调制效率很高，节省载波功率
- 缺点：不能包络检波，只能相干解调。

$m_{\mathrm{o}}(t)=\frac{1}{2}m(t)$，$N_\text{o}=\frac{1}{4}N_i=\frac{1}{4}n_0B$，制度增益 G = 2

DSB 信号的解调器使信噪比改善一倍，这是因为采用相干解调，使输入噪声中的正交分量被消除的缘故。

### SSB

$B=f_{\mathrm{m}}$

产生：滤波法（DSB 滤去一个边带）、相移法([框图](https://www.bilibili.com/video/BV1Me411z7WX/?p=12&t=208))

相移法：

- 优点：不需要滤波器具有陡峭的截止特性
- 缺点：宽带相移网络难用硬件实现；不能包络检波，只能相干解调。

$m_{\mathrm{o}}(t)=\frac{1}{4}m(t)$，$N_\text{o}=\frac{1}{4}N_i=\frac{1}{4}n_0B$，制度增益 G = 1

DSB 和 SSB 的抗噪声性能是相同的。

### VSB

残留边带调制是介于 SSB 与 DSB 之间的一种折中方式。残留边带滤波器在 $\omega_c$ 处必须具有互补对称（奇对称）特性。

### 角度调制

$s_m(t)=A\cos[ \omega_ct+\varphi(t)]$

瞬时角频率：$\omega(t)=\mathrm{d}[\omega_\text{c}t+\varphi(t)]/\mathrm{d}t$

瞬时角频偏：$\mathrm{d}\varphi(t)/\mathrm{d}t$

最大相移其实就是 $\varphi(t)$ 最大值

#### FM

$\varphi(t)=m_{f}\sin\omega_{m}t$

其中，$\displaystyle m_{f}=\frac{K_{f}A_{m}}{\omega_{m}}=\frac{\Delta\omega}{\omega_m}=\frac{\Delta f}{f_m}$ 称为调频指数，表示最大相位偏移；$\Delta\omega$ 最大角频偏

$\varphi(t)=K_{f}\int m(t)dt$， $K_f$ 为调频灵敏度

带宽 $B_{FM}=2(\Delta f+f_m)=2(m_f+1)f_m$

大信噪比制度增益：$G_{FM}=3 m_{f}^{2}(m_{f}+1)$

#### PM

$\varphi(t)=m_{p}\cos\omega_{m}t=K_{_p}m(t)$，$K_p$ 为调相灵敏度

$m_p=K_pA_m$ 称为调相指数，表示最大相位偏移

### 方法

- 直接调频：压控振荡器 (VCO) 自身就是一个 FM 调制器，通过信号就能产生调频波。
  - 优点：可以获得较大的频偏
  - 缺点：频率稳定度不高。改进途径：采用锁相环（PLL）调制器
- 间接调频：积分 - 调相 - 得到窄带调频（NBFM）信号 - 倍频器 - 得到宽带调频（WBFM）信号
- 解调：
  - 非相干（鉴频器）：振幅鉴频器、相位鉴频器、比例鉴频器、正交鉴频器、斜率鉴频器、频率负反馈解调器、锁相环(PLL)鉴频器等
    - 鉴频器结构：BPF + 限幅 - 微分器 - 包络检波 - LPF
      - 限幅器的作用是消除信道中噪声等引起的调频波的幅度起伏。
      - 微分器的作用是把幅度恒定的调频波变成幅度和频率都随调制信号 m(t) 变化的调幅调频波。
      - 包络检波器则将其幅度变化检出并滤去直流，再经低通滤波后即得解调输出
  - 相干（NBFM only）：输出 $m_o(t)=\frac{AK_f}2m(t)$

### 性能

- 小信噪比：门限效应

门限效应：在小信噪比的情况（输入信号幅度远小于噪声幅度），输出信噪比急剧恶化。开始出现门限效应的输入信噪比称为门限值。$m_f$ 越大，门限值越高，输出信噪比的改善越明显。
降低门限值（也称门限扩展）的方法有很多，例如，可以采用锁相环解调器和负反馈解调器。还可以采用“预加重”和“去加重”技术来进一步改善调频解调器的输出信噪比，这也相当于改善了门限。

| 方式 | 带宽          |
| ---- | ------------- |
| AM   | $2f_m$        |
| DSB  | $2f_m$        |
| SSB  | $f_m$         |
| VSB  | $>f_m$        |
| FM   | $2(m_f+1)f_m$ |

抗噪声性能：WBFM 抗噪声性能最好，DSB、SSB、VSB 抗噪声性能次之，AM 抗噪声性能最差。当输入信噪比较高时，FM 的调频指数越大，抗噪声性能越好。

频带利用率：SSB 的带宽最窄，其频带利用率最高；FM 占用的带宽随调频指数的增大而增大，其频带利用率最低。

## 数字

RZ，NRZ，单极性 0~+E，双极性 -E~+E

单极性有直流分量；单极性 RZ 有定时分量，NRZ 没有。

功率谱包含连续谱和可能的离散谱；双极性等概没有离散谱，也就是没有直流分量和定时分量。

无离散谱条件：$PG_1(mf_b)+(1-P)G_2(mf_b)=0$

二进制基带信号的时间波形的占空比越小，占用频带越宽，NRZ 带宽为 $f_s$，RZ 为 $2f_s$

### 转码

传输码的码型选择原则：不含直流，且低频分量尽量少；应含有丰富的定时信息；功率谱主瓣宽度窄，以节省传输频带；具有内在的检错能力，即码型应具有一定规律性。

- AMI 码（Alternate Mark Inversion）：传号交替反转码，将消息码的 `1` (传号) 交替地变换为 `+1` 和 `-1`，而 `0` (空号) 保持不变。
  - 优点：没有直流成分，高、低频分量少，编译码电路简单
  - 缺点：长 `0` 串，信号的电平长时间不跳变，提取定时信号困难。
- HDB3 码：3 阶高密度双极性码
  - [编码规则](https://www.bilibili.com/video/BV1Me411z7WX/?p=15&t=126)：基于 AMI 码，四连零置 V 并赋予极性（相邻 V 码反极性）；再添加 B 调节脉冲；最后一个 V 后的非 0 需要反调节。
  - [解码规则](https://www.bilibili.com/video/BV1Me411z7WX/?p=15&t=320)：恢复连 0，再变 1
- 双相码：0 = 01，1 = 10
- 差分双相码：与已编码的前一个波形 0 相同 1 不同
- 密勒码：0 不变，1 中心跳变，二连 0 中间的边界跳变
- CMI：1 -> 11, 00 交替；0 -> 01

考试只考 AMI，HDB3

### 分析与计算

两种误码原因：码间串扰，信道加性噪声

码间串扰：系统传输总特性不理想，导致前后码元的波形畸变并使前面波形出现很长的拖尾，从而对当前码元的判决造成干扰。

- 频带利用率：$\eta=R_B/B$

#### （无码间串扰）传输特性

- 理想低通特性：
  - 带宽为 $B=\frac1{2Ts}$（Hz），第一零点带宽是奈奎斯特带宽，$R_B= 1/T_s$，称为奈奎斯特速率，若高于奈奎斯特速率传输会有码间串扰。
  - 最高频带利用率为 2
- 余弦滚降特性：
  - 滚降系数 $\alpha=f_\Delta/f_N$ = 超出奈奎斯特带宽的扩展量 / 奈奎斯特带宽
  - 带宽 $B=f_\Delta+f_N=f_N(1+\alpha)$
  - 最高频带利用率为 $\eta=R_B/B=\frac2{1+\alpha}$
    - 在数字基带系统中频带利用率是 $\eta=R_B/B=\frac1{1+\alpha}$
  - 滚降系数 α 越大，h(t) 的拖尾衰减越快

奈奎斯特第一准则：$\sum_iH(\omega+2\pi R_Bi)=C\quad\begin{vmatrix}\omega\end{vmatrix}\leq\pi R_B$，满足即消除码间串扰。做题：求得 $H(\omega-2\pi R_B)+H(\omega)+H(\omega+2\pi R_B)=C\quad|\omega|\leq\pi R_B$ 即可。

- 二进制双极性基带系统
  - P(0) == P(1) 时最佳门限电平 Vd\* = 0
  - 总误码率 $\displaystyle P_e=\frac12erfc(\frac A{\sqrt2\sigma_n})$，erfc 单调递减。
- 二进制单极性基带系统：
  - P(0) == P(1) 时最佳门限电平 Vd\* = A/2
  - 总误码率 $\displaystyle P_e=\frac12erfc(\frac A{2\sqrt2\sigma_n})$，双极性比单极性误码率低。

眼图是波形叠加，越大码间串扰越小，中横是最佳判决电平，中竖是最佳抽样时刻

改善：

1. 提高频带利用率 - 部分响应技术：人为地在码元的抽样时刻引入码间串扰，并在接收端判决前加以消除
   - 预编码 $b_k=a_k \bigoplus b_{k-1}$ 相关编码 $C_k=b_k+b_{k-1}$ 模 2 判决 $a_k=C_k mod 2$
   - 差错传播问题：一个差错影响后续所有码差错（相邻码元相关性）
   - 当输入为 L 进制信号时，第 I、IV 类部分响应信号的相关电平数为（2L-1）个
   - 优点：能实现 2B 频带利用率，且传输波形尾部衰减大，收敛快
   - 缺点：编码电平数要超过进制数，抗噪声性能要比 0 类响应系统差
2. 减少码间串扰 - 时域均衡技术：可调滤波器，校正或补偿系统特性

### 调制

- 2ASK (二进制振幅键控; OOK)：1 通 0 不通
  - 模拟调制法（基带载波直接相乘） / 键控法
  - （第一零点带宽）：2fs
  - 功率谱：在 |fc| 处连续谱最大并有离散谱，连续谱集中在 |fc - fs|, |fc + fs| 上。
  - 解调
    - 包络检波：带通滤波 - 全波整流 - 低通滤波 - 抽样判决
      - 误码率 $\displaystyle P_e = \frac12e^{-r/4}$，r 为输入信噪比 $\displaystyle r=\frac{a^2}{2\sigma_n^2}$，a 是解调器输入信号振幅
    - 判决 Vd\* = 0
    - 相干解调：带通滤波 - 相乘器 - 低通滤波 - 抽样判决
      - 等概最佳判决门限 a/2
      - 误码率 $P_{e}=\frac{1}{2} erfc(\sqrt{\frac{r}{4}})$，大信噪比时 $\displaystyle P_e\approx\frac1{\sqrt{\pi r}}e^{-\mathrm{r}/4}$
    - 相干解调无门限效应，信噪比不大时抗噪性能更好，但设备复杂
- 2FSK（二进制频移键控）：双载波，1 时用 f1，2 时用 f2
  - 带宽 $B_{2\mathrm{FSK}}=\begin{vmatrix}f_2-f_1\end{vmatrix}+2f_s$ （只有它的带宽和其他三个不一样）
  - 功率谱：离散谱在 f1, f2 处；连续谱在 f1, f2 最大，向左右方向分别延展 fs；与 (f1 + f2) / 2 偶对称，注意单峰和双峰。
  - 解调
    - 误码率：把 $r = 2r$ 带入前面 2ASK 公式即可。
    - 包络检波：双带通滤波器（取不同频载波），双包络检波器，单判决器（判决：对比两个包络检波的输出电平）
    - 相干解调：也是带通分离，然后双路相干解调
    - 过零解调：限幅 - 微分 - 整流 - 脉冲展宽 - 低通
    - 高信噪比时性能相当，往往用包络检波
- 2PSK（二进制相移键控）：sin 0，-sin 1
  - 模拟调制（双极性不归零 \* cos），键控（双源）
  - 功率谱和带宽与 2ASK 相同；但是当 P=1/2 时，没有离散谱
  - 相干解调：&lt;0 出 1，&gt;0 出 0
    - 误码率：把 $r = 4r$ 带入前面 2ASK 公式即可。
  - 倒 π 现象：恢复过程中相位模糊，解调信号正好相反
- 2DPSK（二进制差分相移键控），先算异或 $b_n=a_n\bigoplus b_{n-1}$ 再画 b 的 2PSK。（需要画参考 0，也就是 $b_{-1}$ 的码）
  - 调制：码变换后过 2PSK
  - 功率谱，带宽 = 2PSK
  - 解调
    - 相干解调（2PSK - 码反变换）：误码率 $P_{e}=erfc(\sqrt{r})$（注意：不再是 4r）
    - 相位比较法：过一个 Ts 的延迟器与自己相乘，误码率对 2ASK 包络检波，相当于 4r
    - 2DPSK 系统抗加性白噪声性能比 2PSK 的要差
- 2PSK 最佳判决门限为零，总能保持工作在最佳判决门限状态。2FSK 只跟输出有关，不需要人为设置；2ASK 最差，跟输入有关，要设置。

[误码与带宽表](https://www.bilibili.com/video/BV1Me411z7WX/?p=22&t=658)

## 模拟编码

抽样

- 低通抽样无失真条件：$f_s>=2f_H$，右边称为奈奎斯特速率；$f_H$ 为原信号截止频率
- 带通抽样无失真条件：$f_s>=2B(1+\frac{k}{n})$，n 为 $\displaystyle\frac{f_h}{B}$ 整数部分，k 为小数部分

量化：

- 量化电平：量化区间的中点电平
- 量化误差：|实际 - 量化值|
- 区间等间隔：均匀量化
- 概率密度均匀的信号量噪比为 $\displaystyle\frac{S_0}{N_q}=M^2$

### 编码调制

PCM（脉冲编码调制）：抽样+量化+编码

- A 律 13 折线：8 位折叠码，首位表示极性(0-, 1+)，2-4 段落码，5-8 段内码
  - 段落码（3 位表示 8 段）：总长 2048 单位，分为 8 段落，后段落是前段落长度 2 倍。
  - 每段落再**均分**为 16 段，用后四位段内码表示。
  - 编码电平是向下取边缘，译码电平是取区间电平中点
- PCM 系统中的噪声有两种：量化噪声和加性噪声
  - $M=2^N$，N 是信号进制数
- 码元速率：$R_B=Nf_s$
- 最小传输带宽（奈奎斯特带宽）：$B=Nf_H$.
- 传输带宽：$B=Nf_s$

DPCM（差分脉冲编码调制）：

- 预测编码原理：根据前几个抽样值计算出一个预测值，再取当前抽样值和预测值之差传输。此差值称为预测误差。
  - 仅使用前面一个抽样值计算则为 DPCM
- 增量调制：最简单的 DPCM，量化器的量化电平数取为 2 时的特殊情况。
  - 抽样线在格点上，每个抽样时必需将抽样线往实际线方向垂直移动一格，并水平保持到下一个抽样时刻。升 1 降 0。
  - 码元速率：$R_B=f_s$
  - 最小传输带宽（奈奎斯特带宽）：$B=\frac12f_s$.
  - 传输带宽：$B=f_s$

### 最佳接收

- ML（maximum likelihood criterion，最大似然准则）：P(0) == P(1) 时判决的简化准则
- MAP（maximum a posteriori criterion，最大后验概率准则）：

匹配滤波器：使抽样时刻输出信噪比最大的线性滤波器

- 冲激响应：$h(t)=ks(T_s-t)$
- 输出波形：$s_o(t)=kR(t-T_s)$（出现了自相关函数）
- 上式 k 一般取 1

匹配滤波法：双匹配滤波器 + 双抽样 + 单判决（判决抽样值），能得到最佳接收

误码率：$\displaystyle P_e=\frac12erfc[\sqrt{\frac{E_b(1-\rho)}{2n_0}}]$，$E_b$ 为码元能量，$\rho$ 相关系数，$n_0$ 为噪声功率谱密度

### 杂

- FDM：主要用于模拟信号，普遍应用在多路载波电话系统中。
  - 缺点：引入非线性失真；滤波器难以制作
