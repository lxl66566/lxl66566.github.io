import{_ as g,e as y,f as d,k as u,g as s,i as l,h as t,j as e,r as o,o as A}from"./app-CU-1af40.js";const f="/images/articles/vps/news.jpg",b={},m={style:{"text-align":"center"}},F={style:{"text-align":"center"}},x={style:{"text-align":"center"}},v={style:{"text-align":"center"}},B={style:{"text-align":"center"}},C={style:{"text-align":"center"}},E={style:{"text-align":"center"}},w={style:{"text-align":"center"}},P={style:{"text-align":"center"}},D={style:{"text-align":"center"}},S={style:{"text-align":"center"}},G={style:{"text-align":"center"}},j={style:{"text-align":"center"}},T={style:{"text-align":"center"}},$={style:{"text-align":"center"}},V={style:{"text-align":"center"}},M={style:{"text-align":"center"}},c={style:{"text-align":"center"}};function z(q,i){const n=o("dtlslong"),h=o("dtls"),k=o("Tabs"),p=o("RouteLink");return A(),y("div",null,[i[187]||(i[187]=d('<h1 id="vps" tabindex="-1"><a class="header-anchor" href="#vps"><span>VPS</span></a></h1><p>我与我的 VPS 的故事。服务器运维/代理搭建。</p><p>与 VPS 无关的 linux 问题请移步 <a href="./linux">linux</a></p><h2 id="个人偏好" tabindex="-1"><a class="header-anchor" href="#个人偏好"><span>个人偏好</span></a></h2><ul><li>带宽偏好：我个人入户只有 100Mbps，所以不低于 100Mbps 我都能接受。国内云厂商那堆小水管还是算了吧。</li><li>地点偏好：我有明确的地点偏好：JP。 <ul><li>我对延迟有一定要求，所以 US 全部 out。不过由于 US 机便宜，有时也会搞个当备用垫底。</li><li>在东亚里，SG, KR, TW 的延迟也是垫底的，随便 ping 都上 200ms。所以 out。</li><li>最后剩下 JP 和 HK，虽然 HK 延迟最低，但由于非常多的服务是屏蔽 HK 的（chatgpt，许多日本网站，gemini 和其他 google 家大模型），所以 JP 胜出。</li></ul></li></ul><h2 id="购买" tabindex="-1"><a class="header-anchor" href="#购买"><span>购买</span></a></h2><h3 id="消息来源" tabindex="-1"><a class="header-anchor" href="#消息来源"><span>消息来源</span></a></h3><ul><li><a href="https://zhujiwiki.com" target="_blank" rel="noopener noreferrer">主机百科</a></li><li><a href="https://www.nodeseek.com/" target="_blank" rel="noopener noreferrer">nodeseek</a></li><li><a href="https://lowendbox.com/" target="_blank" rel="noopener noreferrer">lowendbox</a></li><li><a href="https://runaway.rip/" target="_blank" rel="noopener noreferrer">Runaway</a> 避坑</li></ul><h3 id="我买到的" tabindex="-1"><a class="header-anchor" href="#我买到的"><span>我买到的</span></a></h3>',9)),u(" prettier-ignore "),s("table",null,[i[147]||(i[147]=s("thead",null,[s("tr",null,[s("th",{style:{"text-align":"center"}},"Host"),s("th",{style:{"text-align":"center"}},"location"),s("th",{style:{"text-align":"center"}},"Price"),s("th",{style:{"text-align":"center"}},"bandwidth"),s("th",{style:{"text-align":"center"}},"RAM"),s("th",{style:{"text-align":"center"}},"Storage"),s("th",{style:{"text-align":"center"}},"Core"),s("th",{style:{"text-align":"center"}},"saying")])],-1)),s("tbody",null,[s("tr",null,[i[1]||(i[1]=s("td",{style:{"text-align":"center"}},[t("20230514 "),s("a",{href:"https://my.racknerd.com/cart.php?a=add&pid=695",target:"_blank",rel:"noopener noreferrer"},"RackNerd")],-1)),i[2]||(i[2]=s("td",{style:{"text-align":"center"}},"San Jose",-1)),i[3]||(i[3]=s("td",{style:{"text-align":"center"}},"$10.28/yr",-1)),i[4]||(i[4]=s("td",{style:{"text-align":"center"}},"1000GB 1Gbps",-1)),i[5]||(i[5]=s("td",{style:{"text-align":"center"}},"768MB",-1)),i[6]||(i[6]=s("td",{style:{"text-align":"center"}},"10GB",-1)),i[7]||(i[7]=s("td",{style:{"text-align":"center"}},"1",-1)),s("td",m,[l(n,null,{default:e(()=>i[0]||(i[0]=[t("装了 Debian 10（后来换成了 12）。美西机 + trojan 真连接常年 700+ms，显然不能做游戏服务器。"),s("sup",{class:"footnote-ref"},[s("a",{href:"#footnote1"},"[1]"),s("a",{class:"footnote-anchor",id:"footnote-ref1"})],-1)])),_:1})])]),s("tr",null,[i[9]||(i[9]=s("td",{style:{"text-align":"center"}},[t("20230602 "),s("a",{href:"https://distribute.vpslog.net/",target:"_blank",rel:"noopener noreferrer"},"vpslog")],-1)),i[10]||(i[10]=s("td",{style:{"text-align":"center"}},null,-1)),i[11]||(i[11]=s("td",{style:{"text-align":"center"}},"free",-1)),i[12]||(i[12]=s("td",{style:{"text-align":"center"}},null,-1)),i[13]||(i[13]=s("td",{style:{"text-align":"center"}},"64MB",-1)),i[14]||(i[14]=s("td",{style:{"text-align":"center"}},null,-1)),i[15]||(i[15]=s("td",{style:{"text-align":"center"}},null,-1)),s("td",F,[l(n,null,{default:e(()=>i[8]||(i[8]=[t("白嫖的小鸡，纯 v6，太捞只能装 alpine，还要定期续。后来不续了。")])),_:1})])]),s("tr",null,[i[17]||(i[17]=s("td",{style:{"text-align":"center"}},[t("20231124 "),s("a",{href:"www.silicloud.com"},"silicloud"),t(" (BF)")],-1)),i[18]||(i[18]=s("td",{style:{"text-align":"center"}},"Tokyo",-1)),i[19]||(i[19]=s("td",{style:{"text-align":"center"}},"HK$128/yr",-1)),i[20]||(i[20]=s("td",{style:{"text-align":"center"}},"300GB 300Mbps",-1)),i[21]||(i[21]=s("td",{style:{"text-align":"center"}},"768MB",-1)),i[22]||(i[22]=s("td",{style:{"text-align":"center"}},"20GB",-1)),i[23]||(i[23]=s("td",{style:{"text-align":"center"}},"1",-1)),s("td",x,[l(n,null,{default:e(()=>i[16]||(i[16]=[t("提供 archlinux 镜像。没有 rescue。稳定性开始还行，半年后差不多烂完了。")])),_:1})])]),s("tr",null,[i[25]||(i[25]=s("td",{style:{"text-align":"center"}},"20231212 azure",-1)),i[26]||(i[26]=s("td",{style:{"text-align":"center"}},"Korea Central",-1)),i[27]||(i[27]=s("td",{style:{"text-align":"center"}},[s("s",null,"$9.xx/mo"),t(" free")],-1)),i[28]||(i[28]=s("td",{style:{"text-align":"center"}},"unknown",-1)),i[29]||(i[29]=s("td",{style:{"text-align":"center"}},"1GB",-1)),i[30]||(i[30]=s("td",{style:{"text-align":"center"}},"30GB",-1)),i[31]||(i[31]=s("td",{style:{"text-align":"center"}},"1",-1)),s("td",v,[l(n,null,{default:e(()=>i[24]||(i[24]=[t("学生优惠送 $100 现金券，买这个等级的，每年用 10 个月。")])),_:1})])]),s("tr",null,[i[33]||(i[33]=s("td",{style:{"text-align":"center"}},"20231213 aliyun",-1)),i[34]||(i[34]=s("td",{style:{"text-align":"center"}},"HK",-1)),i[35]||(i[35]=s("td",{style:{"text-align":"center"}},[s("s",null,"288CNY/yr"),t(" free")],-1)),i[36]||(i[36]=s("td",{style:{"text-align":"center"}},"1024 GB unknown",-1)),i[37]||(i[37]=s("td",{style:{"text-align":"center"}},"896MB",-1)),i[38]||(i[38]=s("td",{style:{"text-align":"center"}},"40GB",-1)),i[39]||(i[39]=s("td",{style:{"text-align":"center"}},"2",-1)),s("td",B,[l(n,null,{default:e(()=>i[32]||(i[32]=[t("香港地区 TG 时常抽风；免费的香港机我想都不敢想（）")])),_:1})])]),s("tr",null,[i[41]||(i[41]=s("td",{style:{"text-align":"center"}},"202403xx wawo",-1)),i[42]||(i[42]=s("td",{style:{"text-align":"center"}},"US",-1)),i[43]||(i[43]=s("td",{style:{"text-align":"center"}},"￥3.73/mo",-1)),i[44]||(i[44]=s("td",{style:{"text-align":"center"}},"unknown",-1)),i[45]||(i[45]=s("td",{style:{"text-align":"center"}},"512MB",-1)),i[46]||(i[46]=s("td",{style:{"text-align":"center"}},"unknown",-1)),i[47]||(i[47]=s("td",{style:{"text-align":"center"}},"1",-1)),s("td",C,[l(n,null,{default:e(()=>i[40]||(i[40]=[t("冲便宜买的，质量很捞，本来是用作测试的。结果半个月给我封了，莫名其妙。于是避雷 wawo 了。")])),_:1})])]),s("tr",null,[i[49]||(i[49]=s("td",{style:{"text-align":"center"}},"20240518 Churros",-1)),i[50]||(i[50]=s("td",{style:{"text-align":"center"}},"JP",-1)),i[51]||(i[51]=s("td",{style:{"text-align":"center"}},"￥8.9/mo + ￥6 初装",-1)),i[52]||(i[52]=s("td",{style:{"text-align":"center"}},"200GB 100Mbps",-1)),i[53]||(i[53]=s("td",{style:{"text-align":"center"}},"1GB",-1)),i[54]||(i[54]=s("td",{style:{"text-align":"center"}},"5GB",-1)),i[55]||(i[55]=s("td",{style:{"text-align":"center"}},"1",-1)),s("td",E,[l(n,null,{default:e(()=>i[48]||(i[48]=[t("silicloud IP 寄了，换台 JP。这家是超级垃圾灵车，非常不稳定")])),_:1})])]),s("tr",null,[i[57]||(i[57]=s("td",{style:{"text-align":"center"}},"20240714 Akile",-1)),i[58]||(i[58]=s("td",{style:{"text-align":"center"}},"HK",-1)),i[59]||(i[59]=s("td",{style:{"text-align":"center"}},"￥5/mo",-1)),i[60]||(i[60]=s("td",{style:{"text-align":"center"}},"200GB 1000Mbps",-1)),i[61]||(i[61]=s("td",{style:{"text-align":"center"}},"1GB",-1)),i[62]||(i[62]=s("td",{style:{"text-align":"center"}},"5GB",-1)),i[63]||(i[63]=s("td",{style:{"text-align":"center"}},"1",-1)),s("td",w,[l(n,null,{default:e(()=>i[56]||(i[56]=[t("akile 很灵车，不推荐。介于 Churros 和 Lamhosting 之间。")])),_:1})])]),s("tr",null,[i[65]||(i[65]=s("td",{style:{"text-align":"center"}},"20240726 Lamhosting",-1)),i[66]||(i[66]=s("td",{style:{"text-align":"center"}},"TW",-1)),i[67]||(i[67]=s("td",{style:{"text-align":"center"}},"￥10.6/mo(coupon -￥2)",-1)),i[68]||(i[68]=s("td",{style:{"text-align":"center"}},"512GB 1000Mbps",-1)),i[69]||(i[69]=s("td",{style:{"text-align":"center"}},"512M",-1)),i[70]||(i[70]=s("td",{style:{"text-align":"center"}},"10GB",-1)),i[71]||(i[71]=s("td",{style:{"text-align":"center"}},"1",-1)),s("td",P,[l(n,null,{default:e(()=>i[64]||(i[64]=[t("有点灵，TW ping 都有 190ms… 比 akile 稳一点，但不算太多")])),_:1})])]),s("tr",null,[i[73]||(i[73]=s("td",{style:{"text-align":"center"}},"20240820 SurfCloud",-1)),i[74]||(i[74]=s("td",{style:{"text-align":"center"}},"HK",-1)),i[75]||(i[75]=s("td",{style:{"text-align":"center"}},"$1/mo",-1)),i[76]||(i[76]=s("td",{style:{"text-align":"center"}},"200GB 30Mbps",-1)),i[77]||(i[77]=s("td",{style:{"text-align":"center"}},"1G",-1)),i[78]||(i[78]=s("td",{style:{"text-align":"center"}},"40GB",-1)),i[79]||(i[79]=s("td",{style:{"text-align":"center"}},"1",-1)),s("td",D,[l(n,null,{default:e(()=>i[72]||(i[72]=[t("银联付款，需要编辑防火墙，便宜实惠。缺点是太慢了点…")])),_:1})])]),s("tr",null,[i[81]||(i[81]=s("td",{style:{"text-align":"center"}},"20240911 YXVM",-1)),i[82]||(i[82]=s("td",{style:{"text-align":"center"}},"JP",-1)),i[83]||(i[83]=s("td",{style:{"text-align":"center"}},"$3/mo",-1)),i[84]||(i[84]=s("td",{style:{"text-align":"center"}},"1TB 500Mbps",-1)),i[85]||(i[85]=s("td",{style:{"text-align":"center"}},"768MB",-1)),i[86]||(i[86]=s("td",{style:{"text-align":"center"}},"5GB",-1)),i[87]||(i[87]=s("td",{style:{"text-align":"center"}},"1",-1)),s("td",S,[l(n,null,{default:e(()=>i[80]||(i[80]=[t("买这家要靠抢。刚开始不错，稳定性高，延迟低。后面炸了几次，每天晚上可用性也大幅降低了。两个月弃坑。")])),_:1})])]),i[146]||(i[146]=s("tr",null,[s("td",{style:{"text-align":"center"}},"20241018 azure"),s("td",{style:{"text-align":"center"}},"JP"),s("td",{style:{"text-align":"center"}},"free"),s("td",{style:{"text-align":"center"}},"?"),s("td",{style:{"text-align":"center"}},"1G"),s("td",{style:{"text-align":"center"}},"30G"),s("td",{style:{"text-align":"center"}},"1"),s("td",{style:{"text-align":"center"}},"微软，我的超人")],-1)),s("tr",null,[i[89]||(i[89]=s("td",{style:{"text-align":"center"}},[t("20241031 "),s("a",{href:"https://91idc.gg/index.php",target:"_blank",rel:"noopener noreferrer"},"91idc")],-1)),i[90]||(i[90]=s("td",{style:{"text-align":"center"}},"HK",-1)),i[91]||(i[91]=s("td",{style:{"text-align":"center"}},"￥10/mo",-1)),i[92]||(i[92]=s("td",{style:{"text-align":"center"}},"666GB 20MBps",-1)),i[93]||(i[93]=s("td",{style:{"text-align":"center"}},"1G",-1)),i[94]||(i[94]=s("td",{style:{"text-align":"center"}},"10G",-1)),i[95]||(i[95]=s("td",{style:{"text-align":"center"}},"1",-1)),s("td",G,[l(n,null,{default:e(()=>i[88]||(i[88]=[t("优惠码无法使用；带宽偏低；新商家，稳定倒是挺稳定的")])),_:1})])]),s("tr",null,[i[97]||(i[97]=s("td",{style:{"text-align":"center"}},[t("20250107 "),s("a",{href:"https://portal.sakuraclouds.com/",target:"_blank",rel:"noopener noreferrer"},"Sakura Clouds")],-1)),i[98]||(i[98]=s("td",{style:{"text-align":"center"}},"HK",-1)),i[99]||(i[99]=s("td",{style:{"text-align":"center"}},[s("s",null,"$2.50/mo"),t(" $2.20")],-1)),i[100]||(i[100]=s("td",{style:{"text-align":"center"}},"2TB 1Gbps",-1)),i[101]||(i[101]=s("td",{style:{"text-align":"center"}},"1G",-1)),i[102]||(i[102]=s("td",{style:{"text-align":"center"}},"8G",-1)),i[103]||(i[103]=s("td",{style:{"text-align":"center"}},"1",-1)),s("td",j,[l(n,null,{default:e(()=>i[96]||(i[96]=[t("速度还行，但是延迟和稳定性"),s("strong",null,"超烂",-1),t("，没有下次了。")])),_:1})])]),s("tr",null,[i[105]||(i[105]=s("td",{style:{"text-align":"center"}},[t("20250109 "),s("a",{href:"https://claw.cloud/",target:"_blank",rel:"noopener noreferrer"},"ClawCloud")],-1)),i[106]||(i[106]=s("td",{style:{"text-align":"center"}},"JP",-1)),i[107]||(i[107]=s("td",{style:{"text-align":"center"}},[s("s",null,"$36.00/yr"),t(" $7.00/yr")],-1)),i[108]||(i[108]=s("td",{style:{"text-align":"center"}},"500GB",-1)),i[109]||(i[109]=s("td",{style:{"text-align":"center"}},"1G",-1)),i[110]||(i[110]=s("td",{style:{"text-align":"center"}},"20G",-1)),i[111]||(i[111]=s("td",{style:{"text-align":"center"}},"1",-1)),s("td",T,[l(n,null,{default:e(()=>i[104]||(i[104]=[t("阿里云“上游”，超级好价 + 稳定 + 高速，神中神血赚。爽用了 9 个月，之后开始出现稳定性下降、延迟增大等问题。")])),_:1})])]),s("tr",null,[i[115]||(i[115]=s("td",{style:{"text-align":"center"}},[t("20250404 "),s("a",{href:"nube.sh"},"nube.sh")],-1)),i[116]||(i[116]=s("td",{style:{"text-align":"center"}},"JP",-1)),i[117]||(i[117]=s("td",{style:{"text-align":"center"}},"$0.0012/h + $0.0031/GB",-1)),i[118]||(i[118]=s("td",{style:{"text-align":"center"}},"不限",-1)),i[119]||(i[119]=s("td",{style:{"text-align":"center"}},"1GB",-1)),i[120]||(i[120]=s("td",{style:{"text-align":"center"}},"10GB",-1)),i[121]||(i[121]=s("td",{style:{"text-align":"center"}},"1",-1)),s("td",$,[i[113]||(i[113]=s("a",{href:"http://hpaste.spiritlhl.net/#/show/bp0wd.txt",target:"_blank",rel:"noopener noreferrer"},"测评",-1)),i[114]||(i[114]=t("；")),l(n,null,{default:e(()=>i[112]||(i[112]=[t("前端好评；一次最少充 $10，试错成本挺高；延迟一般，特别是联通很烂。"),s("br",null,null,-1),t("用了一个月，连通性差了很多，基本是不可用状态，纯纯狗屎")])),_:1})])]),s("tr",null,[i[123]||(i[123]=s("td",{style:{"text-align":"center"}},[t("20250805 "),s("a",{href:"https://skystroll.net/store",target:"_blank",rel:"noopener noreferrer"},"skystroll")],-1)),i[124]||(i[124]=s("td",{style:{"text-align":"center"}},"JP",-1)),i[125]||(i[125]=s("td",{style:{"text-align":"center"}},"$2.49/mo",-1)),i[126]||(i[126]=s("td",{style:{"text-align":"center"}},"1T 500Mbps",-1)),i[127]||(i[127]=s("td",{style:{"text-align":"center"}},"512M",-1)),i[128]||(i[128]=s("td",{style:{"text-align":"center"}},"5GB",-1)),i[129]||(i[129]=s("td",{style:{"text-align":"center"}},"1",-1)),s("td",V,[l(n,null,{default:e(()=>i[122]||(i[122]=[t("刚买的时候 IP 国内就是 ping 不通的。然后开的工单一天后才回复，换了个 IP 还得重装才能用。这家虽然延迟还行，但是 IP 是真的垃圾，稳定性也很灵车，经常用一半突然断了。")])),_:1})])]),s("tr",null,[i[131]||(i[131]=s("td",{style:{"text-align":"center"}},[t("20250820 "),s("a",{href:"https://my.rfchost.com/",target:"_blank",rel:"noopener noreferrer"},"RFCHOST")],-1)),i[132]||(i[132]=s("td",{style:{"text-align":"center"}},"JP",-1)),i[133]||(i[133]=s("td",{style:{"text-align":"center"}},"$29.99/yr + ￥45",-1)),i[134]||(i[134]=s("td",{style:{"text-align":"center"}},"1T 不限",-1)),i[135]||(i[135]=s("td",{style:{"text-align":"center"}},"512M",-1)),i[136]||(i[136]=s("td",{style:{"text-align":"center"}},"10GB",-1)),i[137]||(i[137]=s("td",{style:{"text-align":"center"}},"1",-1)),s("td",M,[l(n,null,{default:e(()=>i[130]||(i[130]=[t("看评测挺不错的，延迟很低，价格也合适，于是在 nodeseek 上蹲了几天蹲到一个。溢价还是有点高，因为第二天就有更合适的出现了，不过也不用在乎这么多。")])),_:1})])]),s("tr",null,[i[139]||(i[139]=s("td",{style:{"text-align":"center"}},[t("20250827 "),s("a",{href:"https://billing.dedirock.com/index.php",target:"_blank",rel:"noopener noreferrer"},"dedirock")],-1)),i[140]||(i[140]=s("td",{style:{"text-align":"center"}},"US (LA)",-1)),i[141]||(i[141]=s("td",{style:{"text-align":"center"}},"$7/yr",-1)),i[142]||(i[142]=s("td",{style:{"text-align":"center"}},"2T 1Gbps",-1)),i[143]||(i[143]=s("td",{style:{"text-align":"center"}},"2G",-1)),i[144]||(i[144]=s("td",{style:{"text-align":"center"}},"30G",-1)),i[145]||(i[145]=s("td",{style:{"text-align":"center"}},"1",-1)),s("td",c,[l(n,null,{default:e(()=>i[138]||(i[138]=[t("手上只有 JP 机确实让我感受到一些限制，"),s("s",null,"例如禁漫就没法登上去",-1),t("。刚好看到便宜美西机，所以搞了个，延迟就无所谓了。注意 paypal 付款会被自动订阅一个续费需要去取消掉。这家的官网从 JP 加载贼慢，但是机子还挺不错。延迟不会超过 200ms，已经算好了。")])),_:1})])])])]),i[188]||(i[188]=d('<h3 id="白嫖" tabindex="-1"><a class="header-anchor" href="#白嫖"><span>白嫖</span></a></h3><p>阿里云和 Azure 理论上都是不能当代理机用的，不过真拿来跑，自用的话它们也不管。</p><ul><li>阿里云学生：免费服务器，<strong>每年</strong> 300 元优惠券，可以全额抵扣。 <ol><li>（需要 chromium 系浏览器）<a href="https://university.aliyun.com" target="_blank" rel="noopener noreferrer">university.aliyun.com</a> 学生认证领券</li><li><s>首页，<em>产品 - 计算 - 轻量应用服务器</em> 下单即可。 新加坡、日本有货，香港需要 12 点抢。注意，下单不锁定，以支付成功为界。</s></li></ol><ul><li><strong>学生优惠现在无法购买轻量</strong>；在领券页面下面只能购买国内 ECS，无法作为翻墙机使用，而且带宽很低。<img src="'+f+`" alt="现在已经寄了" loading="lazy"></li></ul></li><li>Azure：每年 $100 优惠券，学生无限续。财大气粗！ <ol><li>先过学生认证</li><li>服务器下单，配置那边按价格排序一下，选便宜的，1C1G 够用了。</li><li>开好机子，默认不能 root 登录。查看 <a href="#%E5%85%81%E8%AE%B8-root">允许 root</a> 章节可解。</li><li>默认是不放行其他端口的。去 <em>网络</em>，自己添加入站和出站规则，放开所有端口。</li></ol></li><li>Google Cloud：$300 体验金。 <ul><li>Google Cloud 还是有点贵的，最便宜的 1c1g 每个月也要 $22。</li><li>Google Cloud 控制台页面卡得要死。。连接 vps 最好用网页面板。如果想用本机 ssh，要把密钥传到 vps，使用 RESTAPI POST 还不行（没法两步验证），还得下载一个 gcloud cli 是最傻逼的(<a href="https://cloud.google.com/compute/docs/connect/standard-ssh?hl=zh-cn#openssh-client" target="_blank" rel="noopener noreferrer">ref</a>)。所以我建议去网页面板自己<a href="#%E6%B7%BB%E5%8A%A0%E5%85%AC%E9%92%A5">手操</a>。</li><li>Google Cloud 默认也是开启防火墙措施，无法在本机上访问 vps 的其他端口。要在左侧 <em>Cloud NGFW - 防火墙政策</em> 里改一条规则，允许来源改成 <code>0.0.0.0/0</code>，并且将优先级调为 1000。</li></ul></li></ul><h2 id="工具" tabindex="-1"><a class="header-anchor" href="#工具"><span>工具</span></a></h2><ul><li>记得禁用 ipv6！！！不然机子会出现各种 google 墙，youtube 墙，网页打开慢等各种问题。<div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;net.ipv6.conf.all.disable_ipv6 = 1&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tee</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/sysctl.conf</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;net.ipv6.conf.default.disable_ipv6 = 1&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tee</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/sysctl.conf</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sysctl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><a href="https://github.com/lxl66566/init-script" target="_blank" rel="noopener noreferrer">一键代理脚本</a>：不得不提我自己写的一键脚本，一键常用软件 + 代理（hysteria + trojan-go + trojan）</li><li><a href="https://ping.pe/#" target="_blank" rel="noopener noreferrer">ping.pe</a>：连通性</li><li>全面评测： <ul><li><a href="https://github.com/oneclickvirt/ecs" target="_blank" rel="noopener noreferrer">VPS 融合怪 - GO 重构版本</a></li><li>一键网络质量：<a href="https://github.com/xykt/NetQuality" target="_blank" rel="noopener noreferrer">NetQuality</a></li></ul></li><li>全球测速 <ul><li><code>curl -Lso- bench.sh | bash</code>：VPS 信息，全球测速</li></ul></li><li>国内三网测速 <ul><li><a href="https://github.com/spiritLHLS/ecsspeed" target="_blank" rel="noopener noreferrer">ecsspeed</a></li></ul></li><li><a href="https://bgp.tools/" target="_blank" rel="noopener noreferrer">https://bgp.tools/</a>，ASN 信息</li><li><a href="https://ip.skk.moe/" target="_blank" rel="noopener noreferrer">https://ip.skk.moe/</a>，群友搭的查自己 IP 的面板</li><li><a href="https://net.ljxnet.cn/" target="_blank" rel="noopener noreferrer">网络面板</a>流量消耗器</li><li><a href="https://proxy.incolumitas.com/proxy_detect.html" target="_blank" rel="noopener noreferrer">Live Proxy and VPN Detection</a></li><li><a href="https://github.com/bin456789/reinstall" target="_blank" rel="noopener noreferrer">bin456789/reinstall</a>：一键重装或者 dd 到其他镜像</li></ul><h3 id="ssh" tabindex="-1"><a class="header-anchor" href="#ssh"><span>SSH</span></a></h3>`,6)),l(h,{alt:"没啥用的"},{default:e(()=>i[148]||(i[148]=[s("p",null,"youtube 上（与其他教程）清一色的 finalshell，但是这种不开源的小作坊国产软件我不用。不过话说回来，对不会用 linux 的小白，finalshell 门槛确实低（图形文件系统和编辑器）。",-1),s("p",null,[t("先用了 SuperPuTTY，体验挺差，真不如用 cli。差点忘了我有 ArchWSL，于是直接 "),s("code",null,"sudo pacman -S openssl"),t(" 了（。后来转 linux 后就没 ssh 这烦恼了。")],-1),s("p",null,"说回来，其实 windows 好像是有自带(?) ssh 的。",-1),s("p",null,[t("用法："),s("code",null,"ssh root@ip [-p port]")],-1)])),_:1}),i[189]||(i[189]=d(`<h4 id="别名" tabindex="-1"><a class="header-anchor" href="#别名"><span>别名</span></a></h4><p>建立一个 <em>别名 -&gt; VPS(用户 + ip + 端口)</em> 的映射关系。</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># edit ~/.ssh/config</span></span>
<span class="line"><span>Host &lt;name&gt;</span></span>
<span class="line"><span>  User root</span></span>
<span class="line"><span>  Hostname &lt;ip&gt;</span></span>
<span class="line"><span>  Port 22</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="添加公钥" tabindex="-1"><a class="header-anchor" href="#添加公钥"><span>添加公钥</span></a></h4><p>由于 vps 暴露在公网，因此需要复杂的密码，但我肯定不想每次登录都需要输那么一长串的密码，因此需要将公钥添加到 vps。</p>`,5)),l(k,{id:"797",data:[{id:"自动添加"},{id:"手动复制"}]},{title0:e(({value:a,isActive:r})=>i[149]||(i[149]=[t("自动添加")])),title1:e(({value:a,isActive:r})=>i[150]||(i[150]=[t("手动复制")])),tab0:e(({value:a,isActive:r})=>i[151]||(i[151]=[s("p",null,[s("code",null,"ssh-copy-id hostname")],-1)])),tab1:e(({value:a,isActive:r})=>i[152]||(i[152]=[s("p",null,[s("code",null,"cat ~/.ssh/id_*.pub"),t(" 并复制，再粘贴到 vps 的 "),s("code",null,"~/.ssh/authorized_keys"),t(" 内。")],-1)])),_:1}),i[190]||(i[190]=d(`<h4 id="允许-root" tabindex="-1"><a class="header-anchor" href="#允许-root"><span>允许 root</span></a></h4><p>一般的 vps 都是允许 root 登录的，但是像 azure 这些“大厂”则不行。所以需要用户进去改 ssh 配置。</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/ssh/sshd_config</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 设置：</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># PermitRootLogin yes</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># PasswordAuthentication yes</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># PubkeyAuthentication yes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sshd</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="端口转发" tabindex="-1"><a class="header-anchor" href="#端口转发"><span>端口转发</span></a></h3><p>将来自端口 <code>&lt;from&gt;</code> 的流量转发到 <code>&lt;to&gt;</code></p>`,5)),l(k,{id:"822",data:[{id:"socat"},{id:"firewalld"}]},{title0:e(({value:a,isActive:r})=>i[153]||(i[153]=[t("socat")])),title1:e(({value:a,isActive:r})=>i[154]||(i[154]=[t("firewalld")])),tab0:e(({value:a,isActive:r})=>[i[160]||(i[160]=s("div",{class:"language-sh line-numbers-mode","data-highlighter":"shiki","data-ext":"sh",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[s("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"socat"),s("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," TCP-LISTEN:"),s("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"<"),s("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"fro"),s("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"m>"),s("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},",reuseaddr,fork"),s("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," TCP:localhost:"),s("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"<"),s("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"t"),s("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"o> "),s("span",{style:{"--shiki-light":"#A0A1A7","--shiki-light-font-style":"italic","--shiki-dark":"#7F848E","--shiki-dark-font-style":"italic"}},"# 最简型")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"socat"),s("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," -dd"),s("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," -lf"),s("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," <"),s("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"log_fil"),s("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"e> "),s("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"TCP-LISTEN:"),s("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"<"),s("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"fro"),s("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"m>"),s("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},",reuseaddr,fork"),s("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," TCP:localhost:"),s("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"<"),s("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"t"),s("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"o>  "),s("span",{style:{"--shiki-light":"#A0A1A7","--shiki-light-font-style":"italic","--shiki-dark":"#7F848E","--shiki-dark-font-style":"italic"}},"# 复杂型")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"socat"),s("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," -dd"),s("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," -lf"),s("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," <"),s("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"log_fil"),s("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"e> "),s("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"-F"),s("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," port_forwarding.conf"),s("span",{style:{"--shiki-light":"#A0A1A7","--shiki-light-font-style":"italic","--shiki-dark":"#7F848E","--shiki-dark-font-style":"italic"}},"  # 泛用型")])])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1)),s("p",null,[i[156]||(i[156]=t("socat 默认在终端前台进行端口转发，需要后台运行的话可以")),i[157]||(i[157]=s("a",{href:"https://unix.stackexchange.com/a/658320",target:"_blank",rel:"noopener noreferrer"},"写个服务",-1)),i[158]||(i[158]=t("，或者")),l(p,{to:"/articles/linux/package.html#tmux"},{default:e(()=>i[155]||(i[155]=[t("终端复用")])),_:1}),i[159]||(i[159]=t("。"))])]),tab1:e(({value:a,isActive:r})=>i[161]||(i[161]=[s("div",{class:"language-sh line-numbers-mode","data-highlighter":"shiki","data-ext":"sh",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[s("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"firewall-cmd"),s("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --add-forward-port=port="),s("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"<"),s("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"from"),s("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},">"),s("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},":proto=udp:toport="),s("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"<"),s("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"to"),s("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},">"),s("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --permanent")])])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"})])],-1)])),_:1}),i[191]||(i[191]=s("h2",{id:"我的设置",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#我的设置"},[s("span",null,"我的设置")])],-1)),s("ol",null,[i[165]||(i[165]=s("li",null,[s("a",{href:"https://github.com/quic-go/quic-go/wiki/UDP-Buffer-Sizes",target:"_blank",rel:"noopener noreferrer"},"增加 UDP Buffer Sizes")],-1)),s("li",null,[i[163]||(i[163]=t("如果 VPS 没开 bbr 记得开。（")),l(p,{to:"/articles/linux/install_and_config.html#%E7%B3%BB%E7%BB%9F%E8%AE%BE%E7%BD%AE"},{default:e(()=>i[162]||(i[162]=[t("参考 11. sysctl 相关")])),_:1}),i[164]||(i[164]=t("）"))])]),i[192]||(i[192]=d('<h2 id="安全性" tabindex="-1"><a class="header-anchor" href="#安全性"><span>安全性</span></a></h2><p>VPS 的公网 ip 会带来安全性问题，不过尝试登录的多，真正攻进去的也几乎没有。</p><h3 id="自检" tabindex="-1"><a class="header-anchor" href="#自检"><span>自检</span></a></h3><ul><li>可以在 <code>/var/log/auth.log</code> 中查看登录日志。我的日志里的攻击记录非常多。 <ul><li><code>less /var/log/auth.log | grep -i &#39;accepted&#39;</code> 可以查看登录成功的记录，看看是不是自己的 ip。</li></ul></li><li><code>ps aux | grep sshd</code> 查看有没有除自己以外的 <code>sshd: root [.*]</code> 类型的进程。 <ul><li><code>ps aux | grep &#39;sshd&#39; | grep -v &#39;root@pts/0\\|grep\\|/sbin/sshd&#39; | awk &#39;{print $2}&#39; | xargs kill -9</code> 可以杀掉这些进程。（很粗糙了属于是）</li></ul></li><li><code>lastb -9</code> 可以查看最近 9 条登录失败记录</li></ul><h3 id="解法" tabindex="-1"><a class="header-anchor" href="#解法"><span>解法</span></a></h3><ul><li>可以通过修改 <code>/etc/ssh/sshd_config</code> 中的内容进行限制，例如修改 <code>MaxAuthTries</code>。</li><li>密码位数太少也不安全。一个简单的方法是将你的密码重复两遍。</li><li>限制登录 ip。修改 <code>/etc/hosts.allow</code> &amp; <code>/etc/hosts.deny</code> 文件。</li><li>尝试 fail2ban 等软件。（这个我不会用）</li></ul><h4 id="防火墙" tabindex="-1"><a class="header-anchor" href="#防火墙"><span>防火墙</span></a></h4>',7)),l(k,{id:"916",data:[{id:"firewalld"},{id:"nftables"}]},{title0:e(({value:a,isActive:r})=>i[166]||(i[166]=[t("firewalld")])),title1:e(({value:a,isActive:r})=>i[167]||(i[167]=[t("nftables")])),tab0:e(({value:a,isActive:r})=>i[168]||(i[168]=[s("div",{class:"language-sh line-numbers-mode","data-highlighter":"shiki","data-ext":"sh",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[s("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"systemctl"),s("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," <"),s("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"start"),s("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," | "),s("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"enable"),s("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," | "),s("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"stop"),s("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," | "),s("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"disable"),s("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"> "),s("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"firewalld")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"firewall-cmd"),s("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --state")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"firewall-cmd"),s("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --reload"),s("span",{style:{"--shiki-light":"#A0A1A7","--shiki-light-font-style":"italic","--shiki-dark":"#7F848E","--shiki-dark-font-style":"italic"}},"   # after change")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"firewall-cmd"),s("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --add-masquerade"),s("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --permanent"),s("span",{style:{"--shiki-light":"#A0A1A7","--shiki-light-font-style":"italic","--shiki-dark":"#7F848E","--shiki-dark-font-style":"italic"}},"   # 伪装")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"firewall-cmd"),s("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --add-port="),s("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"<"),s("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"port"),s("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},">"),s("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"/tcp"),s("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --permanent"),s("span",{style:{"--shiki-light":"#A0A1A7","--shiki-light-font-style":"italic","--shiki-dark":"#7F848E","--shiki-dark-font-style":"italic"}},"  # 永久放行")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"firewall-cmd"),s("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --zone=public"),s("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --list-all")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"firewall-cmd"),s("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --zone=public"),s("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --list-ports")])])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1)])),tab1:e(({value:a,isActive:r})=>i[169]||(i[169]=[s("p",null,[s("a",{href:"https://wiki.archlinuxcn.org/wiki/Nftables",target:"_blank",rel:"noopener noreferrer"},"查看 wiki")],-1)])),_:1}),i[193]||(i[193]=d('<h2 id="代理" tabindex="-1"><a class="header-anchor" href="#代理"><span>代理</span></a></h2><p><strong>不要把证书放在 <code>/root</code> ！！！</strong> 我又不能改 <code>/root</code>权限，代理服务端又会出一大堆权限问题，日志还不好看。</p><h3 id="协议" tabindex="-1"><a class="header-anchor" href="#协议"><span>协议</span></a></h3><p>网上小白教程比较多的是 vmess/vless + ws + tls 的方案，这些协议比较老，基本被打烂了。我选择 trojan，也是一个比较常见的方案，相对来说安全性更高。trojan 使用 TLS 加密方案，安全性高，但是数据包比较大，现在也存在着 trojan 检测技术。</p><p>我最开始直接用 <a href="https://github.com/Jrohy/trojan" target="_blank" rel="noopener noreferrer">trojan 一键脚本</a><sup class="footnote-ref"><a href="#footnote2">[2]</a><a class="footnote-anchor" id="footnote-ref2"></a></sup>。如<a href="#%E5%AF%B9%E6%8A%97-gfw">GFW 会主动对端口进行封禁</a>，我的端口基本只能存活一天。（后来做了端口转发就基本没死了，偶尔会被 Qos(?)）</p>',5)),s("p",null,[i[172]||(i[172]=t("随着后来自己也使用 linux，我对于一键脚本不够满意，因此开始")),l(p,{to:"/articles/proxy/trojan-go.html"},{default:e(()=>i[170]||(i[170]=[t("自己写 trojan/trojan-go 配置文件")])),_:1}),i[173]||(i[173]=t("。也尝试了一下 hysteria 协议，并且写了个")),l(p,{to:"/articles/proxy/hysteria.html"},{default:e(()=>i[171]||(i[171]=[t("教程")])),_:1}),i[174]||(i[174]=t("。"))]),i[194]||(i[194]=d('<p>评价起来就是，hysteria 延迟最低，trojan-go 小幅度落后，差得不多。trojan 延迟比较大，但是胜在兼容性强。而 hysteria 风险较大，没必要为了几十 ms 延迟去冒险，因此还是 trojan-go 适合我。</p><h3 id="脚本" tabindex="-1"><a class="header-anchor" href="#脚本"><span>脚本</span></a></h3><ul><li><a href="https://github.com/lxl66566/init-script" target="_blank" rel="noopener noreferrer">我的一键脚本</a>：linux 常用工具，trojan-go, trojan, hysteria</li><li><a href="https://github.com/233boy/v2ray" target="_blank" rel="noopener noreferrer">V2ray 脚本</a>：融合怪，啥都有</li><li><a href="https://github.com/Jrohy/trojan" target="_blank" rel="noopener noreferrer">trojan 脚本</a>：仅 trojan</li></ul><h3 id="warp" tabindex="-1"><a class="header-anchor" href="#warp"><span>WARP</span></a></h3><p>有的 IP 访问 Google 时会有机器人异常验证。可以用 <a href="https://github.com/P3TERX/warp.sh" target="_blank" rel="noopener noreferrer">WARP 一键脚本</a>解决。</p><h3 id="对抗-gfw" tabindex="-1"><a class="header-anchor" href="#对抗-gfw"><span>对抗 GFW</span></a></h3><p>GFW 检测到异常就会封禁端口，若换端口继续使用则需要考虑 ip 被永久封禁的风险。trojan 本身是 TLS over TLS 加密方式，但仍然有办法识别出流量特征。</p><p>我使用如下方式降低封锁几率（<strong>有没有用其实是不太清楚的</strong>）：</p>',8)),s("ul",null,[s("li",null,[i[176]||(i[176]=t("反代一个伪装主页，详见")),l(p,{to:"/articles/reverse_proxy.html"},{default:e(()=>i[175]||(i[175]=[t("反向代理")])),_:1}),i[177]||(i[177]=t("。（然而 443 早就被封了，令人感慨）"))]),i[178]||(i[178]=s("li",null,[t("设置一个固定端口与一个活动端口，固定端口将流量"),s("a",{href:"#%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91"},"转发"),t("到活动端口。")],-1))]),i[195]||(i[195]=d(`<h3 id="清理僵尸进程" tabindex="-1"><a class="header-anchor" href="#清理僵尸进程"><span>清理僵尸进程</span></a></h3><p>如果你看到许多 <code>[journalctl] &lt;defunct&gt;</code> 标识，这代表有未结束的僵尸子进程。可以<a href="https://www.linkedin.com/pulse/how-identify-kill-zombiedefunct-processes-linux-without-george-gabra" target="_blank" rel="noopener noreferrer">参考此处</a>清理他们。</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">top</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -b1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Z</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # find</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -A</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -ostat,ppid</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;[zZ]&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">awk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;{ print $2 }&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">uniq</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">xargs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # Find the parent of zombie processes, remenber ppid</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">kill</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> SIGCHLD</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ppi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">d&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">top</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -b1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Z</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # Identify if the zombie processes have been killed</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># if haven&#39;t been killed, just kill &lt;ppid&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="运维" tabindex="-1"><a class="header-anchor" href="#运维"><span>运维</span></a></h2><p>虽然我非常菜，但还是姑且记录一些心得。由于有的服务器是公家的，想干点啥总是感觉束手束脚。。</p>`,5)),s("ol",null,[s("li",null,[i[180]||(i[180]=t("如果是自己的服务器，那肯定先把")),l(p,{to:"/farraginous/recommend_packages.html#linux"},{default:e(()=>i[179]||(i[179]=[t("常用工具")])),_:1}),i[181]||(i[181]=t("下载好。 ")),i[182]||(i[182]=s("ul",null,[s("li",null,"公家服务器如果有权限安装软件，也可以装一些典型的/极大增加效率的。例如 fish, zoxide")],-1))]),i[183]||(i[183]=s("li",null,[t("ssh 保活用的 screen 而不是 tmux。"),s("a",{href:"https://linuxize.com/post/how-to-use-linux-screen/",target:"_blank",rel:"noopener noreferrer"},"一些基础命令"),t("，加一个"),s("a",{href:"https://stackoverflow.com/a/1509764/18929691",target:"_blank",rel:"noopener noreferrer"},"删除命令"),t("，加一个 "),s("code",null,"<C-a> ["),t(" 进 copy mode 然后可以往上滚的命令。 "),s("ul",null,[s("li",null,"当然不缺配置的话就用 zellij 了。")])],-1))]),i[196]||(i[196]=s("h2",{id:"挂机",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#挂机"},[s("span",null,"挂机")])],-1)),i[197]||(i[197]=s("p",null,[t("VPS 的流量可以共享，并且可以赚点小钱("),s("a",{href:"https://post.vpslog.org/archives/gua-ji",target:"_blank",rel:"noopener noreferrer"},"src"),t(")。为了防止 IP 被污染，一般放在非主要的 VPS 上跑。")],-1)),i[198]||(i[198]=s("p",null,"跑挂机的 VPS 就变成美国最抢手了，毕竟 openai 流媒体啥的都能解。（我的 jp 机就没法解 openai）",-1)),s("p",null,[i[185]||(i[185]=t("一般挂机都拿 docker 跑，我当然！用 ")),l(p,{to:"/coding/container.html"},{default:e(()=>i[184]||(i[184]=[t("podman")])),_:1}),i[186]||(i[186]=t(" 啦。"))]),i[199]||(i[199]=d(`<ul><li><a href="https://packetstream.io/?psr=5wA2" target="_blank" rel="noopener noreferrer">PacketStream</a>：0.1$/G，满 5$ 可提现。 <ul><li>流量跑得慢，80M / 36h，不过至少可用</li></ul></li><li><s><a href="https://earn.fm/ref/LXZX43NC" target="_blank" rel="noopener noreferrer">EarnFM</a></s>，不可用：<code>Connection is halted because: This IP is a known proxy connection, therefore its not allowed.</code></li><li><a href="https://link.repocket.co/cwYQ" target="_blank" rel="noopener noreferrer">repoket</a>: 满 20$ 可提。不可用：<code>Too many devices on the same IPs.</code></li><li><s><a href="https://traffmonetizer.com/?aff=1578168" target="_blank" rel="noopener noreferrer">traffmonetizer</a></s>,不可用。</li></ul><p>先挂着，到时候再看看收益。</p><h2 id="遇到的问题" tabindex="-1"><a class="header-anchor" href="#遇到的问题"><span>遇到的问题</span></a></h2><h3 id="无法使用密钥登录" tabindex="-1"><a class="header-anchor" href="#无法使用密钥登录"><span>无法使用密钥登录</span></a></h3><p>某天服务器突然无法使用密钥验证登录了。查一下日志，发现一句：<code>Authentication refused: bad ownership or modes for directory /root</code>。</p><p>我确实改过 <code>/root</code> 的权限，因此改回 750 即可。</p><h3 id="卡在-reloading-system-manager-configuration" tabindex="-1"><a class="header-anchor" href="#卡在-reloading-system-manager-configuration"><span>卡在 Reloading system manager configuration</span></a></h3><p>archlinux 的服务器，每次安装软件都卡在 Reloading system manager configuration，卡大约 1min。</p><p>尝试了一下 <code>systemctl daemon-reload</code> 也卡住了。</p><p>然后根据<a href="https://bbs.archlinux.org/viewtopic.php?id=281599" target="_blank" rel="noopener noreferrer">这个回答</a>，罪魁祸首是 <code>netplan</code>（<em>netplan</em> 是 <em>cloud-init</em> 的可选依赖。而 <em>cloud-init</em> 是 VPS 自带的玩意）于是卸载，问题解决——</p><p>才怪。服务器重启就连不上 ssh 了。。。</p><p>这就不得不说，我这次买的 vps，silicloud 家的并没有 rescue 服务。还好我乱搞炸的是网络而不是系统，用 VNC 面板进去修就行了。</p><p>所以这个问题是无解的，或许得等我哪天琢磨出换个 vps 联网手段才行吧。</p><p>ps. 群里也有相同问题的。</p><h3 id="端口被封问题" tabindex="-1"><a class="header-anchor" href="#端口被封问题"><span>端口被封问题</span></a></h3><p>20230520：端口每天被封一次，于是写了个 fish 脚本每天更换端口<s>并显示在伪装页面上</s>映射到 12138（还作出了<a href="#%E5%AF%B9%E6%8A%97-gfw">其他努力</a>）。脚本还是有 bug 的（我菜），<code>$temp</code> 赋值不成功，但无伤大雅。</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># fish function</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> new_trojan_port</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> --description </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;change to a new trojan port&#39;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --remove-forward-port=port=12138:proto=tcp:toport=</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$trojan_port</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --permanent</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --remove-forward-port=port=12138:proto=udp:toport=</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$trojan_port</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --permanent</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    set</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -U</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> trojan_port</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (math </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$trojan_port</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> +</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --add-forward-port=port=12138:proto=udp:toport=</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$trojan_port</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --permanent</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --add-forward-port=port=12138:proto=tcp:toport=</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$trojan_port</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --permanent</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> temp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (echo </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$trojan_port</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">trojan</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> port</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tee</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/tty</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sed</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;s/.*端口: \\([0-9]*\\).*/\\1/p&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;port: </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$temp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -&gt; </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$trojan_port</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --reload</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # update blog and show port</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/nginx/lxl66566.github.io</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pull</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> origin</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> main</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # sed -i &quot;s/MyGitHub/$trojan_port/g&quot; index.html</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    nginx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reload</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>不应同时使用 firewalld 和 iptables，可能会导致混乱。由于 <code>firewalld</code> 是更高一层的抽象(?)，因此我使用之：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> iptables</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> disable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> iptables</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mask</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> iptables</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> unmask</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> firewalld</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> firewalld</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> firewalld</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>后来采用<a href="#%E5%AF%B9%E6%8A%97-gfw">端口转发和伪装</a>后就没被封过端口了 www</p><h3 id="配置了错误的-firewalld-把自己防住了" tabindex="-1"><a class="header-anchor" href="#配置了错误的-firewalld-把自己防住了"><span>配置了错误的 firewalld 把自己防住了</span></a></h3><p>20230516：如题，乱搞 firewalld，结果忘记放行 22 端口（ssh）直接 reload，直接把我 ssh 干掉了。。。然后进 rescue mode 抢救了...</p><blockquote><p>rescue mode 是 VPS 服务商的一项服务，可以将 VPS 挂载到另一个虚拟机上，通过其对文件进行备份与修改，适用于乱搞把 VPS 搞炸了的情况。</p></blockquote><p>rescue 只有 nano file editor；挂载了分区到 <code>test</code> 以后，直接 <code>nano /test/etc/firewalld/zones/public.xml</code> 加上 <code>&lt;port port=&quot;22&quot; protocol=&quot;tcp&quot;/&gt;</code>。</p><h3 id="x-ui-does-not-work" tabindex="-1"><a class="header-anchor" href="#x-ui-does-not-work"><span>X-UI does not work</span></a></h3><p>我小白一个，只会跟着用简单的一键部署脚本，然后寄了。面板添加节点后，使用 v2rayN 添加服务器无法连上。</p><p>后面换了 <a href="https://github.com/Jrohy/trojan" target="_blank" rel="noopener noreferrer">trojan 面板</a>，能正常用一阵子，但稳定性一般。</p><p>顺带，x-ui 在 alpine 的表现可谓是《惊艳》到我了，，，</p><blockquote><p>~# x-ui install<br> &gt; [ERR] 面板启动失败，可能是因为启动时间超过了两秒，请稍后查看日志信息<br> ~# x-ui log<br> &gt; [ERR] 请先安装面板</p></blockquote><h2 id="external" tabindex="-1"><a class="header-anchor" href="#external"><span>external</span></a></h2><ol><li><a href="https://bulianglin.com/archives/guide.html" target="_blank" rel="noopener noreferrer">节点搭建系列教程 - 不良林</a>，在一众垃圾 youtube 教程中算是讲得比较透彻的。</li><li><a href="https://gitlab.com/drizzt/vps2arch" target="_blank" rel="noopener noreferrer">vps2arch</a>：为你的 vps 安装 arch！</li><li><a href="https://blog.misaka.rest/2023/09/02/hysteria2-script/" target="_blank" rel="noopener noreferrer">使用一键脚本，部署 Hysteria 2 协议节点</a></li></ol><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="footnote1" class="footnote-item"><p>本想买 CloudServer 的（明显同价位的配置更好），然而账号被标记了危险无法付款...因此只能退而求其次买了 RackNerd 家的。 <a href="#footnote-ref1" class="footnote-backref">↩︎</a></p></li><li id="footnote2" class="footnote-item"><p>本来是想用 X-UI 的，然而<a href="#x-ui-does-not-work">出了问题</a> <a href="#footnote-ref2" class="footnote-backref">↩︎</a></p></li></ol></section>`,33))])}const J=g(b,[["render",z],["__file","vps.html.vue"]]),L=JSON.parse('{"path":"/articles/proxy/vps.html","title":"VPS","lang":"zh-CN","frontmatter":{"date":"2023-05-14T00:00:00.000Z","icon":"computer","category":["教程","经历"],"tag":["桌面端","Linux"],"description":"VPS 我与我的 VPS 的故事。服务器运维/代理搭建。 与 VPS 无关的 linux 问题请移步 linux 个人偏好 带宽偏好：我个人入户只有 100Mbps，所以不低于 100Mbps 我都能接受。国内云厂商那堆小水管还是算了吧。 地点偏好：我有明确的地点偏好：JP。 我对延迟有一定要求，所以 US 全部 out。不过由于 US 机便宜，有时也...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"VPS\\",\\"image\\":[\\"https://absx.pages.dev/images/articles/vps/news.jpg\\"],\\"datePublished\\":\\"2023-05-14T00:00:00.000Z\\",\\"dateModified\\":\\"2025-09-07T15:15:10.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://absx.pages.dev/articles/proxy/vps.html"}],["meta",{"property":"og:site_name","content":"绝对值_x 的博客"}],["meta",{"property":"og:title","content":"VPS"}],["meta",{"property":"og:description","content":"VPS 我与我的 VPS 的故事。服务器运维/代理搭建。 与 VPS 无关的 linux 问题请移步 linux 个人偏好 带宽偏好：我个人入户只有 100Mbps，所以不低于 100Mbps 我都能接受。国内云厂商那堆小水管还是算了吧。 地点偏好：我有明确的地点偏好：JP。 我对延迟有一定要求，所以 US 全部 out。不过由于 US 机便宜，有时也..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://absx.pages.dev/images/articles/vps/news.jpg"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-09-07T15:15:10.000Z"}],["meta",{"property":"article:tag","content":"Linux"}],["meta",{"property":"article:tag","content":"桌面端"}],["meta",{"property":"article:published_time","content":"2023-05-14T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-09-07T15:15:10.000Z"}]]},"git":{"createdTime":1684081250000,"updatedTime":1757258110000,"contributors":[{"name":"lxl66566","username":"lxl66566","email":"18259734087@163.com","commits":89,"url":"https://github.com/lxl66566"}]},"readingTime":{"minutes":14.51,"words":4354},"filePathRelative":"articles/proxy/vps.md","localizedDate":"2023年5月14日","excerpt":"\\n","autoDesc":true}');export{J as comp,L as data};
