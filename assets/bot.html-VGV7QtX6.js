import{_ as d,e as m,g as t,i as s,f as p,h as i,j as l,r as a,o as g}from"./app-BszC_RE5.js";const b={},u={class:"hint-container details"};function y(f,e){const n=a("RouteLink"),h=a("ZoomedImg"),k=a("CodeTabs");return g(),m("div",null,[e[26]||(e[26]=t("h1",null,"bot",-1)),e[27]||(e[27]=t("p",null,[i("我曾使用 "),t("a",{href:"https://nonebot.dev/",target:"_blank",rel:"noopener noreferrer"},"nonebot2"),i(" + cqhttp 的方式搭建 bot。这种方案使用 python 语言，并且需要自己写比较底层的代码。在此感谢 "),t("a",{href:"https://github.com/yaowan233",target:"_blank",rel:"noopener noreferrer"},"yaowan233"),i(" 学长的指导。")],-1)),t("p",null,[e[1]||(e[1]=i("而现在我选择 ")),e[2]||(e[2]=t("a",{href:"https://koishi.chat/zh-CN/",target:"_blank",rel:"noopener noreferrer"},"koishi",-1)),e[3]||(e[3]=i(" 框架。该框架基于 ")),s(n,{to:"/coding/nodejs.html"},{default:l(()=>e[0]||(e[0]=[i("node.js")])),_:1}),e[4]||(e[4]=i("，具有图形化的操作界面和高度预设，可以接入多个平台，也有成熟的 npm 包管理。文档虽说不算优秀，但至少比曾经的 nonebot2 强数倍。同时也有")),e[5]||(e[5]=t("a",{href:"https://forum.koishi.xyz/",target:"_blank",rel:"noopener noreferrer"},"论坛",-1)),e[6]||(e[6]=i("以供交流。但是代价就是 node.js 的高运行时内存占用了。（常态 600M）"))]),e[28]||(e[28]=t("p",null,"comp: 这两个平台都通过 Adapter 适配不同的平台，比较泛用；都有数据库的抽象层，比较易用；2023 开源之夏 nonebot2 也新增了图形界面。我感觉还是看写 python 还是写 ts 舒服来选平台比较合适。",-1)),e[29]||(e[29]=t("p",null,[t("s",null,[i("我建的 bot 有两个实例：一个是之前一直在用的 QQ bot "),t("code",null,"atri"),i("（2433269451），另一个是后来使用 koishi 的 Telegram bot "),t("a",{href:"https://t.me/atri_absx_bot",target:"_blank",rel:"noopener noreferrer"},[t("code",null,"atri bot")]),i("。")]),i(" 这两个 bot 现在都不再运行了；不过"),t("a",{href:"#telegram-bot-on-cloudflare-workers"},"后文"),i("的 serverless bot 还可以使用。")],-1)),t("details",u,[e[16]||(e[16]=t("summary",null,"查看 atri(QQ) 的信息",-1)),s(h,{alt:"atri",src:"/images/farraginous/atri/atri.jpg",scale:"40%"}),e[17]||(e[17]=t("p",null,"她的功能：",-1)),e[18]||(e[18]=t("ul",null,[t("li",null,"背单词（英日双语）"),t("li",null,"随机数"),t("li",null,"带饭记账"),t("li",null,"偷窥我")],-1)),e[19]||(e[19]=t("p",null,[i("请加为好友（联系绝对值_x 同意好友）后发送"),t("code",null,"help"),i("获取详细指令。你也可以在"),t("a",{href:"https://github.com/lxl66566/primary-atri-bot-plugins",target:"_blank",rel:"noopener noreferrer"},"这里"),i("得到她的实现上述功能的 python 源码。关于环境：")],-1)),t("ol",null,[t("li",null,[s(n,{to:"/coding/python.html#%E5%88%9B%E5%BB%BA%E7%8E%AF%E5%A2%83"},{default:l(()=>e[7]||(e[7]=[i("使用 conda")])),_:1}),e[8]||(e[8]=i("创建出所需环境（此处环境名为")),e[9]||(e[9]=t("code",null,"atri",-1)),e[10]||(e[10]=i("）：")),e[11]||(e[11]=t("code",null,"conda create -n atri python=3.9",-1)),e[12]||(e[12]=t("blockquote",null,[t("p",null,"nonebot2 需要在 python>=3.8 环境下运行")],-1))]),e[15]||(e[15]=p(`<li>使用 pip 安装依赖：<div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nb-cli</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nonebot-adapter-onebot</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li>`,1)),t("li",null,[e[14]||(e[14]=i("参考")),s(n,{to:"/essay/2022.html#_20220506"},{default:l(()=>e[13]||(e[13]=[i("随笔中的启动脚本")])),_:1})])])]),e[30]||(e[30]=t("h2",null,"koishi",-1)),e[31]||(e[31]=t("h3",null,"install",-1)),e[32]||(e[32]=t("p",null,[i("这里推荐"),t("a",{href:"https://koishi.chat/zh-CN/manual/starter/boilerplate.html",target:"_blank",rel:"noopener noreferrer"},"使用 pnpm/npm 安装"),i("，而不是官方推荐的下载安装包。使用 pnpm/npm 安装对 bot 功能没有影响，而且方便开发。")],-1)),s(k,{id:"79",data:[{id:"pnpm"},{id:"npm"}]},{title0:l(({value:r,isActive:o})=>e[20]||(e[20]=[i("pnpm")])),title1:l(({value:r,isActive:o})=>e[21]||(e[21]=[i("npm")])),tab0:l(({value:r,isActive:o})=>e[22]||(e[22]=[t("div",{class:"language-sh line-numbers-mode","data-highlighter":"shiki","data-ext":"sh",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[t("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[t("code",null,[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"pnpm"),t("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," i"),t("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," -g"),t("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," create-koishi@latest")]),i(`
`),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"pnpm"),t("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," create"),t("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," koishi"),t("span",{style:{"--shiki-light":"#A0A1A7","--shiki-light-font-style":"italic","--shiki-dark":"#7F848E","--shiki-dark-font-style":"italic"}},"  # 选择是否 install and start 的时候选择 否")]),i(`
`),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"pnpm"),t("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," i"),t("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --shamefully-hoist"),t("span",{style:{"--shiki-light":"#A0A1A7","--shiki-light-font-style":"italic","--shiki-dark":"#7F848E","--shiki-dark-font-style":"italic"}},"   # 需要添加此后缀")]),i(`
`),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"pnpm"),t("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," dev")])])]),t("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[t("div",{class:"line-number"}),t("div",{class:"line-number"}),t("div",{class:"line-number"}),t("div",{class:"line-number"})])],-1)])),tab1:l(({value:r,isActive:o})=>e[23]||(e[23]=[t("div",{class:"language-sh line-numbers-mode","data-highlighter":"shiki","data-ext":"sh",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[t("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[t("code",null,[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"npm"),t("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," i"),t("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," -g"),t("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," create-koishi@latest")]),i(`
`),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"npm"),t("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," init"),t("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," koishi")])])]),t("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[t("div",{class:"line-number"}),t("div",{class:"line-number"})])],-1)])),_:1}),t("blockquote",null,[t("p",null,[t("em",null,[e[25]||(e[25]=i("关于 pnpm 安装后缀，详见 ")),s(n,{to:"/coding/nodejs.html#%E7%A5%9E%E7%A7%98%E6%8A%A5%E9%94%99"},{default:l(()=>e[24]||(e[24]=[i("nodejs")])),_:1})])])]),e[33]||(e[33]=p('<h3>使用</h3><ul><li><p>telegram：本机没有公网 ip，因此选择 <em>polling</em> 工作模式。代理用 http 好像不能用（这也是我第一次退坑 koishi 的理由），之后尝试用 socks 端口就可以了。</p></li><li><p>QQ：<s>参考<a href="https://forum.koishi.xyz/t/topic/2502" target="_blank" rel="noopener noreferrer">论坛</a>。回复挺破碎的，需要多翻一翻。我能够成功使用，不过会报 warning:</s></p><blockquote><p>由用户 &#39;*&#39; 发送的 session &#39;*&#39; 缺失 username。插件处理可能出现问题。若要针对此问题进行反馈，请前往 <a href="https://k.ilharp.cc/2510" target="_blank" rel="noopener noreferrer">https://k.ilharp.cc/2510</a> 。错误码：2130</p></blockquote><p><s>不影响使用，开发者也<a href="https://forum.koishi.xyz/t/topic/2510/154" target="_blank" rel="noopener noreferrer">说不用在意</a>，那就不管了。</s> chronocat 开发的 QQNT 适配器现已被下架。</p></li></ul><h3>开发</h3><p>我写了一个小玩具（<a href="https://github.com/lxl66566/koishi-plugin-peek" target="_blank" rel="noopener noreferrer">koishi-plugin-peek</a>），大致涵盖了基本的开发指令。推荐在 github 上搜索其他源码广泛学习。</p><ul><li>关于发布插件：<strong><code>pub</code> 之前请一定记得 <code>build</code>！！切记！！</strong></li></ul><h2>Telegram Bot on Cloudflare Workers</h2><p>之后我的重心转到了 Telegram 上，而 Telegram 对 bot 的大力支持程度是国内平台根本比不了的。</p><p>2024 年底 Asuka Minato 写了一个 serverless 的 <a href="https://github.com/asukaminato0721/telegram-summary-bot" target="_blank" rel="noopener noreferrer">telegram-summary-bot</a>，这个 bot 使用 Cloudflare Workers 运行，Cloudflare d1 数据库做持久化存储。我看到了 Telegram bot 的新曙光，这样我就不需要使用专门的服务器来跑 bot 了，因为我的 VPS 稳定性和数据安全性都挺差的。</p><p>于是抄他的源码，结合我第一次使用 Cursor，糊了一个 <a href="https://github.com/lxl66566/Telegram-RSS-Bot-on-Cloudflare-Workers" target="_blank" rel="noopener noreferrer">Telegram-RSS-Bot-on-Cloudflare-Workers</a>，满足了我一直以来的愿望，也就是在聊天软件里接收 RSS 通知。（此前我一直使用 <a href="https://github.com/iovxw/rssbot" target="_blank" rel="noopener noreferrer">iovxw/rssbot</a>，但它并不好用。我也经历了几次数据丢失，非常难受）</p><p>后来就一发不可收拾，又写了：</p><ul><li><a href="https://github.com/lxl66566/telegram-subscribe-bot" target="_blank" rel="noopener noreferrer">telegram-subscribe-bot</a>：订阅群组消息的 bot。实际上<a href="https://t.me/withabsolutex/2217" target="_blank" rel="noopener noreferrer">并不好用</a>。</li><li><a href="https://github.com/lxl66566/telegram-shasei-bot" target="_blank" rel="noopener noreferrer">telegram-shasei-bot</a>：射精记录 bot。从此我再也不需要将数据手动记录到博客里了（）。</li></ul>',11))])}const F=d(b,[["render",y],["__file","bot.html.vue"]]),v=JSON.parse('{"path":"/coding/bot.html","title":"bot","lang":"zh-CN","frontmatter":{"icon":"brands fa-bots","date":"2023-07-24T00:00:00.000Z","category":["编程","教程"],"tag":["成果"],"description":"bot 我曾使用 nonebot2 + cqhttp 的方式搭建 bot。这种方案使用 python 语言，并且需要自己写比较底层的代码。在此感谢 yaowan233 学长的指导。 而现在我选择 koishi 框架。该框架基于 ，具有图形化的操作界面和高度预设，可以接入多个平台，也有成熟的 npm 包管理。文档虽说不算优秀，但至少比曾经的 nonebo...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"bot\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-07-24T00:00:00.000Z\\",\\"dateModified\\":\\"2025-02-22T17:26:35.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://absx.pages.dev/coding/bot.html"}],["meta",{"property":"og:site_name","content":"绝对值_x 的博客"}],["meta",{"property":"og:title","content":"bot"}],["meta",{"property":"og:description","content":"bot 我曾使用 nonebot2 + cqhttp 的方式搭建 bot。这种方案使用 python 语言，并且需要自己写比较底层的代码。在此感谢 yaowan233 学长的指导。 而现在我选择 koishi 框架。该框架基于 ，具有图形化的操作界面和高度预设，可以接入多个平台，也有成熟的 npm 包管理。文档虽说不算优秀，但至少比曾经的 nonebo..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-02-22T17:26:35.000Z"}],["meta",{"property":"article:tag","content":"成果"}],["meta",{"property":"article:published_time","content":"2023-07-24T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-02-22T17:26:35.000Z"}]]},"git":{"createdTime":1690216707000,"updatedTime":1740245195000,"contributors":[{"name":"lxl66566","username":"lxl66566","email":"18259734087@163.com","commits":11,"url":"https://github.com/lxl66566"}]},"readingTime":{"minutes":3.6,"words":1081},"filePathRelative":"coding/bot.md","localizedDate":"2023年7月24日","excerpt":"\\n","autoDesc":true}');export{F as comp,v as data};
