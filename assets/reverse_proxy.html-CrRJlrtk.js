import{_ as s,e as t,f as r,g as i,h as a,i as o,j as d,r as l,o as p}from"./app-C53ngbAW.js";const c={};function h(g,e){const n=l("RouteLink");return p(),t("div",null,[e[3]||(e[3]=r(`<h1 id="åå‘ä»£ç†" tabindex="-1"><a class="header-anchor" href="#åå‘ä»£ç†"><span>åå‘ä»£ç†</span></a></h1><p>ä¸€ä¸ªç³»ç»Ÿå¯èƒ½æœ‰ä¸€å †æœåŠ¡å™¨ï¼Œä¸€å°æœåŠ¡å™¨ä¸Šå¯èƒ½è¿è¡Œç€ä¸€å †æœåŠ¡ã€‚åä»£æ˜¯ä¸€ç§ä¸­é—´ä»¶ï¼Œå°†ä¸åŒè¯·æ±‚è½¬å‘åˆ°ä¸åŒæœåŠ¡ä¸Šï¼Œå…¼é¡¾äº†åŠ å¯†ï¼Œè´Ÿè½½å‡è¡¡ç­‰ã€‚<a href="https://www.cloudflare.com/zh-cn/learning/cdn/glossary/reverse-proxy/" target="_blank" rel="noopener noreferrer">more</a></p><p>Nginx æ˜¯è€ç‰Œåä»£å¤§å“¥ï¼Œå…·æœ‰æˆç†Ÿçš„ç¤¾åŒºå’Œå¼ºå¤§çš„æ€§èƒ½ã€‚è€Œ caddy ç­‰æ–°èµ·ä¹‹ç§€ä¸»è¦èšç„¦äºæ˜“ç”¨æ€§ï¼Œä¾‹å¦‚é…ç½®é¡¹æ›´ç®€æ´ã€è‡ªåŠ¨ç­¾è¯ä¹¦å’Œ https é‡å®šå‘ç­‰ã€‚</p><h2 id="caddy" tabindex="-1"><a class="header-anchor" href="#caddy"><span>caddy</span></a></h2><p>caddy æ˜¯ä¸€ä¸ªæ›´å¹´è½»çš„å·¥å…·ï¼Œæä¾›<strong>éå¸¸ç®€å•</strong>çš„è¯­æ³•å’Œ<strong>è‡ªåŠ¨ https</strong>ï¼ˆè‡ªåŠ¨ç­¾è¯ä¹¦ï¼‰ã€‚</p><ul><li><a href="https://caddyserver.com/docs/install" target="_blank" rel="noopener noreferrer">å®‰è£…æŒ‡å—</a></li></ul><p>èƒ½æœ‰å¤šç®€å•å‘¢ï¼Œä¾‹å¦‚æˆ‘éœ€è¦éƒ¨ç½²ä¸€ä¸ªé™æ€ç«™ç‚¹ï¼ˆç”¨äº vps ä¼ªè£…ï¼‰ï¼Œåªéœ€è¦åœ¨ <code>/etc/caddy/Caddyfile</code> ä¸­å†™å…¥ï¼š</p><div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>&lt;åŸŸå&gt; {</span></span>
<span class="line"><span>  root * &lt;(é™æ€)èµ„æºè·¯å¾„&gt;</span></span>
<span class="line"><span>  file_server</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,8)),i("p",null,[e[1]||(e[1]=a("ç„¶å")),o(n,{to:"/articles/linux/basic.html#%E6%9C%8D%E5%8A%A1"},{default:d(()=>e[0]||(e[0]=[a("å¯åŠ¨ caddy æœåŠ¡")])),_:1}),e[2]||(e[2]=a("å³å¯ã€‚"))]),e[4]||(e[4]=r(`<p>è¿™ä¸ªé…ç½®æ–‡ä»¶å¯ä»¥å°† http è‡ªåŠ¨é‡å®šå‘åˆ° httpsï¼Œå¹¶ä¸”ä¸ç”¨è‡ªå·±ç­¾è¯ä¹¦ã€‚</p><p>å¦‚æœè¦ç”¨è‡ªå·±çš„è¯ä¹¦å°±åŠ ä¸€å¥ <code>tls &lt;crt&gt; &lt;key&gt;</code> å³å¯ã€‚</p><blockquote><p>è€Œæˆ‘åœ¨ nginx ä¸Šå¾—è‡ªå·±ç”¨ acme.sh ç­¾è¯ä¹¦ï¼Œç„¶åå†™<a href="https://github.com/lxl66566/config/blob/a3065d4b9797d43eb113e2932e9799f9b420c4f4/nginx.conf" target="_blank" rel="noopener noreferrer">ä¸€å¤§å¨çš„é…ç½®æ–‡ä»¶</a>ï¼Œè¿˜å¾—å»çœ‹çœ‹ nginx å‘½ä»¤è¡Œç”¨æ³•ï¼Œsignal æœ‰å“ªäº›ï¼Œæ‰èƒ½æŠŠæˆ‘çš„ç½‘ç«™æå¥½ã€‚</p></blockquote><p>åä»£ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€å°† <code>file_server</code> æ¢æˆ <code>reverse_proxy :8000</code>ï¼ˆç«¯å£å·ï¼‰ã€‚</p><ul><li>å¦‚æœåªæœ‰ä¸€ä¸ªåŸŸåï¼Œå¯ä»¥å»æ‰å¤§æ‹¬å·ã€‚ï¼ˆå‹è¡Œï¼ç°åœ¨åªæœ‰ä¸‰è¡Œäº†ï¼‰</li><li>è‡ªå¸¦ formatterï¼š<code>caddy fmt --overwrite /etc/caddy/Caddyfile</code></li><li>è‡ªåŠ¨è¯ä¹¦å­˜æ”¾ä½ç½®æ˜¯ <code>/var/lib/caddy/certificates/acme-v02.api.letsencrypt.org-directory/&lt;domain&gt;</code>ï¼Œå¯ä»¥ ln åˆ°å…¶ä»–åœ°æ–¹ç»™å…¶ä»–è½¯ä»¶ç”¨ã€‚</li></ul><p>caddy æœ€å¤§çš„é—®é¢˜æ˜¯æ€§èƒ½è¾ƒå·®ï¼Œå› æ­¤ä¸é€‚åˆåœ¨é«˜å¹¶å‘ç¯å¢ƒä¸‹ä½¿ç”¨ã€‚è¿™é‡Œæ€§èƒ½å·®çš„ä¸€ä¸ªè¾ƒå¤§æ¥æºæ˜¯ go è¿è¡Œæ—¶çš„è´Ÿæ‹…ã€‚</p><h3 id="æ—¥å¿—" tabindex="-1"><a class="header-anchor" href="#æ—¥å¿—"><span>æ—¥å¿—</span></a></h3><p>caddy é»˜è®¤å°†æ—¥å¿—è¾“å‡º stderrï¼Œå¯ä»¥ç”¨ <code>journalctl</code> æŸ¥çœ‹ã€‚ä½†ä¹Ÿå¯ä»¥å°†å…¶è¾“å‡ºè‡³æ–‡ä»¶ï¼Œæˆ–è€…æŒ‰åŸŸååˆ†æµæ—¥å¿—ç­‰ã€‚</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">  log</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;"> default</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;"> {</span></span>
<span class="line"><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">    output</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;"> file</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;"> &lt;file_path&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ›´å…·ä½“çš„åº”ç”¨è¯·å‚è€ƒæ–‡æ¡£ï¼š<a href="https://caddyserver.com/docs/caddyfile/directives/log" target="_blank" rel="noopener noreferrer">log å‚æ•°</a> | <a href="https://caddyserver.com/docs/caddyfile/options#log" target="_blank" rel="noopener noreferrer">å…¨å±€ log default</a>ã€‚</p><h3 id="å…¶ä»–èµ„æ–™" tabindex="-1"><a class="header-anchor" href="#å…¶ä»–èµ„æ–™"><span>å…¶ä»–èµ„æ–™</span></a></h3><ul><li><a href="https://github.com/caddyserver/nginx-adapter" target="_blank" rel="noopener noreferrer">Caddy NGINX Config Adapter</a>, converts NGINX config files into Caddy&#39;s native format.</li></ul><h2 id="nginx" tabindex="-1"><a class="header-anchor" href="#nginx"><span>Nginx</span></a></h2><p>è™½ç„¶ Nginx çš„é…ç½®ä¸€ç›´æ¯”è¾ƒåŠé€€ï¼Œä½†æ˜¯åœ¨å½“å‰ AI æ—¶ä»£å€’ä¹Ÿæ²¡æœ‰é‚£ä¹ˆå›°éš¾ï¼Œä¸è¦æŠ±æœ‰æ’æ–¥å¿ƒç†ï¼ˆï¼‰ã€‚</p><h3 id="ç¼ºç‚¹" tabindex="-1"><a class="header-anchor" href="#ç¼ºç‚¹"><span>ç¼ºç‚¹</span></a></h3><blockquote><p>Several features that are free (in caddy) which cost money in nginx. ğŸ˜¦</p></blockquote><p><s>nginx çš„ quic è¿˜æ˜¯ moduleã€‚</s> <em>NGINX now officially supports HTTP/3 with QUIC. It is available as part of NGINX 1.25.1 mainline version for open source users and NGINX Plus R30 for enterprise customers.</em></p><h3 id="é…ç½®" tabindex="-1"><a class="header-anchor" href="#é…ç½®"><span>é…ç½®</span></a></h3><ul><li><a href="https://nginx.org/en/docs/ngx_core_module.html#worker_processes" target="_blank" rel="noopener noreferrer">worker_processes</a> é»˜è®¤ä¸º 1ã€‚è¯·ä¸€å®šè¦æ”¹æˆ autoï¼Œå¦åˆ™å•çº¿ç¨‹çš„æ€§èƒ½å¯èƒ½ä¸å¤Ÿã€‚</li></ul><h3 id="åŸç†" tabindex="-1"><a class="header-anchor" href="#åŸç†"><span>åŸç†</span></a></h3><p>Nginx é‡‡ç”¨ Master-Worker æ¨¡å‹ï¼Œå”¯ä¸€çš„ Master çº¿ç¨‹æ§åˆ¶æ‰€æœ‰ Worker çº¿ç¨‹å¯¹æ•°æ®è¿›è¡Œå¤„ç†ã€‚æ¯ä¸ª Worker å†…éƒ¨éƒ½æœ‰ä¸€ä¸ªåŸºäº event loop çš„ async runtimeï¼Œå¯ä»¥å¯¹å¤§é‡è¿æ¥è¿›è¡Œå¤„ç†ã€‚</p><h2 id="angie" tabindex="-1"><a class="header-anchor" href="#angie"><span><a href="https://github.com/webserver-llc/angie" target="_blank" rel="noopener noreferrer">Angie</a></span></a></h2><p>Nginx çš„ forkï¼Œæ”¯æŒ HTTP/3 å’Œè‡ªåŠ¨ acme æ›´æ–° è¯ä¹¦ã€‚</p><h2 id="é‡åˆ°çš„é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#é‡åˆ°çš„é—®é¢˜"><span>é‡åˆ°çš„é—®é¢˜</span></a></h2><h3 id="caddy-æ— æ³•å»ºç«‹è¿æ¥" tabindex="-1"><a class="header-anchor" href="#caddy-æ— æ³•å»ºç«‹è¿æ¥"><span>caddy æ— æ³•å»ºç«‹è¿æ¥</span></a></h3><p>æˆ‘æƒ³å¼€ä¸€ä¸ª file serverï¼Œé™æ€æ–‡ä»¶æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼ˆå°±æ˜¯æˆ‘çš„ blogï¼‰ã€‚ç„¶è€Œ caddy å¼€äº†ä»¥åä¸€è®¿é—®å°±æ˜¯ js æ‰§è¡Œé”™è¯¯ã€‚æˆ‘ä¹Ÿç”¨ nginx è¯•äº†ä¸€ä¸‹ï¼Œæ˜¯å¯ç”¨çš„ã€‚</p><p>æ‰‹åŠ¨ <code>caddy run</code> å´æ˜¯å¥½çš„ï¼Œå¯èƒ½æ˜¯ service å‡ºäº†é—®é¢˜ã€‚</p><h3 id="err-address-unreachable" tabindex="-1"><a class="header-anchor" href="#err-address-unreachable"><span>ERR_ADDRESS_UNREACHABLE</span></a></h3><p>ç”¨ caddy å’Œ nginx éƒ½è¯•äº†ä¸€éï¼Œæµè§ˆå™¨è®¿é—® ERR<em>ADDRESS_UNREACHABLEï¼Œæœ¬åœ°è®¿é—® 403ï¼Œè¯´æ˜ä¸æ˜¯é˜²ç«å¢™çš„é—®é¢˜ã€‚nginx æœ‰æŠ¥é”™ _13: Permission denied</em>ï¼Œç„¶åæœä¸€ä¸‹å‘ç°éœ€è¦ <code>chmod +x &lt;root&gt;</code>ã€‚åŠ äº†ä»¥åè¿˜æ˜¯æ²¡ç”¨ï¼ŒåŸæ¥ <em>root</em> çš„å…¨è·¯å¾„éƒ½éœ€è¦ <code>chmod +x</code>ã€‚ã€‚é—®é¢˜è§£å†³ã€‚</p><h2 id="external" tabindex="-1"><a class="header-anchor" href="#external"><span>external</span></a></h2><ol><li><a href="https://www.reddit.com/r/selfhosted/comments/hur1hx/caddy_vs_nginx_how_do_these_web_servers_reverse/" target="_blank" rel="noopener noreferrer">reddit: Caddy vs Nginx: How Do These Web Servers / Reverse Proxies Compare?</a></li><li><a href="https://caddy.community/t/why-caddy-2-over-nginx/9549" target="_blank" rel="noopener noreferrer">Why Caddy 2 over NGINX</a></li><li><a href="https://www.f5.com/company/blog/nginx/nginx-power-of-two-choices-load-balancing-algorithm" target="_blank" rel="noopener noreferrer">NGINX and the &quot;Power of Two Choices&quot; Load-Balancing Algorithm</a></li></ol>`,31))])}const y=s(c,[["render",h],["__file","reverse_proxy.html.vue"]]),f=JSON.parse('{"path":"/articles/reverse_proxy.html","title":"åå‘ä»£ç†","lang":"zh-CN","frontmatter":{"date":"2023-11-16T00:00:00.000Z","icon":"handshake-simple","category":["æ•™ç¨‹","æ¨è"],"tag":["ä»£ç†"],"description":"åå‘ä»£ç† ä¸€ä¸ªç³»ç»Ÿå¯èƒ½æœ‰ä¸€å †æœåŠ¡å™¨ï¼Œä¸€å°æœåŠ¡å™¨ä¸Šå¯èƒ½è¿è¡Œç€ä¸€å †æœåŠ¡ã€‚åä»£æ˜¯ä¸€ç§ä¸­é—´ä»¶ï¼Œå°†ä¸åŒè¯·æ±‚è½¬å‘åˆ°ä¸åŒæœåŠ¡ä¸Šï¼Œå…¼é¡¾äº†åŠ å¯†ï¼Œè´Ÿè½½å‡è¡¡ç­‰ã€‚more Nginx æ˜¯è€ç‰Œåä»£å¤§å“¥ï¼Œå…·æœ‰æˆç†Ÿçš„ç¤¾åŒºå’Œå¼ºå¤§çš„æ€§èƒ½ã€‚è€Œ caddy ç­‰æ–°èµ·ä¹‹ç§€ä¸»è¦èšç„¦äºæ˜“ç”¨æ€§ï¼Œä¾‹å¦‚é…ç½®é¡¹æ›´ç®€æ´ã€è‡ªåŠ¨ç­¾è¯ä¹¦å’Œ https é‡å®šå‘ç­‰ã€‚ caddy caddy æ˜¯ä¸€ä¸ªæ›´å¹´è½»çš„å·¥å…·ï¼Œæä¾›é...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"åå‘ä»£ç†\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-11-16T00:00:00.000Z\\",\\"dateModified\\":\\"2025-07-17T15:03:17.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://absx.pages.dev/articles/reverse_proxy.html"}],["meta",{"property":"og:site_name","content":"ç»å¯¹å€¼_x çš„åšå®¢"}],["meta",{"property":"og:title","content":"åå‘ä»£ç†"}],["meta",{"property":"og:description","content":"åå‘ä»£ç† ä¸€ä¸ªç³»ç»Ÿå¯èƒ½æœ‰ä¸€å †æœåŠ¡å™¨ï¼Œä¸€å°æœåŠ¡å™¨ä¸Šå¯èƒ½è¿è¡Œç€ä¸€å †æœåŠ¡ã€‚åä»£æ˜¯ä¸€ç§ä¸­é—´ä»¶ï¼Œå°†ä¸åŒè¯·æ±‚è½¬å‘åˆ°ä¸åŒæœåŠ¡ä¸Šï¼Œå…¼é¡¾äº†åŠ å¯†ï¼Œè´Ÿè½½å‡è¡¡ç­‰ã€‚more Nginx æ˜¯è€ç‰Œåä»£å¤§å“¥ï¼Œå…·æœ‰æˆç†Ÿçš„ç¤¾åŒºå’Œå¼ºå¤§çš„æ€§èƒ½ã€‚è€Œ caddy ç­‰æ–°èµ·ä¹‹ç§€ä¸»è¦èšç„¦äºæ˜“ç”¨æ€§ï¼Œä¾‹å¦‚é…ç½®é¡¹æ›´ç®€æ´ã€è‡ªåŠ¨ç­¾è¯ä¹¦å’Œ https é‡å®šå‘ç­‰ã€‚ caddy caddy æ˜¯ä¸€ä¸ªæ›´å¹´è½»çš„å·¥å…·ï¼Œæä¾›é..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-07-17T15:03:17.000Z"}],["meta",{"property":"article:tag","content":"ä»£ç†"}],["meta",{"property":"article:published_time","content":"2023-11-16T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-07-17T15:03:17.000Z"}]]},"git":{"createdTime":1700147032000,"updatedTime":1752764597000,"contributors":[{"name":"lxl66566","username":"lxl66566","email":"18259734087@163.com","commits":14,"url":"https://github.com/lxl66566"}]},"readingTime":{"minutes":3.06,"words":919},"filePathRelative":"articles/reverse_proxy.md","localizedDate":"2023å¹´11æœˆ16æ—¥","excerpt":"\\n","autoDesc":true}');export{y as comp,f as data};
