<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.20" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.79" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"遇到的问题","image":[""],"datePublished":"2023-10-11T00:00:00.000Z","dateModified":"2024-12-04T16:45:11.000Z","author":[]}</script><meta property="og:url" content="https://absx.pages.dev/articles/linux/problem.html"><meta property="og:site_name" content="绝对值_x 的博客"><meta property="og:title" content="遇到的问题"><meta property="og:description" content="遇到的问题 如何减少问题 老生常谈： pacman -Syu 若更新了内核，立刻重启 踩了很多坑，总结了点通用经验： 干点什么之前，先备份（打快照） 干点什么之前，先去 Arch 落絮搜一下关键词，看看别人有没有踩坑 nixos 也有 Nix 落絮 提示 以下是正文，按时间倒序。越后面（越早）时犯的错越傻逼… NixOS bootloader 由于，n..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-12-04T16:45:11.000Z"><meta property="article:tag" content="Linux"><meta property="article:tag" content="工具"><meta property="article:tag" content="桌面端"><meta property="article:published_time" content="2023-10-11T00:00:00.000Z"><meta property="article:modified_time" content="2024-12-04T16:45:11.000Z"><link rel="alternate" type="application/rss+xml" href="https://absx.pages.dev/rss.xml" title="绝对值_x 的博客 RSS Feed"><title>遇到的问题 | 绝对值_x 的博客</title><meta name="description" content="遇到的问题 如何减少问题 老生常谈： pacman -Syu 若更新了内核，立刻重启 踩了很多坑，总结了点通用经验： 干点什么之前，先备份（打快照） 干点什么之前，先去 Arch 落絮搜一下关键词，看看别人有没有踩坑 nixos 也有 Nix 落絮 提示 以下是正文，按时间倒序。越后面（越早）时犯的错越傻逼… NixOS bootloader 由于，n...">
    <link rel="preload" href="/assets/style-Dpk0kKbU.css" as="style"><link rel="stylesheet" href="/assets/style-Dpk0kKbU.css">
    <link rel="modulepreload" href="/assets/app-UExJP7vi.js"><link rel="modulepreload" href="/assets/problem.html-BdCwY15X.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><!--[--><div class="theme-container external-link-icon pure has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/" aria-label="带我回家"><img class="vp-nav-logo" src="/logo.jpg" alt><!----><span class="vp-site-name hide-in-pad">绝对值_x 的博客</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/coding/" aria-label="编程" iconsizing="height"><!--[--><i class="vp-icon fas fa-code" sizing="height"></i><!--]-->编程<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="爱好"><!--[--><i class="vp-icon fas fa-heart" sizing="height"></i>爱好<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">游戏</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/hobbies/galgame.html" aria-label="galgame" iconsizing="both"><!--[--><i class="vp-icon fas fa-plane fa-fw" sizing="both"></i><!--]-->galgame<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/hobbies/rhythm_games.html" aria-label="音游" iconsizing="both"><!--[--><i class="vp-icon fas fa-keyboard fa-fw" sizing="both"></i><!--]-->音游<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/hobbies/Minecraft.html" aria-label="我的世界" iconsizing="both"><!--[--><i class="vp-icon fas fa-tree fa-fw" sizing="both"></i><!--]-->我的世界<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/hobbies/other_games/" aria-label="其他游戏" iconsizing="both"><!--[--><i class="vp-icon fas fa-gamepad fa-fw" sizing="both"></i><!--]-->其他游戏<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">艺术</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/hobbies/books.html" aria-label="读书" iconsizing="both"><!--[--><i class="vp-icon fas fa-book-open-reader fa-fw" sizing="both"></i><!--]-->读书<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/hobbies/anime.html" aria-label="番剧" iconsizing="both"><!--[--><i class="vp-icon fas fa-play fa-fw" sizing="both"></i><!--]-->番剧<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/hobbies/art.html" aria-label="其他艺术形式" iconsizing="both"><!--[--><i class="vp-icon fas fa-palette fa-fw" sizing="both"></i><!--]-->其他艺术形式<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/hobbies/NSFW/" aria-label="NSFW" iconsizing="both"><!--[--><i class="vp-icon fas fa-h fa-fw" sizing="both"></i><!--]-->NSFW<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">其他</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/hobbies/snack.html" aria-label="零食区" iconsizing="both"><!--[--><i class="vp-icon fas fa-cookie-bite fa-fw" sizing="both"></i><!--]-->零食区<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="杂项"><!--[--><i class="vp-icon fas fa-plus" sizing="height"></i>杂项<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/farraginous/recommend_packages.html" aria-label="软件汇总" iconsizing="both"><!--[--><i class="vp-icon fas fa-cube fa-fw" sizing="both"></i><!--]-->软件汇总<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/farraginous/recommend_websites.html" aria-label="网址汇总" iconsizing="both"><!--[--><i class="vp-icon fas fa-earth-asia fa-fw" sizing="both"></i><!--]-->网址汇总<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/farraginous/college.html" aria-label="校内专栏" iconsizing="both"><!--[--><i class="vp-icon fas fa-graduation-cap fa-fw" sizing="both"></i><!--]-->校内专栏<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/farraginous/reciter.html" aria-label="背词器" iconsizing="both"><!--[--><i class="vp-icon fas fa-eye fa-fw" sizing="both"></i><!--]-->背词器<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/articles/" aria-label="文章" iconsizing="height"><!--[--><i class="vp-icon fas fa-blog" sizing="height"></i><!--]-->文章<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/learning/" aria-label="学习" iconsizing="height"><!--[--><i class="vp-icon fas fa-pen" sizing="height"></i><!--]-->学习<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/gossip/" aria-label="闲聊" iconsizing="height"><!--[--><i class="vp-icon fas fa-comment" sizing="height"></i><!--]-->闲聊<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/essay/" aria-label="随笔" iconsizing="height"><!--[--><i class="vp-icon fas fa-newspaper" sizing="height"></i><!--]-->随笔<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/blog/" aria-label="博客" iconsizing="height"><!--[--><i class="vp-icon fas fa-blog" sizing="height"></i><!--]-->博客<!----></a></div></nav><!--]--></div><div class="vp-navbar-end"><!--[--><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/lxl66566/lxl66566.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item vp-action"><a class="vp-action-link" href="https://t.me/ab5_x" target="_blank" rel="noopener noreferrer" aria-label="telegram"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M248,8C111.033,8,0,119.033,0,256S111.033,504,248,504,496,392.967,496,256,384.967,8,248,8ZM362.952,176.66c-3.732,39.215-19.881,134.378-28.1,178.3-3.476,18.584-10.322,24.816-16.948,25.425-14.4,1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25,5.342-39.5,3.652-3.793,67.107-61.51,68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608,69.142-14.845,10.194-26.894,9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7,18.45-13.7,108.446-47.248,144.628-62.3c68.872-28.647,83.183-33.623,92.511-33.789,2.052-.034,6.639.474,9.61,2.885a10.452,10.452,0,0,1,3.53,6.716A43.765,43.765,0,0,1,362.952,176.66Z" fill="currentColor"></path></svg></a></div><div class="nav-item vp-action"><a class="vp-action-link" href="/rss.xml" target="_blank" rel="noopener noreferrer" aria-label="telegram"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M320.16155 831.918c0 70.738-57.344 128.082-128.082 128.082S63.99955 902.656 63.99955 831.918s57.344-128.082 128.082-128.082 128.08 57.346 128.08 128.082z m351.32 94.5c-16.708-309.2-264.37-557.174-573.9-573.9C79.31155 351.53 63.99955 366.21 63.99955 384.506v96.138c0 16.83 12.98 30.944 29.774 32.036 223.664 14.568 402.946 193.404 417.544 417.544 1.094 16.794 15.208 29.774 32.036 29.774h96.138c18.298 0.002 32.978-15.31 31.99-33.58z m288.498 0.576C943.19155 459.354 566.92955 80.89 97.00555 64.02 78.94555 63.372 63.99955 77.962 63.99955 96.032v96.136c0 17.25 13.67 31.29 30.906 31.998 382.358 15.678 689.254 322.632 704.93 704.93 0.706 17.236 14.746 30.906 31.998 30.906h96.136c18.068-0.002 32.658-14.948 32.01-33.008z" fill="currentColor"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><button type="button" class="slimsearch-button" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="slimsearch-placeholder">搜索</div><div class="slimsearch-key-hints"><kbd class="slimsearch-key">Ctrl</kbd><kbd class="slimsearch-key">K</kbd></div></button><!--]--><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/articles/linux/" aria-label="linux" iconsizing="both"><!--[--><i class="vp-icon fas fa-brands fa-linux fa-fw" sizing="both"></i><!--]-->linux<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/articles/linux/basic.html" aria-label="基础" iconsizing="both"><!--[--><i class="vp-icon fas fa-microchip fa-fw" sizing="both"></i><!--]-->基础<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/articles/linux/install_and_config.html" aria-label="安装与配置（Arch 篇）" iconsizing="both"><!--[--><i class="vp-icon fas fa-archway fa-fw" sizing="both"></i><!--]-->安装与配置（Arch 篇）<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/articles/linux/nix.html" aria-label="安装与配置（NixOS 篇）" iconsizing="both"><!--[--><i class="vp-icon fas fa-regular fa-snowflake fa-fw" sizing="both"></i><!--]-->安装与配置（NixOS 篇）<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/articles/linux/openwrt.html" aria-label="OpenWRT" iconsizing="both"><!--[--><i class="vp-icon fas fa-wifi fa-fw" sizing="both"></i><!--]-->OpenWRT<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/articles/linux/package.html" aria-label="包管理与使用推荐" iconsizing="both"><!--[--><i class="vp-icon fas fa-cubes fa-fw" sizing="both"></i><!--]-->包管理与使用推荐<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/articles/linux/problem.html" aria-label="遇到的问题" iconsizing="both"><!--[--><i class="vp-icon fas fa-regular fa-circle-xmark fa-fw" sizing="both"></i><!--]-->遇到的问题<!----></a></li></ul><!----></aside><!--[--><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><i class="vp-icon fas fa-regular fa-circle-xmark" sizing="height"></i>遇到的问题</h1><div class="page-info"><!----><!----><span class="page-date-info" aria-label="写作日期"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2023年10月11日</span><meta property="datePublished" content="2023-10-11T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 16 分钟</span><meta property="timeRequired" content="PT16M"></span><span class="page-category-info" aria-label="分类"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item clickable" role="navigation">经历</span><!--]--><meta property="articleSection" content="经历"></span><span class="page-tag-info" aria-label="标签"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item clickable" role="navigation">桌面端</span><span class="page-tag-item clickable" role="navigation">工具</span><span class="page-tag-item clickable" role="navigation">Linux</span><!--]--><meta property="keywords" content="桌面端,工具,Linux"></span></div><hr></div><!----><div class="" vp-content><!----><div id="markdown-content"><h1>遇到的问题</h1><h2>如何减少问题</h2><p>老生常谈：</p><ol><li><code>pacman -Syu</code> 若更新了内核，立刻重启</li></ol><p>踩了很多坑，总结了点通用经验：</p><ol><li>干点什么之前，先备份（打快照）</li><li>干点什么之前，先去 <a href="https://luoxu.archlinuxcn.org/" target="_blank" rel="noopener noreferrer">Arch 落絮</a>搜一下关键词，看看别人有没有踩坑 <ul><li>nixos 也有 <a href="https://luoxu.torus.icu/" target="_blank" rel="noopener noreferrer">Nix 落絮</a></li></ul></li></ol><div class="hint-container tip"><p class="hint-container-title">提示</p><p>以下是正文，按时间倒序。越后面（越早）时犯的错越傻逼…</p></div><h2>NixOS bootloader</h2><p>由于<a class="route-link" href="/articles/linux/nix.html#nixos-%E5%AE%89%E8%A3%85">一些原因</a>，<code>nixos-enter</code> 后无法 rebuild。如果配置坏了那就只能 reinstall 了，但是如果只是 bootloader 坏了，还是有办法免安装救一下的，<code>nixos-enter</code> 后 <code>/nix/var/nix/profiles/system/bin/switch-to-configuration --install-bootloader</code> 即可。</p><h2>NixOS 调整风扇转速</h2><p>未解决！</p><p>由于 <a class="route-link" href="/articles/linux/nix.html#gaming">nix gaming</a> 的需求，需要调教性能。但是我的 nixos 的风扇就是转不起来，即使温度已经过 90 了。。。</p><p>nixos 原生支持 <a href="https://search.nixos.org/options?channel=unstable&amp;show=hardware.fancontrol.enable" target="_blank" rel="noopener noreferrer">fancontrol service</a>，但是需要一个配置文件。这个配置基本上都是用 pwmconfig 生成的，我跑这指令只能得到 <code>There are no pwm-capable sensor modules installed</code>。搜了一圈，找不到解。尝试了包括内核参数 <code>acpi_enforce_resources=lax</code>，加载 <code>coretemp</code> 内核模块，无效。</p><p>而其他调速软件例如 fan2go 也是基于 lm_sensors 的，显然无法使用。</p><p>如果不使用 fancontrol，各种三方软件缺乏维护，也需要手写配置，还没有文档。反正总线地址是绕不开的。还有许多三方是针对特定 PC 型号的，联想华硕都是机上机，可惜我这台七彩虹不在五型之中。</p><p>emm，最后还试了一下 wine 跑七彩虹的 game center，毫不意外地崩了。</p><p>有群友建议我使用 tuxedo-rs，试了一下也不行，<code>input=AddError(&quot;Bus response error: org.freedesktop.DBus.Error.InvalidArgs: No fan found at requested index&quot;)</code>。</p><h2>libvirt 虚拟机 Network not found</h2><p>我使用 libvirt + qemu kvm + Virtual Machine Manager (VMM) 进行虚拟机管理。然而在我用 archinstall 安装 arch 后，发现没装 dhcpcd，所有镜像的域名都无法解析。因此我需要再次挂载安装盘，进去装 dhcpcd。</p><p>然后去实验室上课，带着电脑，到那边启动虚拟机发现报错：<code>error: Network not found: no network with matching name &#39;default&#39;</code>。猜测是 active 的联网设备由网口变为 wifi 导致的。</p><p>使用 <code>virsh net-autostart default</code> 启动 default 配置，报错 <code>error: Network not found: no network with matching name &#39;default&#39;</code>。啊？然后去自定义一个 default：<code>sudo virsh net-define /var/lib/libvirt/qemu/networks/default.xml</code>（nixos 的默认路径）。然后再次 <code>virsh net-autostart default</code>，还是报一样的错误。我猜测是用了 sudo 的问题，define 的配置并不在当前用户上。因此我将此 xml 拷到 /tmp，更改 owner 和权限，不使用 sudo 进行 <code>virsh net-define</code> 并 start，成功。</p><h2>EFI 空间不足</h2><p>一些 Linux 新手（包括我）在第一次给 Linux 分区时都会将 EFI 分区分得过小。我分了 512M，之前在 Arch 最多也就同时用三个内核，而此次再加上了一堆 NixOS 的内核后终究是不堪重负，<code>no space left on device</code>。</p><p>于是我考虑为其扩容。在我的硬盘上，EFI 是第一个分区，而第二个刚好是 19GB 的 swap，这非常有利，我完全不需要考虑数据问题。使用 cfdisk，直接缩小 swap 分区会从后方缩小，因此需要删除 swap 分区，在扩大 EFI 分区后，再在原位置建立 swap 分区。</p><p>这还没完，EFI 分区扩大了，但是 filesystem 的大小是没变的（又被坑了一次，分完区还报错空间不足呢）。由于我的 Nixos 安装盘上并没有 fatresize（吐槽），并且系统进不去（说到底这个 bug 是我在解决另一个 bug 时出现的），所以只好使用笨办法，借用 swap 分区。</p><p>首先，上 cfdisk 把 swap 改成正常分区，然后 <code>mkfs.ext4</code>，挂载后把 EFI 的东西全部 cp 进去，再对 EFI 分区 <code>mkfs.vfat</code>。最后把数据移回去，swap 改回去就大功告成了。听着就麻烦。后来我自己做了 NixOS iso 并且把 fatresize 加进去了，不过估计是用不到了。（现在 EFI 有 2G）</p><p>改完千万别忘了调挂载里的 uuid。</p><h2>cfdisk 操作分区</h2><p>cfdisk 是一个非常好用的 TUI 分区工具，但是对于初次使用的人（其实不是初次，但是忘了），cfdisk 也可能成为一个坑。</p><p>所有在 cfdisk 里的操作都是<strong>模拟</strong>。在完成操作后需要执行一次 <code>写入（Write）</code> 才会被真正应用。<s>我说我怎么缩过的分区还会自己合起来的</s></p><h2>你的复制是真正的复制？</h2><p>在 windows 上将一个 2G 的镜像复制到 U 盘里要花上几分钟，而在 Archlinux 上是瞬间。而 U 盘的写入速度不可能超越瓶颈。很容易猜到后台有东西在对 U 盘进行写入。遂关机，发现 <code>A stop job is running for Disk Manager</code>，证毕。</p><h2>NixOS-WSL 网络</h2><p>首先，装好 NixOS-WSL 后，无法 <code>sudo nix-channel --update</code>。查看环境变量发现没有设代理，于是<a href="https://nixos-cn.org/tutorials/installation/Networking.html#_3-%E4%BD%BF%E7%94%A8%E4%BB%A3%E7%90%86%E5%B7%A5%E5%85%B7%E5%8A%A0%E9%80%9F%E8%AE%BF%E9%97%AE-channels-%E8%B7%9F-flake-inputs" target="_blank" rel="noopener noreferrer">设了</a>，结果发现还是不行。然后想到 root 和 user 用的不是同一个 env，便进入 root 修改（需要用 <code>sudo -i</code> 进 root 而不是 <code>su</code>）。</p><p>在 root 下，<code>/run/systemd/system/nix-daemon.service.d/override.conf</code> 并不能在 env 中生效，因此我只好手动 <code>export https_proxy=http://localhost:10450</code> 代理环境变量，成功 update + rebuild。<s>然后一个更新就 5.6G 了</s></p><h2>KDE6</h2><p>KDE 在 20240306 左右释出了 KDE6，但是有一些需要手动处理的地方：</p><ul><li>我直接升级后遇到了破坏主题的情况，使 sddm 登录回退到默认主题。解法：<code>pacman -S layer-shell-qt5 plasma-framework5</code>. (<a href="https://t.me/archlinuxcn_group/3093488" target="_blank" rel="noopener noreferrer">ref</a>)</li><li>KDE6 带来了默认悬浮任务栏，但是刚开始的时候是有 bug 的，点击位置并没有悬浮，出现错位。后来虽然修了，但我也不想用悬浮了。解法：右击任务栏进入编辑模式，关闭悬浮。</li><li>KDE6 将默认打开行为由单击改为了双击，但我是单击党。因此我改回单击：在 <em>系统设置 - 工作区 - 常规行为</em> 里调。Dolphin 的设置里是没有的。</li></ul><h2>关机等待 90s</h2><p>首先把 timeout 改到 10s。</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> printf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;DEFAULT_TIMEOUT_SEC=10\n&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt;&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/etc/environment</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 不能 set -Ux DEFAULT_TIMEOUT_SEC 10，因为不读 fish 环境变量</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/systemd/system.conf</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># change this</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">DefaultTimeoutStartSec</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{{DEFAULT_TIMEOUT_SEC}}s</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">DefaultTimeoutStopSec</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{{DEFAULT_TIMEOUT_SEC}}s</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">DefaultDeviceTimeoutSec</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{{DEFAULT_TIMEOUT_SEC}}s</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>但是并没有什么卵用。</p><p>后面多经历了几次，发现某些 wine 程序会导致这个问题。因此在关机前执行 <code>wineserver -k9</code>。</p><p>然后发现内核参数有个 <code>nowatchdog</code>，将此参数删除可能可以解决此问题。但是在 wiki 的性能优化中有提到，在桌面或笔记本个人电脑上没有必要开启 watchdog，我认为还是不要损失性能的更好。</p><p>最后我的解法是 <a class="route-link" href="/articles/linux/install_and_config.html#%E7%B3%BB%E7%BB%9F%E8%AE%BE%E7%BD%AE">sysrq 键 (13.)</a>，这是一组能直接与内核交互的键。当我关机时出现等待时，按下 <code>Alt + Sysrq + I</code> 即可对其他进程发出 <code>SYSKILL</code>，也就能够正常关机了。</p><h2>waydroid 的问题</h2><h3>启动失败</h3><p>安装 waydroid 不久后，<code>waydroid show-full-ui</code> 启动失败，命令行显示 <code>waydroid [gbinder] Service manager /dev/anbox-binder has appeared</code>，但是却没有打开图形界面。</p><p>重启后好了，再重启又炸了。</p><p><a href="https://github.com/waydroid/waydroid/issues/136#issuecomment-949694932" target="_blank" rel="noopener noreferrer">某个 issue</a> 讲设置内核启动参数，试了一下，无效。</p><p>此时想到要看 log，<code>waydroid log</code> 显示 <code>lxc-start: waydroid: ../src/lxc/conf.c: run_buffer: 322 Script exited with status 126</code>。</p><p>没辙，然后 <code>sudo waydroid init -f</code> 重装。然后就能用了。</p><p>后来又一次遇到了相同问题，这次拿了更多信息去搜，发现一个<a href="https://github.com/waydroid/waydroid/issues/294#issuecomment-1027392592" target="_blank" rel="noopener noreferrer">看起来不相似的 issue</a> 居然能解决我的问题，非常惊讶。</p><h2>timeshift 删除快照</h2><p>未解决！</p><p>我已经转 snapper 了，想删除所有 timeshift 的快照并卸载。然而有一个快照在删除中出现错误（真的太傻逼了）。于是我找到了<a href="https://bbs.archlinux.org/viewtopic.php?id=266965" target="_blank" rel="noopener noreferrer">这个回答</a>，发现问题基本是一样的。于是只要手动删除子卷就行了。</p><p>但是，我找不到子卷的位置。</p><blockquote><p>&gt; sudo timeshift --list<br> Mounted &#39;/dev/nvme1n1p3&#39; at &#39;/run/timeshift/36810/backup&#39;</p></blockquote><p><code>/run/timeshift</code> 文件夹是空的。后来又找到了<a href="https://bbs.archlinux.org/viewtopic.php?id=287094" target="_blank" rel="noopener noreferrer">其他人相同的遭遇</a>。That&#39;s STICKY！</p><h2>sddm 无法启动</h2><p>这是我遇到的第二个恶性 bug<sup class="footnote-ref"><a href="#footnote1">[1]</a><a class="footnote-anchor" id="footnote-ref1"></a></sup>（第一个是 <a href="#timeshift-%E5%BC%95%E5%8F%91%E7%9A%84%E8%A1%80%E6%A1%88">timeshift</a>）。</p><p><a href="https://t.me/withabsolutex/1331" target="_blank" rel="noopener noreferrer">log</a>，具体来说是启动全绿，而后左上角光标卡住不闪烁。<code>Ctrl + Alt + F1</code> 后进入 tty，屏幕显示方才的内核全绿消息，光标闪烁，但仍然无法输入任何字符。</p><p>我尝试：</p><ol><li>首先短按关机，用 archiso 挂载后 <code>arch-chroot</code> 进去，看日志，看内核消息，无相关报错。</li><li>重新 <code>mkinitcpio -p linux</code>，重启无效。</li><li>想到最后一条内核消息是 SDDM，绞尽脑汁，我今天干了啥呢，哦，我用了个 <code>nvidia-xconfig</code> 生成了 NVIDIA 配置。</li><li>重新 <code>arch-chroot</code>，去 <code>/etc/X11</code> 里根据修改日期删除生成的两个 <code>.conf</code> 文件，重启，问题解决。</li></ol><p>哎，NVIDIA 害人不浅。。而且 archwiki 并未指出双显卡不能使用 <code>nvidia-xconfig</code>。</p><h2>ubuntu 提示重启</h2><p>在公家服务器上 <code>apt update &amp;&amp; apt install ...</code>，然后出现一个 tui 界面提示 <em>new kernel available</em>，让我选要重启的服务。。由于不知道重启之后会多出什么问题，我按两次 ESC 退出了。</p><h2>timeshift 引发的血案</h2><blockquote><p>前情提要见<a href="#%E7%BD%91%E5%8D%A1%E9%97%AE%E9%A2%98">网卡问题</a>。</p></blockquote><ol><li><p>使用 timeshift 回退到 20+days 前，重启，发现错误：<em>Failed to mount /boot</em>。<code>journalctl -xb</code> 查看，找到：<em>unknown filesystem type &#39;vfat&#39;</em>。</p></li><li><p>搜了一阵，<code>uname -a</code> 显示我内核是 6.5.5，而回退到的时间点正在用内核 6.5.3，猜测是内核版本冲突。</p></li><li><p>去 archlinuxcn 群里问，果真，然后都在说是 timeshift 的锅。（本群又一个 timeshift 受害者）去 luoxu 找历史记录，出现回答 “<em>timeshift 不兼容 genfstab，生成出來的子卷掛載帶 subvolid= 參數的情況</em>” (<a href="https://t.me/archlinuxcn_group/2927677" target="_blank" rel="noopener noreferrer">ref</a>)</p></li><li><p>照着 13 天前另一个人的一模一样的问题走了一遍老路。具体的，进入 archiso 安装盘：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 挂载子卷 / 和 /boot（nvmexnxpx 填写实际驱动器号）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mount</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -t</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> btrfs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> subvol=/@,compress=zstd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/nvmexnxpx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/nvmexnxpx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/boot</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># chroot</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">arch-chroot</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 重装内核与软件包</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pacman</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -Syu</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> linux</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 删掉 fstab 中的 subvolid...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nvim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/fstab</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 重启</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">reboot</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>其实在折腾过程中还遇到各种脑残小问题，排查花了一些时间，这里按下不表。</p><blockquote><p>你是遇到问题才想到恢复到快照吗，下次建议直接修遇到的问题，只要解决 1 个问题。回滚的话你现在要修原本遇到的问题和因为回滚遇到的问题，共 2 个问题（</p><div style="text-align:right;"><p>——@Senaruk, <a href="https://t.me/archlinuxcn_group/2951737" target="_blank" rel="noopener noreferrer">ref</a></p></div></blockquote><h2>网卡问题</h2><p>连接网线使用时总是约每 5min 炸一次（以太网无 Internet 响应，回退到使用 wlan0）。去 Realtek 下载网卡驱动，README 让执行一个自动脚本，<code>sudo bash xxx.sh</code> 把我原来网卡驱动卸(禁用?)掉以后就报错强退了。。。（写的什么屎山，真不负责啊）于是没有 eth0 用了。</p><p>搜索解法无果，想着用 timeshift 回退到爆炸前，但是快照打得不勤，只能回退到 20+days 前，于是就发生了<a href="#timeshift-%E5%BC%95%E5%8F%91%E7%9A%84%E8%A1%80%E6%A1%88">timeshift 引发的血案</a>——</p><h2>安装 OSU</h2><p>首先<a href="https://osu.ppy.sh/community/forums/topics/1248084?n=1" target="_blank" rel="noopener noreferrer">教程在这</a>。</p><p>安装时显示没网，是我 daed 透明代理的锅，<code>curl google.com</code> 正常但是 ping 不动。把脚本那行 ping 验证注释掉就行了。后面安装可能会缺东西，照着提示装。</p><p>装完后没有 <code>osu-wine</code> 被添加到环境变量，不能直接执行；<code>osu-wine</code> 脚本在 <code>git clone</code> 那个目录，使用绝对路径即可。</p><p>这样用 wine 装好的 osu 游戏时只能跑到 170 帧（windows 上 1k+ fps），使用 <code>nvtop</code> 查看，果然跑在核显上，需要 <code>prime-run</code>。这个 <code>prime-run</code> 还不是随便加的，我在 krunner 里加了以后帧率没有变化，但是 <code>nvtop</code> 是有输出的。我一直以为有什么其他问题，直到我看到了<a href="https://github.com/NelloKudo/osu-winello/wiki/(Possibly)-optimize-your-game:-Gamemode#installing-gamemode" target="_blank" rel="noopener noreferrer">这个</a>，我才发现加错了位置，需要加到 <code>~/.local/bin/osu-wine</code> 脚本里。（对，这是个脚本）</p><p>现在又出现了音频问题，pipewire 下无法正常播放，唉。</p><h2>更新破坏依赖</h2><p>四个字，<strong>先删再装</strong>。参考<a href="https://bbs.archlinuxcn.org/viewtopic.php?id=10208" target="_blank" rel="noopener noreferrer">forum</a>，问题可能是有游离的软件包，也可能是上游改了依赖。</p><p>相信我，这个问题以后还会经常出现。</p><h2>nvim 剪贴板问题</h2><p>我在 <code>option.lua</code> 中有设置 <code>vim.opt.clipboard = &#39;unnamedplus&#39;</code>，之前运作挺好，但自从换了 X11 以后就不能再复制。</p><p>解法也很简单，安装 <code>xclip</code> 即可。</p><h2>yay 权限错误</h2><p>使用 <code>yay</code> 安装 <code>wine-stable</code> 时出现了一些问题。</p><div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>-&gt; 无法安装以下软件包, 需要手动介入处理:</span></span>
<span class="line"><span>lib32-http-parser - exit status 4</span></span>
<span class="line"><span>lib32-libheif - exit status 8</span></span>
<span class="line"><span>lib32-libgphoto2 - exit status 8</span></span>
<span class="line"><span>lib32-libxpm - exit status 1</span></span>
<span class="line"><span>lib32-libgit2 - exit status 8</span></span>
<span class="line"><span>lib32-gd - exit status 8</span></span>
<span class="line"><span>wine-stable - exit status 8</span></span>
<span class="line"><span>lib32-libraqm - exit status 4</span></span>
<span class="line"><span>lib32-rav1e - exit status 8</span></span>
<span class="line"><span># 详细报错：</span></span>
<span class="line"><span>make: ./test_g: 权限不够make: *** [Makefile:76：test] 错误 127</span></span>
<span class="line"><span>==&gt; 错误： 在 check() 中发生一个错误。正在放弃...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中大多数是权限错误。但是我用 paru 安装就可以成功安装。</p><p>结果发现是下载目录的 tmpfs 开了 <code>noexec</code> 导致的。而同时由于 paru 的 clonedir 是 <a class="route-link" href="/articles/linux/#%E8%AE%BE%E7%BD%AE">bind to tmpfs</a> 的，没有加 <code>noexec</code>，于是可以正常使用。。。（乐</p><h2>输入法不显示</h2><p>在<a href="#%E9%87%8D%E8%A3%85-ubuntu">安装了 kubuntu</a> 后，设置页默认不显示输入法。在语言页面一看，简体中文是残缺的，警告需要 Install Missing Packages。但是我无法直接在 kde ui 里直接下载安装，点击了过一阵子又是残缺警告（包括 kde ui 也没法更新软件）。</p><p>解法是 <code>sudo apt install $(check-language-support)</code>。然后注销，再 login 就有输入法了。</p><h2>日文输入法</h2><p>需要安装日文输入法，去 archwiki 日语页面看，选择了 <code>mozc</code>。然后我就直接 <code>yay -S mozc</code> 了，，装是装了，然而没法使用。。</p><p>后来发现我使用 fcitx5 的话需要装 fcitx5 的 mozc utils（包名是<code>fcitx5-mozc-ut</code>）。然后就没啥问题了。</p><blockquote><p><s>吐槽一下，mozc 源码有 600+MB，然而 bin 只有 30MB，编译还风扇起飞转了好久。只能说体会到了编译源码的不便。</s></p></blockquote><h2>重装 ubuntu</h2><p>在别人的电脑上<s>乱搞</s>，装了 intel 核显驱动然后没有重启就 <code>sudo apt install vim</code>（是的，没有 vim）；然后 gnome 就已经开始出问题了，重启键消失了。这时候我还没有意识到，直接 <code>sudo reboot</code>，再次开机就内核加载失败了。。</p><p>然后尝试修复。能进 tty，但什么都没有，ifconfig 没有，<code>iwconfig</code> or <code>ls /sys/class/net</code> 只显示 <code>lo</code>，也就是说找不到网卡了。。那没网我能干啥，<s>vi 进去修吗？</s></p><p>还好没啥重要数据。授权后重装了 kubuntu。然后发现 kde 爆杀 gnome（二嘲）。</p><p>有一说一，我不喜欢 ubuntu 这样臃肿的系统。<s><a href="https://t.me/archlinuxcn_group/2896194" target="_blank" rel="noopener noreferrer">其他观点</a>，看上下文</s> 但是是帮别人装，还是别搞什么 archlinux（哪天滚挂了都不会修）和 nixos（小众，问题解法少）了。</p><blockquote><p>出现此问题时我是纯正小白，能力不足.jpg</p></blockquote><h2>中文设置问题</h2><p>在语言中设置了中文，重启后 kde 有部分 ui 变为英文。</p><p>原因：更改 <code>/etc/locale.gen</code> 后没有运行 <code>sudo locale-gen</code>。运行即可。</p><h2>yay 换源问题</h2><p>刚开始一直以为 yay 就是类似 pacman 的 extra，所以想要给 yay 换源。根据简中内网的傻逼教程（没错，此时还没上代理），换了个已经废弃的清华源（换源指令：<code>yay --aururl &quot;https://...&quot; --save</code>），发现用不了后换成了中科大源，结果报错：</p><blockquote><p>-&gt; 查找 AUR 软件包失败： ttf-ms-win11-auto-zh_cn:1 error occurred:<br> * response decoding failed: invalid character &#39;&lt;&#39; looking for beginning of value</p></blockquote><p>并且换回官方源仍然相同报错。换源过去然后发现换不回来，堪比刷小米 EU<sup class="footnote-ref"><a href="#footnote2">[2]</a><a class="footnote-anchor" id="footnote-ref2"></a></sup>.</p><p>之后发现，在 <code>~/.config/yay/config.json</code> 中有一个 <code>aurrpcurl</code> 字段，会保留上一个换源的结果(?) 并且不会自动更换回去。于是我删除该条，重新执行 <code>yay --aururl &quot;https://aur.archlinux.org&quot; --save</code>，问题得解。如果一次不行就两次，一定能解(?)。</p><p>ps. 群友提出了 <code>yay --aurrpcurl &#39;https://aur.archlinux.org&#39; --save</code></p><h2>umount failed</h2><p><code>sudo umount /mnt/windows</code>，提示</p><blockquote><p>/mnt/windows: 目标忙</p></blockquote><p>估计有莫名奇妙的软件在占用。直接 <code>lsof /mnt/windows</code> 查占用，然后再 <code>kill -9 &lt;PID&gt;</code> 强关。</p><h2>Windows 字体问题</h2><p>根据<a href="https://arch.icekylin.online/guide/advanced/optional-cfg-1.html#%E5%AE%89%E8%A3%85-windows-%E5%AD%97%E4%BD%93" target="_blank" rel="noopener noreferrer">教程</a>复制 windows 字体，<span class="heimu" title="你知道的太多了">打错大小写就先不说了，纠正以后</span>提示：</p><blockquote><p>cp: 对 &#39;./yuminl.ttf&#39; 调用 stat 失败: 没有那个文件或目录</p></blockquote><p>后来使用 <code>yay -S ttf-ms-win11-auto-zh_cn</code> 安装字体也失败，中间报 warning 一大堆。</p><p>没辙，暂时用 U 盘拷吧。</p><h2>yay 安装问题</h2><p>使用 <code>sudo pacman -S yay</code> 时一直报错，<code>signature is unknown trust</code> 类似的。怀疑是 pacman-keyring 问题，去前面 <a href="#%E6%9B%B4%E6%96%B0-pacman-keyring">更新 pacman-keyring</a> 试了好久，都不行。</p><p>后面看教程，发现需要先安装 cn 源中的签名：<code>sudo pacman -S archlinuxcn-keyring</code>，然后才能正常使用。。（因为 pacman 用的是 archlinuxcn 源）</p><h2>NetworkManager warning</h2><p>设置自启服务 <code>systemctl enable --now NetworkManager</code> 时报错：</p><blockquote><p>... iwlwifi ... WRT: invalid buffer destination</p></blockquote><p>不过后面 <code>systemctl status NetworkManager</code> 发现服务已经启动了，也就没管了（所以问题还是没解决的，然而图形界面后开机自启看不到报错了）</p><p>ps. 实际上 linux 下不明所以的 warning, error 好多的（详见 <code>journalctl</code> or <code>dmesg</code>），都是<strong>能用就别管</strong>原则</p><h2>挂载出错</h2><p>非常低级的错误。。挂载时打错了指令，导致不同的分区被挂载到了同一个位置。不过检查得早，没有继续下一步就发现了问题。</p><p>然后重新挂载，后来到 <em>生成 fstab 文件</em> 的时候又发现了怪事：<code>genfstab -U /mnt &gt; /mnt/etc/fstab</code> 输出了一大堆东西，我读了一下，原来把我挂载时做的所有操作（包括错误部分）都记录进去了。于是手动删除了冗余，后续重启工作正常。</p><p>这个文件用于指示开机挂载。包括后来挂内存盘也是从这里改。</p><h2>分区格式化</h2><p>使用 <code>cfdisk</code> 分好区，需要分别为每个分区进行格式化。然而我使用 nvme 盘而看的 sata 指令，对硬盘格式化而非对分区进行格式化（错误示范：<code>mkfs.vfat /dev/nvme1n1</code>），报错：</p><blockquote><p>Partitions or virtual mapping on device, not making file system. (use -I to override)</p></blockquote><p>然后尝试了 <code>-I</code>，结果分区全没了；对着 <code>nvme1n1</code> <code>mkswap</code>，分区又炸了（全盘格成了 swap）。最后才发现格式化是分区操作，而不是硬盘操作。。非常的萌新非常的弱智。</p><h2>更新 pacman keyring</h2><p>遇到问题：使用 pacman 安装时报错</p><blockquote><p>error: python-cairo: signature from &quot;Caleb Maclennan <a href="mailto:alerque@archlinux.org" target="_blank" rel="noopener noreferrer">alerque@archlinux.org</a>&quot; is unknown trust</p></blockquote><ol><li><p>尝试执行 <code>pacman-key --refresh-keys</code>，但是效率感人</p></li><li><p><a href="https://www.reddit.com/r/archlinux/comments/sorhb1/how_long_does_a_pacmankey_refreshkeys_take/" target="_blank" rel="noopener noreferrer">据此所述</a>：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mv</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/pacman.d/gnupg{,.bak}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pacman-key</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --init</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pacman-key</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --populate</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> archlinux</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然而没什么软用，还是报相同错误</p></li><li><p>更新 <code>archlinux-keyring</code> 本身：<code>sudo pacman -Sy archlinux-keyring</code>，问题解决</p></li></ol><div class="hint-container tip"><p class="hint-container-title">提示</p><p>裝 <code>archlinux-keyring</code> 其實就是在跑 <code>pacman-key --populate archlinux</code></p><div style="text-align:right;"><p>——farseerfc 😂, <a href="https://t.me/archlinuxcn_group/2911740" target="_blank" rel="noopener noreferrer">src</a></p></div></div><p>所以遇到 keyring 问题就先装 keyring 准没错（也适用于 <code>archlinuxcn-keyring</code>）。</p><h2><a href="https://bbs.archlinuxcn.org/viewtopic.php?id=13402" target="_blank" rel="noopener noreferrer">libcuda.so.1 is not a symbolic link</a></h2><p>Windows WSL 的锅，<a href="https://github.com/microsoft/WSL/issues/5548" target="_blank" rel="noopener noreferrer">解法</a>，但还有问题残留。</p><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="footnote1" class="footnote-item"><p>个人定义需要使用 archiso 进 arch-chroot 的都叫恶性。 <a href="#footnote-ref1" class="footnote-backref">↩︎</a></p></li><li id="footnote2" class="footnote-item"><p>参考<a href="../mobile_setting#mipad-5">刷机</a> <a href="#footnote-ref2" class="footnote-backref">↩︎</a></p></li></ol></section></div><!----><!----><!----></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">最近更新：</span><time class="vp-meta-info" datetime="2024-12-04T16:45:11.000Z" data-allow-mismatch>2024/12/4 16:45</time></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/articles/linux/package.html" aria-label="包管理与使用推荐" iconsizing="both"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><i class="vp-icon fas fa-cubes" sizing="height"></i>包管理与使用推荐</div></a><!----></nav><div id="comment" class="giscus-wrapper input-top vp-comment" vp-comment style="display:block;"><div style="display: flex;
align-items: center;
justify-content: center;
height: 96px"><span style="--loading-icon: url(&quot;data:image/svg+xml;utf8,%3Csvg xmlns=&#39;http://www.w3.org/2000/svg&#39; preserveAspectRatio=&#39;xMidYMid&#39; viewBox=&#39;25 25 50 50&#39;%3E%3CanimateTransform attributeName=&#39;transform&#39; type=&#39;rotate&#39; dur=&#39;2s&#39; keyTimes=&#39;0;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;0;360&#39;%3E%3C/animateTransform%3E%3Ccircle cx=&#39;50&#39; cy=&#39;50&#39; r=&#39;20&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39; stroke-width=&#39;4&#39; stroke-linecap=&#39;round&#39;%3E%3Canimate attributeName=&#39;stroke-dasharray&#39; dur=&#39;1.5s&#39; keyTimes=&#39;0;0.5;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;1,200;90,200;1,200&#39;%3E%3C/animate%3E%3Canimate attributeName=&#39;stroke-dashoffset&#39; dur=&#39;1.5s&#39; keyTimes=&#39;0;0.5;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;0;-35px;-125px&#39;%3E%3C/animate%3E%3C/circle%3E%3C/svg%3E&quot;);
--icon-size: 48px;
display: inline-block;
width: var(--icon-size);
height: var(--icon-size);
background-color: currentcolor;
-webkit-mask-image: var(--loading-icon);
mask-image: var(--loading-icon);
"></span></div></div><!----><!--]--></main><!--]--><!--]--><!----></div><!--]--><!--]--><!--[--><!----><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/assets/app-UExJP7vi.js" defer></script>
  </body>
</html>
