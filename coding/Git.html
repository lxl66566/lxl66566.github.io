<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.13" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.48" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://absx.pages.dev/coding/Git.html"><meta property="og:site_name" content="绝对值_x 的博客"><meta property="og:title" content="Git"><meta property="og:description" content="Git 是什么 Git is a free and open source distributed version control system designed to handle everything from small to very large projects with speed and efficiency. ——git-scm.com..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-12-31T19:22:20.000Z"><meta property="article:tag" content="工具"><meta property="article:published_time" content="2022-05-06T00:00:00.000Z"><meta property="article:modified_time" content="2024-12-31T19:22:20.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Git","image":[""],"datePublished":"2022-05-06T00:00:00.000Z","dateModified":"2024-12-31T19:22:20.000Z","author":[]}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-MKRDBH1ZP1"></script><script><!-- Google tag (gtag.js) -->
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-MKRDBH1ZP1');</script><link rel="icon" href="/logo.jpg" sizes="706x706"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><link rel="apple-touch-icon" href="/logo.jpg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="msapplication-TileImage" content="/logo.jpg"><meta name="msapplication-TileColor" content="#46bd87"><link rel="alternate" type="application/rss+xml" href="https://absx.pages.dev/rss.xml" title="绝对值_x 的博客 RSS Feed"><title>Git | 绝对值_x 的博客</title><meta name="description" content="Git 是什么 Git is a free and open source distributed version control system designed to handle everything from small to very large projects with speed and efficiency. ——git-scm.com...">
    <link rel="preload" href="/assets/style-lmLpZabu.css" as="style"><link rel="stylesheet" href="/assets/style-lmLpZabu.css">
    <link rel="modulepreload" href="/assets/app-Cyd0ROZI.js"><link rel="modulepreload" href="/assets/Git.html-DO7U3yPL.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><!--[--><div class="theme-container external-link-icon pure has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="/logo.jpg" alt><!----><span class="vp-site-name hide-in-pad">绝对值_x 的博客</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/coding/" aria-label="编程"><!--[--><span class="font-icon icon fas fa-code" style=""></span><!--]-->编程<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="爱好"><!--[--><span class="font-icon icon fas fa-heart" style=""></span>爱好<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">游戏</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/hobbies/galgame.html" aria-label="galgame"><!--[--><span class="font-icon icon fas fa-plane" style=""></span><!--]-->galgame<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/hobbies/rhythm_games.html" aria-label="音游"><!--[--><span class="font-icon icon fas fa-keyboard" style=""></span><!--]-->音游<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/hobbies/Minecraft.html" aria-label="我的世界"><!--[--><span class="font-icon icon fas fa-tree" style=""></span><!--]-->我的世界<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/hobbies/other_games/" aria-label="其他游戏"><!--[--><span class="font-icon icon fas fa-gamepad" style=""></span><!--]-->其他游戏<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">艺术</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/hobbies/books.html" aria-label="读书"><!--[--><span class="font-icon icon fas fa-book-open-reader" style=""></span><!--]-->读书<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/hobbies/anime.html" aria-label="番剧"><!--[--><span class="font-icon icon fas fa-play" style=""></span><!--]-->番剧<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/hobbies/art.html" aria-label="其他艺术形式"><!--[--><span class="font-icon icon fas fa-palette" style=""></span><!--]-->其他艺术形式<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/hobbies/NSFW/" aria-label="NSFW"><!--[--><span class="font-icon icon fas fa-h" style=""></span><!--]-->NSFW<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">其他</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/hobbies/snack.html" aria-label="零食区"><!--[--><span class="font-icon icon fas fa-cookie-bite" style=""></span><!--]-->零食区<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="杂项"><!--[--><span class="font-icon icon fas fa-plus" style=""></span>杂项<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/farraginous/recommend_packages.html" aria-label="软件汇总"><!--[--><span class="font-icon icon fas fa-cube" style=""></span><!--]-->软件汇总<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/farraginous/recommend_websites.html" aria-label="网址汇总"><!--[--><span class="font-icon icon fas fa-earth-asia" style=""></span><!--]-->网址汇总<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/farraginous/college.html" aria-label="校内专栏"><!--[--><span class="font-icon icon fas fa-graduation-cap" style=""></span><!--]-->校内专栏<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/farraginous/reciter.html" aria-label="背词器"><!--[--><span class="font-icon icon fas fa-eye" style=""></span><!--]-->背词器<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/articles/" aria-label="文章"><!--[--><span class="font-icon icon fas fa-blog" style=""></span><!--]-->文章<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/learning/" aria-label="学习"><!--[--><span class="font-icon icon fas fa-pen" style=""></span><!--]-->学习<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/gossip/" aria-label="闲聊"><!--[--><span class="font-icon icon fas fa-comment" style=""></span><!--]-->闲聊<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/essay/" aria-label="随笔"><!--[--><span class="font-icon icon fas fa-newspaper" style=""></span><!--]-->随笔<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/blog/" aria-label="博客"><!--[--><span class="font-icon icon fas fa-blog" style=""></span><!--]-->博客<!----></a></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/lxl66566/lxl66566.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item vp-action"><a class="vp-action-link" href="https://t.me/ab5_x" target="_blank" rel="noopener noreferrer" aria-label="telegram"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M248,8C111.033,8,0,119.033,0,256S111.033,504,248,504,496,392.967,496,256,384.967,8,248,8ZM362.952,176.66c-3.732,39.215-19.881,134.378-28.1,178.3-3.476,18.584-10.322,24.816-16.948,25.425-14.4,1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25,5.342-39.5,3.652-3.793,67.107-61.51,68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608,69.142-14.845,10.194-26.894,9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7,18.45-13.7,108.446-47.248,144.628-62.3c68.872-28.647,83.183-33.623,92.511-33.789,2.052-.034,6.639.474,9.61,2.885a10.452,10.452,0,0,1,3.53,6.716A43.765,43.765,0,0,1,362.952,176.66Z" fill="currentColor"></path></svg></a></div><div class="nav-item vp-action"><a class="vp-action-link" href="/rss.xml" target="_blank" rel="noopener noreferrer" aria-label="telegram"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M320.16155 831.918c0 70.738-57.344 128.082-128.082 128.082S63.99955 902.656 63.99955 831.918s57.344-128.082 128.082-128.082 128.08 57.346 128.08 128.082z m351.32 94.5c-16.708-309.2-264.37-557.174-573.9-573.9C79.31155 351.53 63.99955 366.21 63.99955 384.506v96.138c0 16.83 12.98 30.944 29.774 32.036 223.664 14.568 402.946 193.404 417.544 417.544 1.094 16.794 15.208 29.774 32.036 29.774h96.138c18.298 0.002 32.978-15.31 31.99-33.58z m288.498 0.576C943.19155 459.354 566.92955 80.89 97.00555 64.02 78.94555 63.372 63.99955 77.962 63.99955 96.032v96.136c0 17.25 13.67 31.29 30.906 31.998 382.358 15.678 689.254 322.632 704.93 704.93 0.706 17.236 14.746 30.906 31.998 30.906h96.136c18.068-0.002 32.658-14.948 32.01-33.008z" fill="currentColor"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon" name="search"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">搜索</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><p class="vp-sidebar-header"><!----><span class="vp-sidebar-title">思考</span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/coding/philosophy_of_PL.html" aria-label="编程语言哲学胡言乱语"><!--[--><span class="font-icon icon fas fa-question" style=""></span><!--]-->编程语言哲学胡言乱语<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header"><!----><span class="vp-sidebar-title">语言</span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/coding/Rust.html" aria-label="Rust"><!--[--><span class="font-icon icon fas fa-brands fa-rust" style=""></span><!--]-->Rust<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/Cpp.html" aria-label="C++"><!--[--><span class="font-icon icon fas fa-code" style=""></span><!--]-->C++<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/python.html" aria-label="Python"><!--[--><span class="font-icon icon fas fa-brands fa-python" style=""></span><!--]-->Python<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/shell.html" aria-label="shell script"><!--[--><span class="font-icon icon fas fa-fish" style=""></span><!--]-->shell script<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/java.html" aria-label="Java"><!--[--><span class="font-icon icon fas fa-brands fa-java" style=""></span><!--]-->Java<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/tsjs.html" aria-label="TypeScript"><!--[--><span class="font-icon icon fas fa-code" style=""></span><!--]-->TypeScript<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/html.html" aria-label="html"><!--[--><span class="font-icon icon fas fa-brands fa-html5" style=""></span><!--]-->html<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/csharp.html" aria-label="C#"><!--[--><span class="font-icon icon fas fa-code" style=""></span><!--]-->C#<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/kotlin.html" aria-label="kotlin"><!--[--><span class="font-icon icon fas fa-code" style=""></span><!--]-->kotlin<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/clojure.html" aria-label="Clojure"><!--[--><span class="font-icon icon fas fa-code" style=""></span><!--]-->Clojure<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header active"><!----><span class="vp-sidebar-title">工具</span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/coding/github.html" aria-label="Github"><!--[--><span class="font-icon icon fas fa-brands fa-github" style=""></span><!--]-->Github<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/coding/Git.html" aria-label="Git"><!--[--><span class="font-icon icon fas fa-brands fa-git-alt" style=""></span><!--]-->Git<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/vscode.html" aria-label="VSCode"><!--[--><span class="font-icon icon fas fa-file-pen" style=""></span><!--]-->VSCode<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/vim.html" aria-label="vim"><!--[--><span class="font-icon icon fas fa-keyboard" style=""></span><!--]-->vim<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/sql.html" aria-label="数据库"><!--[--><span class="font-icon icon fas fa-database" style=""></span><!--]-->数据库<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/container.html" aria-label="容器"><!--[--><span class="font-icon icon fas fa-box" style=""></span><!--]-->容器<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/package_manager.html" aria-label="包管理器"><!--[--><span class="font-icon icon fas fa-cubes" style=""></span><!--]-->包管理器<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header"><!----><span class="vp-sidebar-title">前端</span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/coding/nodejs.html" aria-label="JS 运行时"><!--[--><span class="font-icon icon fas fa-brands fa-node-js" style=""></span><!--]-->JS 运行时<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/tsjs.html" aria-label="TypeScript"><!--[--><span class="font-icon icon fas fa-code" style=""></span><!--]-->TypeScript<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/css.html" aria-label="CSS"><!--[--><span class="font-icon icon fas fa-brands fa-css" style=""></span><!--]-->CSS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/html.html" aria-label="html"><!--[--><span class="font-icon icon fas fa-brands fa-html5" style=""></span><!--]-->html<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/mdx.html" aria-label="MDX"><!--[--><span class="font-icon icon fas fa-brands fa-markdown" style=""></span><!--]-->MDX<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/vue.html" aria-label="Vue.js"><!--[--><span class="font-icon icon fas fa-brands fa-vuejs" style=""></span><!--]-->Vue.js<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/react.html" aria-label="React"><!--[--><span class="font-icon icon fas fa-brands fa-react" style=""></span><!--]-->React<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/solidjs.html" aria-label="SolidJS"><!--[--><span class="font-icon icon fas fa-arrow-up-right-dots" style=""></span><!--]-->SolidJS<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header"><!----><span class="vp-sidebar-title">其他</span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/coding/bagu.html" aria-label="八股"><!--[--><span class="font-icon icon fas fa-book-skull" style=""></span><!--]-->八股<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/android.html" aria-label="Android"><!--[--><span class="font-icon icon fas fa-brands fa-android" style=""></span><!--]-->Android<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/algorithm.html" aria-label="算法"><!--[--><span class="font-icon icon fas fa-wand-sparkles" style=""></span><!--]-->算法<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/bot.html" aria-label="bot"><!--[--><span class="font-icon icon fas fa-brands fa-bots" style=""></span><!--]-->bot<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/octave.html" aria-label="Matlab/Octave"><!--[--><span class="font-icon icon fas fa-brands fa-octopus-deploy" style=""></span><!--]-->Matlab/Octave<!----></a></li></ul></section></li></ul><!----></aside><!--[--><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><span class="font-icon icon fas fa-brands fa-git-alt" style=""></span>Git</h1><div class="page-info"><!----><!----><span class="page-date-info" aria-label="写作日期"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2022-05-06T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 21 分钟</span><meta property="timeRequired" content="PT21M"></span><span class="page-category-info" aria-label="分类"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item clickable" role="navigation">编程</span><!--]--><meta property="articleSection" content="编程"></span><span class="page-tag-info" aria-label="标签"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item clickable" role="navigation">工具</span><!--]--><meta property="keywords" content="工具"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#是什么">是什么</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#学习">学习</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#安装与配置">安装与配置</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#安装-windows">安装（windows）</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#配置">配置</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#其他工具">其他工具</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#基础">基础</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#创建仓库">创建仓库</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#提交">提交</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#上传">上传</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#忽略文件-夹">忽略文件（夹）</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#自动化脚本">自动化脚本</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#设置">设置</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#进阶">进阶</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#提交-1">提交</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#远程">远程</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#仓库查询">仓库查询</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#分支">分支</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#操作文件">操作文件</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#下载">下载</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#彻底删除提交">彻底删除提交</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#submodule">submodule</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#深入">深入</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#畅游-git-提交树">畅游 git 提交树</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#任意组合提交树">任意组合提交树</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#其他技巧">其他技巧</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#将注释设为当前时间">将注释设为当前时间</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#用于备份">用于备份</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#取消转义">取消转义</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#协同开发">协同开发</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#合并-pull-request">合并 Pull request</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#删除大文件">删除大文件</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#大文件上传">大文件上传</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#reflog-查找">reflog 查找</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#签名">签名</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#自建-git-托管">自建 git 托管</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#统计-git-分支大小">统计 git 分支大小</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#奇技淫巧">奇技淫巧</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#自动化-squash">自动化 squash</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#崭新出厂">崭新出厂</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#external">external</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h1 id="git" tabindex="-1"><a class="header-anchor" href="#git"><span>Git</span></a></h1><h2 id="是什么" tabindex="-1"><a class="header-anchor" href="#是什么"><span>是什么</span></a></h2><p><em>Git is a free and open source distributed version control system designed to handle everything from small to very large projects with speed and efficiency. ——<a href="https://git-scm.com/" target="_blank" rel="noopener noreferrer">git-scm.com</a></em></p><p>版本控制，可以进行备份，协同开发。<em>Github 只支持 Git 作为唯一的版本库格式进行托管。</em></p><h2 id="学习" tabindex="-1"><a class="header-anchor" href="#学习"><span>学习</span></a></h2><blockquote><p>通过自顶向下的方式（从命令行接口开始）学习 Git 可能会让人感到非常困惑。很多时候您只能死记硬背一些命令行，然后像使用魔法一样使用它们。 ——<a href="https://missing-semester-cn.github.io/2020/version-control/" target="_blank" rel="noopener noreferrer">The Missing</a></p></blockquote><ul><li><a href="https://learngitbranching.js.org/?locale=zh_CN" target="_blank" rel="noopener noreferrer">learngitbranching</a></li><li><a href="https://missing-semester-cn.github.io/2020/version-control/" target="_blank" rel="noopener noreferrer">The Missing</a></li></ul><h2 id="安装与配置" tabindex="-1"><a class="header-anchor" href="#安装与配置"><span>安装与配置</span></a></h2><h3 id="安装-windows" tabindex="-1"><a class="header-anchor" href="#安装-windows"><span>安装（windows）</span></a></h3><p>此处仅安装 Git Bash，不涉及 GUI。</p><div class="vp-tabs"><div class="vp-tabs-nav" role="tablist"><button type="button" class="vp-tab-nav active" role="tab" aria-controls="tab-41-0" aria-selected="true">scoop</button><button type="button" class="vp-tab-nav" role="tab" aria-controls="tab-41-1" aria-selected="false">git for windows</button></div><!--[--><div class="vp-tab active" id="tab-41-0" role="tabpanel" aria-expanded="true"><div class="vp-tab-title">scoop</div><!--[--><p>使用 <a class="route-link" href="/farraginous/recommend_packages.html#scoop">scoop</a> 可以一行搞定：<code>scoop install git</code>。</p><p>注意安装完的提示，可以直接一行命令添加 <code>*.sh</code> 的键绑定。</p><p><s>在 <em>windows 设置 - 应用 - 默认应用</em> 中为 <code>.sh</code> 文件添加默认打开方式，添加为 <code>...\scoop\apps\git\current\git-bash.exe</code>（填写实际路径）。否则无法直接双击 <code>*.sh</code> 文件直接运行。</s> 现已无需手动添加。</p><!--]--></div><div class="vp-tab" id="tab-41-1" role="tabpanel" aria-expanded="false"><div class="vp-tab-title">git for windows</div><!--[--><blockquote><p>&quot;Git for Windows SDK&quot; is 5.33GB compared to &quot;Git for Windows&quot; 691MB compared to &quot;Portable Git&quot; 275MB.</p><div style="text-align:right;"><p>——<a href="https://github.com/mcgitty/pacman-for-git/blob/main/pacman-for-git.txt" target="_blank" rel="noopener noreferrer">pacman-for-git</a></p></div><p>git for windows 官方的安装包就是纯纯流氓。明明是 git 和 msys2 结合体，却不让安装其他软件。</p></blockquote><p>git for windows 的安装也算是一门学问，一共十几个英文步骤选项对新手极其折磨；当然你也可以一路确定，没什么大问题，就是占用空间多一点罢了。</p><!--]--></div><!--]--></div><h3 id="配置" tabindex="-1"><a class="header-anchor" href="#配置"><span>配置</span></a></h3><p>建议在第一次使用前配置 git。当然不配置也没关系，<s>后面慢慢摸索也就会了</s>。</p><ol><li>配置个人信息<div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> config</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --global</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> user.name</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Your Name&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> config</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --global</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> user.email</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;your-email@example.com&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div>这里建议将 <code>Your Name</code> &amp; <code>your-email@example.com</code> 设为 Github 注册用户名与邮箱，使 Github 能够统计你的 commits。</li><li>配置代理：由于众所周知的原因，最好使用代理上 Github。请在 <code>&lt;port&gt;</code> 处填写你的本地代理端口：<div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> config</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --global</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> http.proxy</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> http://127.0.0.1:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">por</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">t</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> config</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --global</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> https.proxy</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> http://127.0.0.1:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">por</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">t</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div>还需要配置 ssh 的代理：编辑 <code>~/.ssh/config</code>，输入如下内容<sup class="footnote-ref"><a href="#footnote1">[1]</a><a class="footnote-anchor" id="footnote-ref1"></a></sup>：<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>Host github.com   # &quot;github.com&quot; 匹配的是仓库的 remote host name, 可以通过 git remote -v 查看。</span></span>
<span class="line"><span>    User git</span></span>
<span class="line"><span>    Hostname ssh.github.com</span></span>
<span class="line"><span>    Port 443</span></span>
<span class="line"><span>    # ProxyCommand connect -H 127.0.0.1:&lt;port&gt; %h %p  # 如果你设置了 HTTP_PROXY 和 HTTPS_PROXY 环境变量，可以不写这行</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>其他全局设置<div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> config</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --global</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> push.default</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> current</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        # 设置默认推送，简化 git push</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> config</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --global</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> push.autoSetupRemote</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">   # 默认设置上游，搭配上条</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> config</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --global</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> core.quotepath</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> false</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        # 取消中文转义，需要终端支持 utf-8</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> config</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --global</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --add</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> safe.directory</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;*&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    # 取消目录安全警告</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> config</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --global</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> diff.algorithm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> histogram</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    # 更改默认 diff 算法，详见页面底 external 1.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> config</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --global</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> init.defaultBranch</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> main</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">     # 更改默认分支为 main（linux 默认还是 master）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> config</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --global</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rebase.autoSquash</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      # 自动 squash</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> config</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --global</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> core.ignorecase</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> false</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">       # （Windows）将文件名大小写改动也视为改动。https://t.me/withabsolutex/2156</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># 全局忽略</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">printf</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;node_modules\n__pycache__\n*.exe\n*.o\n&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ~/.gitignore_g</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> config</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --global</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> core.excludesfile</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ~/.gitignore_g</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>参考<a href="#%E5%8F%96%E6%B6%88%E8%BD%AC%E4%B9%89">取消转义</a></li><li><a href="https://docs.github.com/en/get-started/getting-started-with-git/configuring-git-to-handle-line-endings" target="_blank" rel="noopener noreferrer">设置 autocrlf</a>。（无论 Windows 还是 Linux 都要设！）</li></ul></li><li>vscode 插件：如果你使用 vscode 作为你的代码开发环境，那么推荐使用轻量级插件 <code>Git Graph</code> 以直观地查看 git 提交树与更改。</li><li>其他 git 插件 <ul><li><a href="https://difftastic.wilfred.me.uk/git.html#difftastic-by-default" target="_blank" rel="noopener noreferrer">difftastic</a></li><li><a href="#%E5%88%A0%E9%99%A4%E5%A4%A7%E6%96%87%E4%BB%B6">git-filter-repo</a></li></ul></li></ol><h2 id="其他工具" tabindex="-1"><a class="header-anchor" href="#其他工具"><span>其他工具</span></a></h2><ul><li><a href="https://github.com/extrawurst/gitui" target="_blank" rel="noopener noreferrer">gitui</a>：TUI git 工具</li><li><a href="https://github.com/commitizen/cz-cli" target="_blank" rel="noopener noreferrer">Commitizen</a>：帮助写出规范的 commit message</li></ul><h2 id="基础" tabindex="-1"><a class="header-anchor" href="#基础"><span>基础</span></a></h2><ul><li>在 windows git bash 中，<code>ctrl + insert</code> 复制，<code>shift + insert</code> 粘贴</li><li>执行 git 命令前，请确认当前目录是否正确</li></ul><h3 id="创建仓库" tabindex="-1"><a class="header-anchor" href="#创建仓库"><span>创建仓库</span></a></h3><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> init</span></span></code></pre></div><p>创建仓库后，目录下出现<code>.git</code>隐藏文件夹，即为仓库本体。因此若要删除仓库，最快捷的方法就是直接删除<code>.git</code>文件夹。</p><blockquote><p>在 windows 下由于权限问题会出现无法删除的情况，此时请在 bash <code>rm -rf .git</code></p></blockquote><h3 id="提交" tabindex="-1"><a class="header-anchor" href="#提交"><span>提交</span></a></h3><p>提交你的修改。提交前需要<strong>先将文件添加到暂存区</strong>。</p><p>可以直接 <code>git add &lt;file_path&gt;</code>，但是一般的工程都会在主目录下使用 <code>.gitignore</code> 声明忽略的文件，然后直接 <code>git add -A</code>。</p><blockquote><p>小知识：git stage 是同义于 git add 的。<a href="https://wkevin.github.io/GitChat/gitchat.html#%E4%BF%AE%E6%94%B9%E5%AE%8C%E4%BA%86%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E6%98%AF%E7%9B%B4%E6%8E%A5%E6%8F%90%E4%BA%A4%E8%80%8C%E6%98%AF-git-add" target="_blank" rel="noopener noreferrer">ref</a></p></blockquote><p>然后执行 <code>git commit -m &quot;注释&quot;</code> 提交。提交的注释有一定要求，如果是协作开发，请遵守。如果是个人项目，那随意。</p><ul><li>言简意赅，清楚描述自己这次提交的修改内容</li><li>一般现在时</li></ul><p>如果没有新增文件，可以将添加到暂存区和提交合成一条指令，<code>git commit -am &quot;注释&quot;</code>，即提交所有<strong>已追踪文件</strong>。</p><p>一般来说，不需要为修改的每个文件使用不同注释。</p><h3 id="上传" tabindex="-1"><a class="header-anchor" href="#上传"><span>上传</span></a></h3><p>将你的仓库上传到 github 等仓库托管平台。</p><h4 id="添加远程地址" tabindex="-1"><a class="header-anchor" href="#添加远程地址"><span>添加远程地址</span></a></h4><div class="vp-code-tabs"><div class="vp-code-tabs-nav" role="tablist"><button type="button" class="vp-code-tab-nav active" role="tab" aria-controls="codetab-225-0" aria-selected="true">SSH</button><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-225-1" aria-selected="false">HTTPS</button></div><!--[--><div class="vp-code-tab active" id="codetab-225-0" role="tabpanel" aria-expanded="true"><div class="vp-code-tab-title">SSH</div><!--[--><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> remote</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> origin</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> git@github.com:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">yourgithubI</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">D</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">/</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">Rep</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">o</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">.git</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab" id="codetab-225-1" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">HTTPS</div><!--[--><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> remote</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> origin</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> https://github.com/yourgithubID/gitRepo.git</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><!--]--></div><!--]--></div><blockquote><p>优先使用 ssh，不过需要配置，如果不想配置可以使用 https。<br> 可以理解为给 git 地址起了个别名，方便记忆。一般都用 <code>origin</code>。</p></blockquote><h4 id="配置-ssh" tabindex="-1"><a class="header-anchor" href="#配置-ssh"><span>配置 ssh</span></a></h4><p>首次使用 ssh 连接需要先配置 ssh 密钥。在 git bash 中输入下述指令：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">ssh-keygen</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ed25519</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -C</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;youremail@example.com&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      # 这里的邮箱与你的 github 注册邮箱相同。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># 然后一路回车</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ~/.ssh/id_ed25519.pub</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">                             # 把这个文件的内容打印出来，然后复制到剪切板。或者你也可以用记事本打开，都行，只要拿到内容即可。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># 点击github右上角头像，进入 Settings-SSH and GPG keys，新建你的 ssh key 并粘贴内容。标题随便写。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">ssh</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -T</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> git@github.com</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">   # 验证 ssh key 是否设置成功</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>（疑难解答<sup class="footnote-ref"><a href="#footnote2">[2]</a><a class="footnote-anchor" id="footnote-ref2"></a></sup>：ssh 密钥添加后出现 <code>ssh: connect to host github.com port 22: Connection refused</code> 错误）</li></ul><h4 id="推送" tabindex="-1"><a class="header-anchor" href="#推送"><span>推送</span></a></h4><p>请确保已<a href="#%E6%B7%BB%E5%8A%A0%E8%BF%9C%E7%A8%8B%E5%9C%B0%E5%9D%80">添加远程地址</a>。</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> origin</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">branc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">h</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    # branch 为当前分支</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> origin</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">branc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">h</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -u</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">     # 将当前分支设为默认</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> origin</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">branc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">h</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">     # 强制覆盖上传，慎用</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> origin</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">branc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">h</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --force-with-lease</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> # 建议使用此选项代替 -f，更加安全</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>现在你已经能完成基本的上传文件到 github 的操作。</p><h3 id="忽略文件-夹" tabindex="-1"><a class="header-anchor" href="#忽略文件-夹"><span>忽略文件（夹）</span></a></h3><p>在仓库下新建 <code>.gitignore</code>，输入你需要忽略的文件或文件夹，以换行隔开。</p><p><code>!</code> 开头的表示反选，即“不要忽略”。</p><div class="hint-container warning"><p class="hint-container-title">注意</p><p>开发时请务必将你的无关文件添加进 <code>.gitignore</code>。</p></div><p>注意其语法与 linux 文件系统类似，<code>/</code> 开头的为根目录，别搞错了。</p><h4 id="全局忽略" tabindex="-1"><a class="header-anchor" href="#全局忽略"><span>全局忽略</span></a></h4><p><code>git config --global core.excludesfile &lt;ignore_file&gt;</code> 可以配置一个全局 ignore，假如忘记添加 <code>.gitignore</code>，全局命中也能避免上传无关内容。</p><h3 id="自动化脚本" tabindex="-1"><a class="header-anchor" href="#自动化脚本"><span>自动化脚本</span></a></h3><p>新建 <code>xxx.sh</code>，输入每行一个指令，双击运行。本质是 bash 脚本。</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>脚本执行完成后将自动关闭窗口。若需使之不自动关闭，请添加<code>exec /bin/bash</code>指令至末行。</p></div><h3 id="设置" tabindex="-1"><a class="header-anchor" href="#设置"><span>设置</span></a></h3><p>在前面的章节中已经用到了 <code>git config</code>。git 的配置分为仓库配置与全局配置，两者都是 <code>.toml</code> 格式的文件。<code>git config xxx</code> 本质就是添加/修改配置文件中的条目。</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> config</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --edit</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> # 使用默认编辑器打开 local config 文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> config</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --global</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --edit</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> # 相对的，打开 global 文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> config</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> alias.p</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;pull origin code&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  # 向 alias.p 内写入值（添加命令别名）</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="进阶" tabindex="-1"><a class="header-anchor" href="#进阶"><span>进阶</span></a></h2><h3 id="提交-1" tabindex="-1"><a class="header-anchor" href="#提交-1"><span>提交</span></a></h3><ul><li>撤销上次 commit：<code>git reset --soft HEAD~1</code>，其中 <code>--soft</code> 表示保留代码与 <code>git add</code> 的暂存区</li><li>修改注释：<code>git commit --amend</code>，(git bash 下) 需要使用 <a class="route-link" href="/coding/vim.html">Vim</a>，需要强制推送。</li><li>还有比较常用的，回到上一个 commit 的状态，去除所有多余文件和改动：<code>git reset --hard HEAD &amp;&amp; git clean -f -d</code></li></ul><h3 id="远程" tabindex="-1"><a class="header-anchor" href="#远程"><span>远程</span></a></h3><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> remote</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> show</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">nam</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        # 查看远程仓库，name 留空即为列出当前远程仓库列表</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> remote</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rm</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">remote</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> nam</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">   # 删除远程名字</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> fetch</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> origin</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">branc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">h</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">     # 拉取远程</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="删除远程-tag" tabindex="-1"><a class="header-anchor" href="#删除远程-tag"><span>删除远程 tag</span></a></h4><p>如果在 github 上新建了一个 release 后，代码又发生了改变，此时 release 中的 source code 将不会自动更新。</p><p>理论上，需要新建一个 tag 进行更新。</p><p>在特殊需求下，我们也可以通过删除原 tag 再添加 tag 的方法更新 source code。此时 release 信息会被保留，状态更改为 draft。</p><p><code>git push origin :refs/tags/TAGNAME</code></p><h3 id="仓库查询" tabindex="-1"><a class="header-anchor" href="#仓库查询"><span>仓库查询</span></a></h3><ul><li>查看仓库内文件：<code>git ls-files</code></li><li><strong>查看仓库状态：<code>git status</code></strong>，比较重要</li><li>查看仓库提交记录：<code>git log</code><ul><li>以树状图显示：<code>git log --graph --oneline --all</code>，很有用，特别是在服务器上。</li></ul></li><li>查询 commit 详细信息：<code>git show --stat [commit]</code>；<code>[commit]</code> 留空则查询最近一次 commit 的信息</li></ul><h3 id="分支" tabindex="-1"><a class="header-anchor" href="#分支"><span>分支</span></a></h3><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> branch</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -a</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">                    # 查看分支</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> branch</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">new_branch_nam</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">     # 新建分支</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> switch</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">branch_nam</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">         # 切换到分支</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkout</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -b</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">branch_nam</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    # 新建并切换到分支，trick</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> branch</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -m</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">old_nam</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">new_nam</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> # 重命名分支</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> branch</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --delete</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">branch_nam</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">   # 删除分支</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> origin</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -d</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">branch_nam</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> # 删除远程分支</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>（疑难解答<sup class="footnote-ref"><a href="#footnote3">[3]</a><a class="footnote-anchor" id="footnote-ref3"></a></sup>：<em>fatal: refusing to merge unrelated histories</em>）</li><li>（疑难解答<sup class="footnote-ref"><a href="#footnote4">[4]</a><a class="footnote-anchor" id="footnote-ref4"></a></sup>：<em>unable to delete &#39;origin/main&#39;: remote ref does not exist</em>）</li><li>（疑难解答<sup class="footnote-ref"><a href="#footnote5">[5]</a><a class="footnote-anchor" id="footnote-ref5"></a></sup>：<code>git push origin -d master</code> 时 github 拒绝删除分支）</li></ul><h3 id="操作文件" tabindex="-1"><a class="header-anchor" href="#操作文件"><span>操作文件</span></a></h3><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --cached</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> filename.xxx</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -r</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  # --cached 指仅删除仓库内文件，不删除本地文件；-r 为递归</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># 也可以用来删除被添加到暂存区 (git add) 的文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [commit_hash] -- </span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">path/to/file</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  # 从某个 HEAD 指针恢复文件，注意空格</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="下载" tabindex="-1"><a class="header-anchor" href="#下载"><span>下载</span></a></h3><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> clone</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">gitrep</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">o</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  # 在当前目录下创建文件夹并克隆完整仓库</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> clone</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">gitrep</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">o</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --depth</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> # 仅克隆最新提交，减少大小</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> clone</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">gitrep</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">o</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --filter=tree:0</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> # 与上面一个大小相当，但是保留了提交 hash 记录</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="彻底删除提交" tabindex="-1"><a class="header-anchor" href="#彻底删除提交"><span>彻底删除提交</span></a></h3><p>在<a href="#%E6%B7%B1%E5%85%A5">深入</a>中有提到，一旦 commit 过后，此次修改就不会消失。那么如果我无论如何就是想要让此次修改消失呢？(<a href="https://www.cnblogs.com/my_life/articles/16141241.html" target="_blank" rel="noopener noreferrer">src</a>)</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> reflog</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> expire</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --expire-unreachable=0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --all</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> gc</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --prune=0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="submodule" tabindex="-1"><a class="header-anchor" href="#submodule"><span>submodule</span></a></h3><p>若想在 git 仓库内包含子仓库，需要将子仓库转换为 submodule。submodule 本质上是一个 symbol link，指向一个本地或网络仓库位置。</p><ul><li>创建：<code>git submodule add &lt;1&gt; &lt;2&gt;</code>，添加一个现有仓库 <code>1</code> 到 位置 <code>2</code>。<code>1</code> 可以是本地位置或网络位置，而 <code>2</code> 一般是本仓库下的相对路径。</li><li>拉取： <ul><li>使用 clone 无法直接拉取 submodule，需要添加 <code>--recursive</code>。</li><li>对于 pull 或者已经拉取的仓库，单独拉取 submodule，需要 <code>git submodule update --init --recursive</code> (<a href="https://stackoverflow.com/questions/1030169/" target="_blank" rel="noopener noreferrer">ref</a>)</li></ul></li></ul><h2 id="深入" tabindex="-1"><a class="header-anchor" href="#深入"><span>深入</span></a></h2><blockquote><p>这里是原创内容，是我个人摸索/结合其他文章得出的、对提交树的理解。可能有误，需要自行辨认。</p></blockquote><p>git 构成的结构可以看成一颗<strong>提交树</strong>。（实际上是 DAG，有向无环图）</p><p>git 的一个重要概念是 <code>HEAD</code>。<code>HEAD</code> （理解为指针）指向你当前所在的节点。</p><p>每次提交（包括 <code>git stash</code>）相当于在提交树上创造一个 <code>HEAD</code> 的子节点。只要有过 commit，它就不会消失。后文中默认 <code>节点</code> == <code>提交</code>。</p><p>每个 branch 也是指针，指向某个节点。后文中默认 <code>分支</code> --&gt; <code>指针</code>。（but <code>指针</code> !== <code>分支</code>）</p><p><em>remote branch</em> (ex. <code>origin/main</code>) 和 <em>local branch</em> (ex. <code>main</code>) 可以看成是不同的 branch。<code>git push</code> 就可以看成让 <code>origin/main</code> 指向 <code>main</code> 的过程（当然还有同步）。</p><h3 id="畅游-git-提交树" tabindex="-1"><a class="header-anchor" href="#畅游-git-提交树"><span>畅游 git 提交树</span></a></h3><p>每个节点的 hash 值是 40 位的，但是可以用（最短）前 4 位来代替，当然也可以用一个指针的名字来代替。</p><p><code>git checkout &lt;hash&gt;</code> 可以让 <code>HEAD</code> 指向任意节点。如果没有任何分支指向 <code>HEAD</code> 同一节点，则进入 <code>HEAD detached</code> 模式。</p><p><code>git checkout &lt;branch_name&gt;</code>（新版本 git 建议用 <code>switch</code> 代替 <code>checkout</code> 的这一功能）会退出 <code>HEAD detached</code> 模式，并将 <code>HEAD</code> 附着到分支指针上。</p><p>而 <code>git reset --hard &lt;hash&gt;</code> 则更进一步，若当前并非 <code>HEAD detached</code> 模式（即 <code>HEAD</code> 依附于一个分支），则在将 <code>HEAD</code> 指向节点的同时，也会让分支跟随着指向 <code>HEAD</code>。</p><ul><li><code>--hard</code> 表示强制恢复节点处的文件（不删除未追踪文件），请确保当前没有 Uncommited Changes，否则。。。</li><li>还有其他让分支指向其他节点的方法： <ul><li>可以用 <code>git branch -f &lt;branch&gt; &lt;point_to&gt;</code>。这个分支不能是 <code>HEAD</code> 依附的分支。</li><li>可以用 <code>git merge --ff-only &lt;point_to&gt;</code>。将当前 <code>HEAD</code> 依附的分支指向任意代子节点。 <ul><li>不加 <code>--ff-only</code> 则没有子节点的限制，进化为合并操作。</li></ul></li><li>（疑难解答<sup class="footnote-ref"><a href="#footnote6">[6]</a><a class="footnote-anchor" id="footnote-ref6"></a></sup>：无法强制更新被工作区...所使用的分支）</li></ul></li></ul><p>这样我们已经可以操作任意指针指向任意节点了。</p><p><code>git rebase -i</code>（即 <code>--interactive</code>，交互式）可以对提交树进行任意操作，例如：任意编辑注释，更改提交顺序，删除（<code>drop</code>）或合并（<code>squash</code>）节点等。需要使用编辑器<sup class="footnote-ref"><a href="#footnote1">[1:1]</a><a class="footnote-anchor" id="footnote-ref1:1"></a></sup>。</p><p><code>git merge ...</code> 创建一个节点，作为两个 branch 共同的子节点，并将两个 branch 都指向它。此时提交树已失去树结构，退化为 DAG。</p><p>默认情况下，不在 <em>根节点</em> 和 <em>任意指针</em> 连线路径上的节点会被隐藏，<code>git log -a</code> 是看不到的。可以用 <code>git reflog</code> 查看 hash 值。</p><h3 id="任意组合提交树" tabindex="-1"><a class="header-anchor" href="#任意组合提交树"><span>任意组合提交树</span></a></h3><p>现在我们已经不满足于 <strong>畅游</strong> 了，我们需要更进一步：将提交树改为我们想要的任意形状（）</p><p><code>git cherry-pick &lt;...nodes&gt;</code> 将 <code>&lt;...nodes&gt;</code> 复制以后，按顺序接在 <code>HEAD</code> 的下方，成为 <code>HEAD</code> 的子链。</p><p><code>git rebase &lt;to&gt; &lt;from&gt;</code> 会稍微复杂一点。首先 rebase 找到 <code>&lt;to&gt;</code> 和 <code>&lt;from&gt;</code> 的最近公共祖先，记为 <code>&lt;pa&gt;</code>，然后复制 <code>&lt;pa&gt;</code> 到 <code>&lt;from&gt;</code> 这条链（不包括 <code>&lt;pa&gt;</code> 自身），将其接到 <code>&lt;to&gt;</code> 上。</p><p>注意，这些命令都<strong>不会改变</strong>已存在的节点，如果遇到需要移动的情况，则会复制成不同节点。原先节点被隐藏，但我们仍然可以通过 hash 值移动到其所在位置。</p><h2 id="其他技巧" tabindex="-1"><a class="header-anchor" href="#其他技巧"><span>其他技巧</span></a></h2><h3 id="将注释设为当前时间" tabindex="-1"><a class="header-anchor" href="#将注释设为当前时间"><span>将注释设为当前时间</span></a></h3><p>一般不建议，但如果个人项目实在想不到写啥，可以这样。</p><div class="vp-code-tabs"><div class="vp-code-tabs-nav" role="tablist"><button type="button" class="vp-code-tab-nav active" role="tab" aria-controls="codetab-553-0" aria-selected="true">bash</button><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-553-1" aria-selected="false">powershell</button></div><!--[--><div class="vp-code-tab active" id="codetab-553-0" role="tabpanel" aria-expanded="true"><div class="vp-code-tab-title">bash</div><!--[--><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># use only in bash</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> commit</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -m</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">date</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;+%Y%m%d-%H:%M:%S&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># result: 20220613-11:34:59</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab" id="codetab-553-1" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">powershell</div><!--[--><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># use only in powershell</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> commit</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -m</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">get-Date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># result: 06/17/2023 21:05:13</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><h3 id="用于备份" tabindex="-1"><a class="header-anchor" href="#用于备份"><span>用于备份</span></a></h3><h4 id="使用-cp-方法" tabindex="-1"><a class="header-anchor" href="#使用-cp-方法"><span>使用 cp 方法</span></a></h4><p>有了 <code>.sh</code> 脚本后，可以用 <code>cp -rfu</code> 将所需文件复制到仓库再提交上传，进行备份。</p><blockquote><p>-r：递归地复制目录。<br> -f：强制 cp 命令在不提示的情况下覆盖现有文件。<br> -u：仅在目标文件不存在或目标文件比源文件旧时才复制文件。</p></blockquote><p>但是这样也太丑了一点。</p><h4 id="软链接方法" tabindex="-1"><a class="header-anchor" href="#软链接方法"><span>软链接方法</span></a></h4><p>cp 方法的一大缺点是无法反映<strong>删除</strong>的变化。这可以通过软链接解决。</p><p>但是，git 只会将软链接识别成链接本身，而不是其指向的内容。并且这是无解的。</p><p>因此我们只能将文件本体放在 git 仓库内，然后将文件软链接出去在其他地方用。这需要考虑软链接能否被其他应用正常使用。例如我将 galgame 存档链出去，有的游戏能读，有的游戏不能读，还是需要看运气的。</p><h4 id="git-bare-repo" tabindex="-1"><a class="header-anchor" href="#git-bare-repo"><span>git bare repo</span></a></h4><p>后来试了一下 <a href="https://github.com/rodrigofrancisco/dotfiles#backup-technique" target="_blank" rel="noopener noreferrer">git bare repo</a>。</p><p>linux 上倒是挺方便，但估计不能在 windows 下跨盘符使用。</p><h3 id="取消转义" tabindex="-1"><a class="header-anchor" href="#取消转义"><span>取消转义</span></a></h3><p>git bash 默认会将中文以 <code>\</code> 转义的方式显示。要取消，需要：</p><ol><li>右键 - Options - Text - Locale，选择 <code>zh-CN</code>，字符选择 <code>UTF-8</code>。</li><li><code>git config --global core.quotepath false</code></li></ol><h3 id="协同开发" tabindex="-1"><a class="header-anchor" href="#协同开发"><span>协同开发</span></a></h3><p>多人协同开发时，免不了要拉取上游，合并代码，解决冲突。<code>git stash</code> 可以帮助你保存当前代码，之后若有需要，还可合并与解决冲突。</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> stash</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">   # 暂存代码</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> origin</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> main</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    # 拉取上游</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> stash</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> pop</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">   # 释放代码，进行合并</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> stash</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> drop</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  # 解决冲突后，请释放未被 pop 出的 stash</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当然也可以使用 <code>git fetch &amp;&amp; git merge</code>。</p><h3 id="合并-pull-request" tabindex="-1"><a class="header-anchor" href="#合并-pull-request"><span>合并 Pull request</span></a></h3><p>需要手动干预 PR 的场合，<a class="route-link" href="/coding/github.html#%E5%90%88%E5%B9%B6-pull-request">参考 Github - 合并 Pull Request</a></p><h3 id="删除大文件" tabindex="-1"><a class="header-anchor" href="#删除大文件"><span>删除大文件</span></a></h3><p>删除大文件是必要的。即使你删除了某个文件，其仍会存在于仓库的提交记录内。</p><div class="hint-container caution"><p class="hint-container-title">警告</p><p>在删除之前请务必 commit 未提交的修改！！警钟长鸣！警钟长鸣！这里（20230312）是血的惨痛教训。</p></div><ol><li><p>查找大文件：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># 需要在 git bash 或其他类 unix 环境下运行</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rev-list</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --objects</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --all</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> verify-pack </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">-v</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .git/objects/pack/</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">.idx </span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> sort</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -k</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> tail</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -15</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> awk</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;{print$1}&#39;)&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># another edition</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># git rev-list --all | xargs -rL1 git ls-tree -r --long | sort -uk3 | sort -rnk4 | head -15</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中 <code>tail [-n]</code> 为显示的条目数。（疑难解答<sup class="footnote-ref"><a href="#footnote7">[7]</a><a class="footnote-anchor" id="footnote-ref7"></a></sup>：_查找大文件时出现<code>Cannot open existing pack file &#39;.git/objects/pack/_.idx&#39;</code>错误*）</p></li><li><p>清理。</p><div class="vp-tabs"><div class="vp-tabs-nav" role="tablist"><button type="button" class="vp-tab-nav active" role="tab" aria-controls="tab-658-0" aria-selected="true">bfg-repo-cleaner（推荐）</button><button type="button" class="vp-tab-nav" role="tab" aria-controls="tab-658-1" aria-selected="false">filter-repo（推荐）</button><button type="button" class="vp-tab-nav" role="tab" aria-controls="tab-658-2" aria-selected="false">filter-branch</button></div><!--[--><div class="vp-tab active" id="tab-658-0" role="tabpanel" aria-expanded="true"><div class="vp-tab-title">bfg-repo-cleaner（推荐）</div><!--[--><p><a href="https://rtyley.github.io/bfg-repo-cleaner/" target="_blank" rel="noopener noreferrer">bfg-repo-cleaner</a> 是我某天刷 nix store 时看到的，尝试了一下，也非常不错。</p><p>主要用法就 <code>--delete-files</code>, <code>--delete-folders</code> 两个。这两个是 match 名字而不是路径。</p><!--]--></div><div class="vp-tab" id="tab-658-1" role="tabpanel" aria-expanded="false"><div class="vp-tab-title">filter-repo（推荐）</div><!--[--><p><a href="https://github.com/newren/git-filter-repo" target="_blank" rel="noopener noreferrer">git-filter-repo</a></p><p>git 官方推荐的清理工具。需要额外安装，并且可能失效。</p><p>windows 下推荐使用 scoop 安装，安装过程详见仓库说明。（疑难解答<sup class="footnote-ref"><a href="#footnote8">[8]</a><a class="footnote-anchor" id="footnote-ref8"></a></sup>：<em>运行 <code>git filter-repo</code> 出现 <code>name &#39;git&#39; is not defined</code> 报错</em>）</p><p>关于使用方法，<s>没人能看懂官方文档</s>，建议直接找<a href="https://nyakku.moe/posts/2020/06/12/use-git-filter-repo-clean-git-history.html" target="_blank" rel="noopener noreferrer">教程</a>。</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> filter-repo</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --invert-paths</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --path</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;&lt;path/of/file&gt;&quot;</span></span></code></pre></div><!--]--></div><div class="vp-tab" id="tab-658-2" role="tabpanel" aria-expanded="false"><div class="vp-tab-title">filter-branch</div><!--[--><p><a href="https://harttle.land/2016/03/22/purge-large-files-in-gitrepo.html" target="_blank" rel="noopener noreferrer">ref</a></p><p>不太推荐这种方式，比较慢（真的）。好处是无需安装，并且一定可用。</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> filter-branch</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --prune-empty</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --index-filter</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;git rm -rf --cached --ignore-unmatch &lt;path/of/file&gt;&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --tag-name-filter</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> cat</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --all</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># another edition:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># git filter-branch --tree-filter &quot;rm -f &lt;path/of/file&gt;&quot; -- --all</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div></li><li><p>清理完成后请使用 <code>git gc --prune=now</code> 进行碎片收集，上传时需要 <code>git push -f</code> 强制覆盖。</p></li></ol><h3 id="大文件上传" tabindex="-1"><a class="header-anchor" href="#大文件上传"><span>大文件上传</span></a></h3><blockquote><p>此处暂不讨论 git-lfs.<br> Github 对单次上传限制为 2G，在我看来是个非常脑瘫的举措。</p></blockquote><p>首先，若有大文件，最该考虑的是 <code>git-lfs</code>。具有先见之明的做法可以极大减少后期维护的成本。</p><p>其次，我在网上找到了<a href="https://gist.github.com/banyudu/b5bac69767f49073e09985d82128e713" target="_blank" rel="noopener noreferrer">这些资料</a>，但其中提到的 Stackoverflow 的<a href="https://stackoverflow.com/questions/15125862/github-remote-push-pack-size-exceeded/51468389#51468389" target="_blank" rel="noopener noreferrer">脚本</a>并不能很好地运行。因此我根据上述原理支撑，自己写了一个脚本。适用于文件总体过大但每个 commit 都不超出大小限制的情况。</p><ol><li>导出所有 commit hash 并翻转使最早的 commit 被最先提交。<div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> log</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --pretty=format:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;%H&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> temp.txt</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">tac</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> temp.txt</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> log_hash.txt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div>注意，<code>tac</code> 反转可能会出现第一行与第二行换行缺失问题，请手动添加换行。</li><li>分 commit 上传<div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">while</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> IFS</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> read</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;pushing </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">$hash</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> origin</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> $hash</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:refs/heads/master</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -f</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">done</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> log_hash.txt</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">exec</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /bin/bash</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>关于分支与是否加 <code>-f</code> 需要根据情况判断。</li></ol><h3 id="reflog-查找" tabindex="-1"><a class="header-anchor" href="#reflog-查找"><span>reflog 查找</span></a></h3><p>我曾经遇到过文件丢失的情况，这个文件理论上应该永远是 Uncommited changes，不需要被提交。于是在某次 git 操作时文件丢失了。</p><p>但是我记得我曾经有将此文件误提交的事情，虽然当时就 fixup 了。只要有提交过，文件就会在 reflog 中保留下来。这给了我恢复文件的可能性。</p><p>那么要如何知道是哪个 commit 中引入的此文件呢？让 GPT 写一个脚本，稍作修改得到：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> reflogEntry</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> reflog</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> commit</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> awk</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;{print $1}&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">   git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> show</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> $reflogEntry</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> $@</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">   if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">$?</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -eq</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ]; </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">      echo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Found in commit </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">$reflogEntry</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">   fi</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">done</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后就可以 <code>bash test.sh &lt;file&gt;</code> 了。</p><h2 id="签名" tabindex="-1"><a class="header-anchor" href="#签名"><span>签名</span></a></h2><p>一般情况下，git 提交都是不需要签名的。但是面对大项目的协同开发，有时没办法，如果不签名，CI 都过不去。因此学习如何签名也是有必要的。</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">gpg</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --generate-key</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">   # 然后填写与 git 提交一样的名字与邮箱。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">gpg</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --list-secret-keys</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --keyid-format=long</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">   # 寻找私钥 ID 并复制</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">gpg</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --armor</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --export</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 83D</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">********</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> # 打印公钥，上传到 Github</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> config</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> commit.gpgsign</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">   # 设置该仓库 commit 时自动签名</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果需要对已存在的 commit 签名，可以 <code>git rebase -i HEAD</code>，然后将其中的 <code>noop</code>(<em>no operation</em>) 改为 <code>exec git commit --amend --no-edit -S</code> 即可。</p><h2 id="自建-git-托管" tabindex="-1"><a class="header-anchor" href="#自建-git-托管"><span>自建 git 托管</span></a></h2><p>有一些东西，不方便放在托管网站上（即便是 private），例如个人隐私，被 DMCA 的资源，等等。因此可以在 <a class="route-link" href="/articles/proxy/vps.html">VPS</a> 上自建一个 git 托管解决。</p><p>我的需求非常简单，保持同步即可。因此这里也不讲什么 Gitea，直接利用最原始的 ssh(<a href="https://www.zzxworld.com/posts/4-ways-to-self-host-git-service" target="_blank" rel="noopener noreferrer">ref</a>)：在 VPS 上建一个 bare repo 就结束了！之后上传只要指定 host 和路径就行了。</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">hos</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">t</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">pat</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">h</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">/</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">nam</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">.git</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="统计-git-分支大小" tabindex="-1"><a class="header-anchor" href="#统计-git-分支大小"><span>统计 git 分支大小</span></a></h2><p>用 gpt 写了个。</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># 假设已 checkout 到此分支</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ls-files</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> xargs</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -n1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> du</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -h</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> awk</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;{print $1}&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> paste</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -sd+</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> bc</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>可能需要安装 <code>bc</code>（<code>pacman -S bc</code>）。统计结果理论以 K 为单位。</p><h2 id="奇技淫巧" tabindex="-1"><a class="header-anchor" href="#奇技淫巧"><span>奇技淫巧</span></a></h2><h3 id="自动化-squash" tabindex="-1"><a class="header-anchor" href="#自动化-squash"><span>自动化 squash</span></a></h3><p>最初目的是不要让 Github Actions 的每日 commit 过多（），于是想自动将所有 Github Actions 的 commits 压在一起。而 CI 流程让我无法手动 squash。话不多说，直接上脚本：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> commit</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -a</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --fixup</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> HEAD</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">GIT_SEQUENCE_EDITOR</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rebase</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --autosquash</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> HEAD~2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>首先 <code>commit -a</code> 跟踪所有改动并提交，<code>--fixup HEAD</code> 表明这是一个对上次 commit 的修正。新的提交会被命名为 <code>fixup! &lt;last commit message&gt;</code>。</p><p>然后关于 <code>--autosquash</code>，<a href="https://git-scm.com/docs/git-rebase#Documentation/git-rebase.txt---autosquash" target="_blank" rel="noopener noreferrer">文档</a>指出以 <code>squash! …​</code> or <code>fixup! …​</code> or <code>amend! …​</code> 开头的 commit 都会被 squash 进 <code>…</code> 对应的 commit。但是这个参数的使用条件被限制死了：</p><blockquote><p><em>move commits that begin with squash!/fixup! <mark>under -i</mark></em></p></blockquote><p>也就是必需要进入 <code>--interactive</code> 环境下才可进行 <em>autosquash</em>。在平常这可能不是一个问题，手动在 vim <code>:q</code> 即可。但现在需要在全自动条件下执行，又无法绕开 <code>-i</code> 条件，那么我们要怎么办呢？</p><p><code>GIT_SEQUENCE_EDITOR=:</code> 是绝杀，它重写了环境变量，使 git 无法打开编辑器。这样 <em>rebase</em> 就会被强制结束，问题解决。</p><p>总结：</p><blockquote><p><em>Asuka Minato：用 ci 的 repo 为啥要在意提交次数，人家 cn 源的 bot 那次数都没人管</em><br><em>AbsoluteX：话题结束，鉴定为吃太饱（</em></p></blockquote><h3 id="崭新出厂" tabindex="-1"><a class="header-anchor" href="#崭新出厂"><span>崭新出厂</span></a></h3><p>像我这种喜欢用 Git 备份一切的人，也会用 Git 备份一些经常变化的大二进制文件，代表性仓库是 <a href="https://github.com/lxl66566/my-key-data" target="_blank" rel="noopener noreferrer">my-key-data</a>。久而久之，Git 仓库会越来越大，因此一段时间以后让 repo “恢复出厂设置” 以减小文件大小是有必要的。（我的备份场景下，并不在乎历史版本追溯）</p><p>我之前用的一直是简单粗暴 <code>rm -rf .git &amp;&amp; git init</code>，但是现在似乎也有了新的思路。</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># 假设仓库已将最新修改 commit 到 main 分支</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkout</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -b</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> new</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">                    # 切换临时分支</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> branch</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -D</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> main</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">                     # 删除旧分支</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkout</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --orphan</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> main</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">             # 全新分支</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> add</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -A</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> commit</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --signoff</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -a</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;init&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">                            # 干掉 origin/HEAD 和 origin/main</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> branch</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -D</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> new</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> reflog</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> expire</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --expire=now</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --all</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">   # 干掉所有引用</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> gc</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --prune=now</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --aggressive</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        # gc，删除 blob</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这样就能得到一个船新的、与之前完全一致的、最小化空间占用的 repo 了。虽然这样做弯弯绕绕，咋一看还不如 <code>rm -rf .git</code>；但是这样有一个极大的好处，就是步骤中的 commit 的文件列表和之前的 commit 是一致的，<code>git push -f</code> 上传到 Github 时经过比对，实际上不需要上传数据。如果你的仓库大小上了 GB 甚至数十 GB，这一点操作能为你节约不少上传时间和流量。而 git 仓库重建后的上传是需要全量上传的。</p><h2 id="external" tabindex="-1"><a class="header-anchor" href="#external"><span>external</span></a></h2><ol><li><a href="https://link.springer.com/article/10.1007/s10664-019-09772-z" target="_blank" rel="noopener noreferrer">How different are different diff algorithms in Git?</a></li><li><a href="https://github.blog/2020-12-17-commits-are-snapshots-not-diffs/" target="_blank" rel="noopener noreferrer">Commits are snapshots, not diffs</a></li><li>file structure <a href="https://wizardzines.com/comics/inside-git/" target="_blank" rel="noopener noreferrer">inside .git</a></li><li><a href="https://blog.miniasp.com/post/2024/06/18/How-to-Remove-Git-Unreachable-Objects" target="_blank" rel="noopener noreferrer">深入探討 Git 中的 Unreachable (無法到達的) 物件與清理方法</a></li><li><a href="https://www.jiqizhixin.com/articles/2020-05-20-3" target="_blank" rel="noopener noreferrer">一文讲透 Git 底层数据结构和原理</a></li><li><a href="https://github.blog/open-source/git/get-up-to-speed-with-partial-clone-and-shallow-clone/" target="_blank" rel="noopener noreferrer">Get up to speed with partial clone and shallow clone</a></li></ol><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="footnote1" class="footnote-item"><p>需要使用 <a class="route-link" href="/coding/vim.html">Vim</a>。你也可以修改环境变量 <code>EDITOR</code> 的值指定其他编辑器。 <a href="#footnote-ref1" class="footnote-backref">↩︎</a> <a href="#footnote-ref1:1" class="footnote-backref">↩︎</a></p></li><li id="footnote2" class="footnote-item"><p>可能是代理阻断了 ssh 22 端口造成。你需要将 github 远程的端口改为 443，参考<a href="#%E9%85%8D%E7%BD%AE">配置 2.</a>。 <a href="#footnote-ref2" class="footnote-backref">↩︎</a></p></li><li id="footnote3" class="footnote-item"><p>当本地与远程交集为空时会出现此情况。解法：<code>git pull origin main --allow-unrelated-histories</code> <a href="#footnote-ref3" class="footnote-backref">↩︎</a></p></li><li id="footnote4" class="footnote-item"><p>当远程不存在分支而本地存在分支时会出现此情况。执行 <code>git fetch --prune</code>。(<a href="https://stackoverflow.com/questions/35941566/git-says-remote-ref-does-not-exist-when-i-delete-remote-branch" target="_blank" rel="noopener noreferrer">ref</a>) <a href="#footnote-ref4" class="footnote-backref">↩︎</a></p></li><li id="footnote5" class="footnote-item"><p>这种情况一般是 Github 的默认分支保护机制。进入 repo <em>Settings</em>，将默认分支改为其他分支即可。 <a href="#footnote-ref5" class="footnote-backref">↩︎</a></p></li><li id="footnote6" class="footnote-item"><p>我的这个例子是没有退出变基造成的。需要 <code>git rebase --quit</code>。 <a href="#footnote-ref6" class="footnote-backref">↩︎</a></p></li><li id="footnote7" class="footnote-item"><p>说明该项目并未触发 git 的 packfile 机制，无需删除大文件。若仍需查找，可以使用 <code># another edition</code> 后的语句。 <a href="#footnote-ref7" class="footnote-backref">↩︎</a></p></li><li id="footnote8" class="footnote-item"><p>根据<a href="https://github.com/newren/git-filter-repo/issues/360" target="_blank" rel="noopener noreferrer">这里</a>的描述做就行了。 <a href="#footnote-ref8" class="footnote-backref">↩︎</a></p></li></ol></section></div><!----><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">上次编辑于: </span><!----></div><!----></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/coding/github.html" aria-label="Github"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><span class="font-icon icon fas fa-brands fa-github" style=""></span>Github</div></a><a class="route-link auto-link next" href="/coding/vscode.html" aria-label="VSCode"><div class="hint">下一页<span class="arrow end"></span></div><div class="link">VSCode<span class="font-icon icon fas fa-file-pen" style=""></span></div></a></nav><div id="vp-comment" class="giscus-wrapper input-top" style="display:block;"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" preserveAspectRatio="xMidYMid" viewBox="0 0 100 100"><circle cx="28" cy="75" r="11" fill="currentColor"><animate attributeName="fill-opacity" begin="0s" dur="1s" keyTimes="0;0.2;1" repeatCount="indefinite" values="0;1;1"></animate></circle><path fill="none" stroke="#88baf0" stroke-width="10" d="M28 47a28 28 0 0 1 28 28"><animate attributeName="stroke-opacity" begin="0.1s" dur="1s" keyTimes="0;0.2;1" repeatCount="indefinite" values="0;1;1"></animate></path><path fill="none" stroke="#88baf0" stroke-width="10" d="M28 25a50 50 0 0 1 50 50"><animate attributeName="stroke-opacity" begin="0.2s" dur="1s" keyTimes="0;0.2;1" repeatCount="indefinite" values="0;1;1"></animate></path></svg></div><!----><!--]--></main><!--]--><!--]--><!----></div><!--]--><!--]--><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-Cyd0ROZI.js" defer></script>
  </body>
</html>
